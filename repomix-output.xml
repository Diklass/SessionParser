This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
repomix-output1.xml
repomix-output2.xml
repomix-output3.xml
result.json
result1.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="repomix-output1.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
result.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-18T15:43:23.752Z",
    "version": "1.0"
  },
  "summary": {
    "items": 96,
    "groups": [
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2Ф",
      "3ПО",
      "4ПО",
      "4Ф",
      "Friday, December 20, 2024",
      "Friday, December 27, 2024",
      "Friday, February 07, 2025",
      "Friday, February 14, 2025",
      "Friday, January 03, 2025",
      "Friday, January 10, 2025",
      "Friday, January 17, 2025",
      "Friday, January 24, 2025",
      "Friday, January 31, 2025",
      "Monday, December 16, 2024",
      "Monday, December 23, 2024",
      "Monday, December 30, 2024",
      "Monday, February 03, 2025",
      "Monday, February 10, 2025",
      "Monday, February 17, 2025",
      "Monday, January 06, 2025",
      "Monday, January 13, 2025",
      "Monday, January 20, 2025",
      "Monday, January 27, 2025",
      "Saturday, December 21, 2024",
      "Saturday, December 28, 2024",
      "Saturday, February 01, 2025",
      "Saturday, February 08, 2025",
      "Saturday, February 15, 2025",
      "Saturday, January 04, 2025",
      "Saturday, January 11, 2025",
      "Saturday, January 18, 2025",
      "Saturday, January 25, 2025",
      "Sunday, December 22, 2024",
      "Sunday, December 29, 2024",
      "Sunday, February 02, 2025",
      "Sunday, February 09, 2025",
      "Sunday, February 16, 2025",
      "Sunday, January 05, 2025",
      "Sunday, January 12, 2025",
      "Sunday, January 19, 2025",
      "Sunday, January 26, 2025",
      "Thursday, December 19, 2024",
      "Thursday, December 26, 2024",
      "Thursday, February 06, 2025",
      "Thursday, February 13, 2025",
      "Thursday, January 02, 2025",
      "Thursday, January 09, 2025",
      "Thursday, January 16, 2025",
      "Thursday, January 23, 2025",
      "Thursday, January 30, 2025",
      "Tuesday, December 17, 2024",
      "Tuesday, December 24, 2024",
      "Tuesday, December 31, 2024",
      "Tuesday, February 04, 2025",
      "Tuesday, February 11, 2025",
      "Tuesday, February 18, 2025",
      "Tuesday, January 07, 2025",
      "Tuesday, January 14, 2025",
      "Tuesday, January 21, 2025",
      "Tuesday, January 28, 2025",
      "Wednesday, December 18, 2024",
      "Wednesday, December 25, 2024",
      "Wednesday, February 05, 2025",
      "Wednesday, February 12, 2025",
      "Wednesday, January 01, 2025",
      "Wednesday, January 08, 2025",
      "Wednesday, January 15, 2025",
      "Wednesday, January 22, 2025",
      "Wednesday, January 29, 2025",
      "Даты"
    ],
    "itemsByGroup": {
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2Ф": 1,
      "3ПО": 1,
      "4ПО": 2,
      "4Ф": 1,
      "Friday, December 20, 2024": 1,
      "Friday, December 27, 2024": 1,
      "Friday, February 07, 2025": 1,
      "Friday, February 14, 2025": 1,
      "Friday, January 03, 2025": 1,
      "Friday, January 10, 2025": 1,
      "Friday, January 17, 2025": 1,
      "Friday, January 24, 2025": 1,
      "Friday, January 31, 2025": 1,
      "Monday, December 16, 2024": 1,
      "Monday, December 23, 2024": 1,
      "Monday, December 30, 2024": 1,
      "Monday, February 03, 2025": 1,
      "Monday, February 10, 2025": 1,
      "Monday, February 17, 2025": 1,
      "Monday, January 06, 2025": 1,
      "Monday, January 13, 2025": 1,
      "Monday, January 20, 2025": 1,
      "Monday, January 27, 2025": 1,
      "Saturday, December 21, 2024": 1,
      "Saturday, December 28, 2024": 1,
      "Saturday, February 01, 2025": 1,
      "Saturday, February 08, 2025": 1,
      "Saturday, February 15, 2025": 1,
      "Saturday, January 04, 2025": 1,
      "Saturday, January 11, 2025": 1,
      "Saturday, January 18, 2025": 1,
      "Saturday, January 25, 2025": 1,
      "Sunday, December 22, 2024": 1,
      "Sunday, December 29, 2024": 1,
      "Sunday, February 02, 2025": 1,
      "Sunday, February 09, 2025": 1,
      "Sunday, February 16, 2025": 1,
      "Sunday, January 05, 2025": 1,
      "Sunday, January 12, 2025": 1,
      "Sunday, January 19, 2025": 1,
      "Sunday, January 26, 2025": 1,
      "Thursday, December 19, 2024": 1,
      "Thursday, December 26, 2024": 1,
      "Thursday, February 06, 2025": 1,
      "Thursday, February 13, 2025": 1,
      "Thursday, January 02, 2025": 1,
      "Thursday, January 09, 2025": 1,
      "Thursday, January 16, 2025": 1,
      "Thursday, January 23, 2025": 1,
      "Thursday, January 30, 2025": 1,
      "Tuesday, December 17, 2024": 1,
      "Tuesday, December 24, 2024": 1,
      "Tuesday, December 31, 2024": 1,
      "Tuesday, February 04, 2025": 1,
      "Tuesday, February 11, 2025": 1,
      "Tuesday, February 18, 2025": 1,
      "Tuesday, January 07, 2025": 1,
      "Tuesday, January 14, 2025": 1,
      "Tuesday, January 21, 2025": 1,
      "Tuesday, January 28, 2025": 1,
      "Wednesday, December 18, 2024": 1,
      "Wednesday, December 25, 2024": 1,
      "Wednesday, February 05, 2025": 1,
      "Wednesday, February 12, 2025": 1,
      "Wednesday, January 01, 2025": 1,
      "Wednesday, January 08, 2025": 1,
      "Wednesday, January 15, 2025": 1,
      "Wednesday, January 22, 2025": 1,
      "Wednesday, January 29, 2025": 1,
      "Даты": 1
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:53c2d85d754ebbac4242877a5642396b54c36c88",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Даты",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 1
      }
    },
    {
      "id": "sha1:58591cc23b2e83cbf70f8a06819023661889fd9d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 16, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 2
      }
    },
    {
      "id": "sha1:a572aa0addcfab891e676a28ffab43acb125de03",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 17, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 3
      }
    },
    {
      "id": "sha1:725e44f8e57a7733c594d4632c4daf25cb97b3d1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 18, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 4
      }
    },
    {
      "id": "sha1:00c86ca9db5469fcc4ac7427ca178f0cee70062a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 19, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 5
      }
    },
    {
      "id": "sha1:159cdeca04a1bddc6f12195680eaa29be8f7badb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 20, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 6
      }
    },
    {
      "id": "sha1:07574887f3965230d6ef429d3da18ea1a5847b83",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 21, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 7
      }
    },
    {
      "id": "sha1:19101165d73dfde009e2ba890d44ef17220f2791",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 22, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 8
      }
    },
    {
      "id": "sha1:2c9eb4927122454072ccf8a03fdb33147c81a2ea",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 23, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 9
      }
    },
    {
      "id": "sha1:03586517d879b96c3858c730816c5f1473bb17d9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 24, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 10
      }
    },
    {
      "id": "sha1:df858b8beef7ad8d8c20ae8169e27fa2f927ed5b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 25, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 11
      }
    },
    {
      "id": "sha1:95a621a83a19f11a6d4623556ddb9f875e5b55dc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 26, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 12
      }
    },
    {
      "id": "sha1:14781785d7da8cfa3259d90936531c90219bbf04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 27, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 13
      }
    },
    {
      "id": "sha1:a98c1bcad44d5d0f6020168f11fa123e82120add",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 28, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 14
      }
    },
    {
      "id": "sha1:8178a7963c1fd33b76893bc97429db58fad72c69",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 29, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 15
      }
    },
    {
      "id": "sha1:2203bf90e45f4b41c9186fc115c9e440d3c5a642",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 30, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 16
      }
    },
    {
      "id": "sha1:d8f2deb3b45e0d8cfd646e5ed63c0c9cd2cda860",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 31, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 17
      }
    },
    {
      "id": "sha1:793b06d40ef1b2e5aaa1512db6a365936f6caf7d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 18
      }
    },
    {
      "id": "sha1:5e6213091a851e39da55af5377ba6c28f05bf280",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:5d745aa4f54de067504e6bfa67ec9899127ea55c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:77e7b2e3fae0018492edca3c5ef63770c63e2a27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 21
      }
    },
    {
      "id": "sha1:b0732b873decfb5e0bec8ba43262bacecced6208",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 22
      }
    },
    {
      "id": "sha1:f7c3ab1a7055266e12bd2183d747ae1d8157394c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:310de81a471e7b9aaa2bead669de8b24cd192aba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:8b5b7189eca0c4a3c75ec2a46030b289f11a6bc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 25
      }
    },
    {
      "id": "sha1:e41a28edf7a5962397b9a3910a6cecb1cfbe7e74",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 26
      }
    },
    {
      "id": "sha1:32f2050d1e39c37b382b387d1027ec8fcfaae6b7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 27
      }
    },
    {
      "id": "sha1:a201586853531df59fba36d433d3d122093e17c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:3b8700f21449c1a1183debc18097916859c99434",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 29
      }
    },
    {
      "id": "sha1:faa16dc20c67c9fab69f77f1fa8c09df335d03ca",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 30
      }
    },
    {
      "id": "sha1:959a0ef57646fde7116577252aac2ef5bd828525",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 31
      }
    },
    {
      "id": "sha1:c6398c65e6928ae44f7703222372453f141f3563",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:78f64eac6db3ecd78cc025330c71f2bca615827d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 33
      }
    },
    {
      "id": "sha1:e52cae6faacf185be2dbd95357f4eeac56b47528",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 34
      }
    },
    {
      "id": "sha1:44b5dd429cb2c29d5bccd47b1e184d11ce141659",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 35
      }
    },
    {
      "id": "sha1:d682b43fcdc0bf0a78c57dd348acb1781883b7fa",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 19, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:32af7b46588922c0203cf36c8ab58a110e01aedb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 20, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:ec8cc471dfc1cf7ccadf2d98f4cef0f6bdf76e53",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 21, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:f13a1f0585d03ac39ce2f4bab2ad807808f013ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 22, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 39
      }
    },
    {
      "id": "sha1:096c1bc0a8ecbc6ef719f831fb64c6a9733740c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 23, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5fbb17324ecf38b2e2d9a22d8d4fc847f4d86cc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 24, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:810afccf0d495ba4436e4a40cc0393b55772deba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 25, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:b8e5f571ada316af84fe4a88cb88a22fdb5d705b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 26, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:928d865b002ac76f966a690a88fbe48675ae49b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 27, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:0400ac811b8ce1a49c022ed9f2cb85cbe0ff77fd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 28, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:cb2266991020c869229880c2c9320d168d40befe",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 29, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:701148abbb03d36c8d556afb6923033ff6908dee",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 30, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:1eb5220f093edab10b46d94d2a5531acf3228884",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 31, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ba7ab61ef756b54dbc9fb7ca6d1625cdc8ce6648",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 49
      }
    },
    {
      "id": "sha1:d525e963f803d975bfd6444ec98b82a498cbecb3",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:53c522fb4d0b54fa7bf7bca6074c52856fe60723",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:0566dbf86e539c068a86d536d530b2bb4b95aca4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 52
      }
    },
    {
      "id": "sha1:6e6a2e14d4bbd7691f662be08590adb2efd07ec6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 53
      }
    },
    {
      "id": "sha1:7e9cc6df4f203568050407a932b645ffc55a43e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:d97568b498a259b9b146649a9dca7bf7436cc277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 55
      }
    },
    {
      "id": "sha1:ae910617cc1588ebb60599debd4c57c0dc94af92",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 56
      }
    },
    {
      "id": "sha1:7a706bedbb11b95ee96f5910bff153afffbd6277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 57
      }
    },
    {
      "id": "sha1:814e28db2fccce3c142f7051ef79edffc2d48975",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 58
      }
    },
    {
      "id": "sha1:42282d1cba10c6ab97bb2b7077648a82c8c3ba34",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 59
      }
    },
    {
      "id": "sha1:6f2103201631a1bd1d00cab184836d993e8eee6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 60
      }
    },
    {
      "id": "sha1:c5dfd66815bc4a900ba0e6788ed80d64f084665c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 61
      }
    },
    {
      "id": "sha1:0913e8a8ae9ae03ca9e4d24dce949a97ffbb76e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 62
      }
    },
    {
      "id": "sha1:aacd5610ebf43c175e1b19db9d1147265bdf2dc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 63
      }
    },
    {
      "id": "sha1:ef80c2ca75e41e00165857856d0191a399e03abf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 64
      }
    },
    {
      "id": "sha1:8b5819621644a68d99db0a89d816ba9f2b900fe5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 65
      }
    },
    {
      "id": "sha1:209237aab729726a51a3b23b417c525d80330a63",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 66
      }
    },
    {
      "id": "sha1:31e8a08e7c8288fbe8efd4adeec4da1a94881812",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 1
      }
    },
    {
      "id": "sha1:6f5a03516d3f21ee0986d2e80af8fa41ca4fa1c3",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:2d596aeef932b4696acedc60e1e88e9becd25e2f",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:c49c7e3778d3215f9c8bf052aeeafe1d3c6c2790",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:4e6505711749803f7e69e9931662d96a7f585448",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:229889bb8daa0c4ad1ded8d9d36dd36d571ca97f",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:76480b1fa2dc3b71516c47510a6f4f6a32f5315c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:57f2bbc0b647aa341e0f372788ef0e90217878e4",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:e35b89ebab004df08c46b1a9ec456d0e238a61a2",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:3080c6b6a0257090b542345c76e791ad09c819cc",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:a8244ce4cfee6097744b5461b22e7b670bd5e5cb",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:86605960cb0aa62dda5a0b350251fdcaaf3c6084",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:b872dde99d64df47638e9a7be9e441024353af4d",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:9de0a1a6fd494508b6f0b67e58a6d41c20df0ca1",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:f2e062d54ff5e7128c8bae35a5ed4f4bb4f0e017",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:6d9bb493eb76285333aa70bf8c06743c9954d513",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:43992abcbf4f52f5b9d5c641e2f060a9f4b7bc6a",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:91227ab0aefea6d34d09f8ff146bd087c405859b",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:0e6ea3cf45dc35ed460ddd740b20a38985a601a2",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:82ae526e5acef96595c90686283077d9462594cf",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:67a3b12798a5a41e0012007da901dd18f4619cfc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:beff16519df715218fc887448850b254ea313d25",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:b834168f0e64a3319545cd7cf11a21489d0a631a",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:c65865c85e5b7771704739aa166e9ac8767f1ffc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:0a6ced95835e693a0c6f544e19b89b7f33c77edc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:007d5010ac7c0de81abcc11ed953ac91ff2e699b",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:09b22dae31849a4425e85013b3c0625147d4762b",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:deb8687947bb3f3abe8f5a420077fb364da24dbc",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:09b015bbeacbb08e28b7c0ffffe74142802545c2",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:cacbb1a0e5ca2b84f8c79b7afd6f7e5e03d09d28",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  timezone: string;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  // eslint-disable-next-line no-console
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
// src/normalize.ts
import crypto from "node:crypto";
import { ParsedResult } from "./types";
import { ExamKind, ScheduleItem, ScheduleJsonV1, ParseIssue } from "./domain";

const TZ = "Europe/Bucharest";

const COL = {
  date: ["дата", "date", "day"],
  time: ["время", "time", "начало", "start"],
  group: ["группа", "группы", "group"],
  subject: ["предмет", "дисциплина", "subject"],
  kind: ["контроль", "вид_контроля", "форма_контроля", "type"],
  teacher: ["преподаватель", "фио", "teacher"],
  room: ["аудитория", "кабинет", "room"],
  notes: ["примечание", "комментарий", "notes"]
} as const;

function pick(row: Record<string, string | null>, keys: readonly string[]): string | null {
  for (const k of keys) {
    const v = row[k];
    if (typeof v === "string" && v.trim()) return v.trim();
  }
  return null;
}

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function parseKind(value: string | null): ExamKind {
  const v = (value ?? "").toLowerCase();

  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";

  return "OTHER";
}

function normalizeTime(value: string | null): { start: string | null; end: string | null } {
  if (!value) return { start: null, end: null };

  const v = value.replace(/\./g, ":").trim();
  const parts = v.split(/\s*[-–]\s*/);

  const start = parts[0] ? toHHmm(parts[0]) : null;
  const end = parts[1] ? toHHmm(parts[1]) : null;

  return { start, end };
}

function toHHmm(t: string): string | null {
  const m = t.trim().match(/^(\d{1,2})(?::(\d{1,2}))?$/);
  if (!m) return null;

  const hh = Number(m[1]);
  const mm = Number(m[2] ?? "0");

  if (!Number.isFinite(hh) || !Number.isFinite(mm)) return null;
  if (hh < 0 || hh > 23) return null;
  if (mm < 0 || mm > 59) return null;

  return `${String(hh).padStart(2, "0")}:${String(mm).padStart(2, "0")}`;
}

function normalizeDate(value: string | null): string | null {
  if (!value) return null;
  const v = value.trim();

  if (/^\d{4}-\d{2}-\d{2}$/.test(v)) return v;

  // dd.mm.yyyy or dd.mm.yy
  let m = v.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2}|\d{4})$/);
  if (m) {
    const dd = Number(m[1]);
    const mm = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  // mm/dd/yyyy or mm/dd/yy
  m = v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2}|\d{4})$/);
  if (m) {
    const mm = Number(m[1]);
    const dd = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  return null;
}

function isValidDate(y: number, m: number, d: number): boolean {
  if (y < 1900 || y > 2100) return false;
  if (m < 1 || m > 12) return false;
  if (d < 1 || d > 31) return false;

  const dt = new Date(Date.UTC(y, m - 1, d));
  return dt.getUTCFullYear() === y && dt.getUTCMonth() === m - 1 && dt.getUTCDate() === d;
}

function pad2(n: number): string {
  return String(n).padStart(2, "0");
}

export function normalizeToScheduleV1(parsed: ParsedResult, keepRaw: boolean = false): ScheduleJsonV1 {
  const issues: ParseIssue[] = [];
  const items: ScheduleItem[] = [];

  for (const sheet of parsed.sheets) {
    for (let i = 0; i < sheet.rows.length; i += 1) {
      const row = sheet.rows[i];

      const dateRaw = pick(row, COL.date);
      const timeRaw = pick(row, COL.time);
      const group = pick(row, COL.group);
      const subject = pick(row, COL.subject);
      const kindRaw = pick(row, COL.kind);
      const teacher = pick(row, COL.teacher);
      const room = pick(row, COL.room);
      const notes = pick(row, COL.notes);

      const hasSomething = Boolean(dateRaw || timeRaw || group || subject || kindRaw || teacher || room || notes);
      if (!hasSomething) continue;

      const date = normalizeDate(dateRaw);
      if (dateRaw && !date) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать дату: "${dateRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "date" }
        });
      }

      const time = normalizeTime(timeRaw);
      if (timeRaw && !time.start) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать время: "${timeRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "time" }
        });
      }

      const kind = parseKind(kindRaw);

      const stableKey = [
        sheet.sheetName,
        date ?? dateRaw ?? "",
        time.start ?? timeRaw ?? "",
        group ?? "",
        subject ?? "",
        kind,
        teacher ?? "",
        room ?? ""
      ].join("|");

      const item: ScheduleItem = {
        id: sha1(stableKey),
        date,
        time,
        timezone: TZ,
        group,
        subject,
        kind,
        teacher,
        location: { room, building: null },
        notes,
        source: { sheet: sheet.sheetName, row: i + 1 }
      };

      if (keepRaw) item.raw = row;

      items.push(item);
    }
  }

  // summary
  const groups = Array.from(new Set(items.map((x) => x.group).filter(Boolean) as string[])).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) itemsByGroup[it.group] += 1;
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: { sourceFileName: parsed.sourceFileName, parsedAt: parsed.parsedAt, version: "1.0" },
    summary: { items: items.length, groups, itemsByGroup, dateRange: { from, to } },
    items,
    issues
  };
}
</file>

<file path="src/parser.ts">
import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";

export async function parseExcelSchedule(filePath: string, sourceFileName: string): Promise<ParsedResult> {
  const workbook = xlsx.readFile(filePath, { cellDates: true, raw: false });
  const sheets: SheetData[] = [];

  for (const sheetName of workbook.SheetNames) {
    const worksheet = workbook.Sheets[sheetName];
    const matrix = xlsx.utils.sheet_to_json<(string | number | boolean | null)[]>(worksheet, {
      header: 1,
      defval: null,
      raw: false
    });

    const sheet = parseSheet(sheetName, matrix);
    sheets.push(sheet);
  }

  const memorySheets = sheets.map((sheet) => ({
    sheetName: sheet.sheetName,
    rowCount: sheet.rows.length,
    columns: sheet.headers
  }));

  const totalRows = memorySheets.reduce((sum, current) => sum + current.rowCount, 0);

  return {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets,
    memory: {
      sheetCount: sheets.length,
      totalRows,
      sheets: memorySheets
    }
  };
}

function parseSheet(
  sheetName: string,
  matrix: Array<Array<string | number | boolean | null>>
): SheetData {
  if (matrix.length === 0) {
    return {
      sheetName,
      headers: [],
      rows: []
    };
  }

  const headerIndex = findHeaderRowIndex(matrix);
  const headerRow = matrix[headerIndex] ?? [];
  const headers = normalizeHeaders(headerRow);

  const rows: Record<string, string | null>[] = [];

  for (let i = headerIndex + 1; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    if (!rowHasData(row)) {
      continue;
    }

    const mapped: Record<string, string | null> = {};
    for (let col = 0; col < headers.length; col += 1) {
      mapped[headers[col]] = formatCell(row[col]);
    }

    rows.push(mapped);
  }

  return {
    sheetName,
    headers,
    rows
  };
}

function findHeaderRowIndex(matrix: Array<Array<string | number | boolean | null>>): number {
  for (let i = 0; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    const filled = row.filter((cell) => cellHasData(cell));
    if (filled.length >= 2) {
      return i;
    }
  }

  return 0;
}

function normalizeHeaders(row: Array<string | number | boolean | null>): string[] {
  const used = new Set<string>();

  return row.map((cell, index) => {
    const base = sanitizeHeader(formatCell(cell) ?? `column_${index + 1}`) || `column_${index + 1}`;

    let candidate = base;
    let suffix = 2;
    while (used.has(candidate)) {
      candidate = `${base}_${suffix}`;
      suffix += 1;
    }

    used.add(candidate);
    return candidate;
  });
}

function sanitizeHeader(value: string): string {
  return value
    .trim()
    .replace(/\s+/g, "_")
    .replace(/[^\p{L}\p{N}_]/gu, "")
    .toLowerCase();
}

function formatCell(value: string | number | boolean | null | undefined): string | null {
  if (!cellHasData(value)) {
    return null;
  }

  return String(value).trim();
}

function cellHasData(value: string | number | boolean | null | undefined): boolean {
  if (value === null || value === undefined) {
    return false;
  }

  if (typeof value === "string" && value.trim() === "") {
    return false;
  }

  return true;
}

function rowHasData(row: Array<string | number | boolean | null>): boolean {
  return row.some((cell) => cellHasData(cell));
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024
    }
  });

  const taskService = options.taskService ?? new TaskService(config);

  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null
    });
  });

  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      return res.json({
        taskId: task.id,
        memory: result.memory
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task memory",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.use((error: unknown, _req: express.Request, res: express.Response, next: express.NextFunction) => {
    if (error instanceof multer.MulterError) {
      const details =
        error.code === "LIMIT_FILE_SIZE"
          ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
          : error.message;

      return res.status(400).json({
        error: "Upload error",
        details
      });
    }

    return next(error);
  });

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { ParsedResult, TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    
    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString()
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ParsedResult> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ParsedResult;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) {
        continue;
      }

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

// task-service.ts (внутри класса)
private async processTask(taskId: string): Promise<void> {
  const task = this.tasks.get(taskId);
  if (!task) return;

  task.status = "processing";
  task.startedAt = new Date().toISOString();

  try {
    const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);

    // NEW: нормализуем
    const normalized = normalizeToScheduleV1(parsed, false);

    await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

    task.status = "completed";
    task.finishedAt = new Date().toISOString();
  } catch (error) {
    task.status = "failed";
    task.finishedAt = new Date().toISOString();
    task.error = error instanceof Error ? error.message : "Unknown processing error";
  }
}
}
</file>

<file path="src/types.ts">
export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="repomix-output2.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
repomix-output1.xml
result.json
result1.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="repomix-output1.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
result.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-18T15:43:23.752Z",
    "version": "1.0"
  },
  "summary": {
    "items": 96,
    "groups": [
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2Ф",
      "3ПО",
      "4ПО",
      "4Ф",
      "Friday, December 20, 2024",
      "Friday, December 27, 2024",
      "Friday, February 07, 2025",
      "Friday, February 14, 2025",
      "Friday, January 03, 2025",
      "Friday, January 10, 2025",
      "Friday, January 17, 2025",
      "Friday, January 24, 2025",
      "Friday, January 31, 2025",
      "Monday, December 16, 2024",
      "Monday, December 23, 2024",
      "Monday, December 30, 2024",
      "Monday, February 03, 2025",
      "Monday, February 10, 2025",
      "Monday, February 17, 2025",
      "Monday, January 06, 2025",
      "Monday, January 13, 2025",
      "Monday, January 20, 2025",
      "Monday, January 27, 2025",
      "Saturday, December 21, 2024",
      "Saturday, December 28, 2024",
      "Saturday, February 01, 2025",
      "Saturday, February 08, 2025",
      "Saturday, February 15, 2025",
      "Saturday, January 04, 2025",
      "Saturday, January 11, 2025",
      "Saturday, January 18, 2025",
      "Saturday, January 25, 2025",
      "Sunday, December 22, 2024",
      "Sunday, December 29, 2024",
      "Sunday, February 02, 2025",
      "Sunday, February 09, 2025",
      "Sunday, February 16, 2025",
      "Sunday, January 05, 2025",
      "Sunday, January 12, 2025",
      "Sunday, January 19, 2025",
      "Sunday, January 26, 2025",
      "Thursday, December 19, 2024",
      "Thursday, December 26, 2024",
      "Thursday, February 06, 2025",
      "Thursday, February 13, 2025",
      "Thursday, January 02, 2025",
      "Thursday, January 09, 2025",
      "Thursday, January 16, 2025",
      "Thursday, January 23, 2025",
      "Thursday, January 30, 2025",
      "Tuesday, December 17, 2024",
      "Tuesday, December 24, 2024",
      "Tuesday, December 31, 2024",
      "Tuesday, February 04, 2025",
      "Tuesday, February 11, 2025",
      "Tuesday, February 18, 2025",
      "Tuesday, January 07, 2025",
      "Tuesday, January 14, 2025",
      "Tuesday, January 21, 2025",
      "Tuesday, January 28, 2025",
      "Wednesday, December 18, 2024",
      "Wednesday, December 25, 2024",
      "Wednesday, February 05, 2025",
      "Wednesday, February 12, 2025",
      "Wednesday, January 01, 2025",
      "Wednesday, January 08, 2025",
      "Wednesday, January 15, 2025",
      "Wednesday, January 22, 2025",
      "Wednesday, January 29, 2025",
      "Даты"
    ],
    "itemsByGroup": {
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2Ф": 1,
      "3ПО": 1,
      "4ПО": 2,
      "4Ф": 1,
      "Friday, December 20, 2024": 1,
      "Friday, December 27, 2024": 1,
      "Friday, February 07, 2025": 1,
      "Friday, February 14, 2025": 1,
      "Friday, January 03, 2025": 1,
      "Friday, January 10, 2025": 1,
      "Friday, January 17, 2025": 1,
      "Friday, January 24, 2025": 1,
      "Friday, January 31, 2025": 1,
      "Monday, December 16, 2024": 1,
      "Monday, December 23, 2024": 1,
      "Monday, December 30, 2024": 1,
      "Monday, February 03, 2025": 1,
      "Monday, February 10, 2025": 1,
      "Monday, February 17, 2025": 1,
      "Monday, January 06, 2025": 1,
      "Monday, January 13, 2025": 1,
      "Monday, January 20, 2025": 1,
      "Monday, January 27, 2025": 1,
      "Saturday, December 21, 2024": 1,
      "Saturday, December 28, 2024": 1,
      "Saturday, February 01, 2025": 1,
      "Saturday, February 08, 2025": 1,
      "Saturday, February 15, 2025": 1,
      "Saturday, January 04, 2025": 1,
      "Saturday, January 11, 2025": 1,
      "Saturday, January 18, 2025": 1,
      "Saturday, January 25, 2025": 1,
      "Sunday, December 22, 2024": 1,
      "Sunday, December 29, 2024": 1,
      "Sunday, February 02, 2025": 1,
      "Sunday, February 09, 2025": 1,
      "Sunday, February 16, 2025": 1,
      "Sunday, January 05, 2025": 1,
      "Sunday, January 12, 2025": 1,
      "Sunday, January 19, 2025": 1,
      "Sunday, January 26, 2025": 1,
      "Thursday, December 19, 2024": 1,
      "Thursday, December 26, 2024": 1,
      "Thursday, February 06, 2025": 1,
      "Thursday, February 13, 2025": 1,
      "Thursday, January 02, 2025": 1,
      "Thursday, January 09, 2025": 1,
      "Thursday, January 16, 2025": 1,
      "Thursday, January 23, 2025": 1,
      "Thursday, January 30, 2025": 1,
      "Tuesday, December 17, 2024": 1,
      "Tuesday, December 24, 2024": 1,
      "Tuesday, December 31, 2024": 1,
      "Tuesday, February 04, 2025": 1,
      "Tuesday, February 11, 2025": 1,
      "Tuesday, February 18, 2025": 1,
      "Tuesday, January 07, 2025": 1,
      "Tuesday, January 14, 2025": 1,
      "Tuesday, January 21, 2025": 1,
      "Tuesday, January 28, 2025": 1,
      "Wednesday, December 18, 2024": 1,
      "Wednesday, December 25, 2024": 1,
      "Wednesday, February 05, 2025": 1,
      "Wednesday, February 12, 2025": 1,
      "Wednesday, January 01, 2025": 1,
      "Wednesday, January 08, 2025": 1,
      "Wednesday, January 15, 2025": 1,
      "Wednesday, January 22, 2025": 1,
      "Wednesday, January 29, 2025": 1,
      "Даты": 1
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:53c2d85d754ebbac4242877a5642396b54c36c88",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Даты",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 1
      }
    },
    {
      "id": "sha1:58591cc23b2e83cbf70f8a06819023661889fd9d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 16, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 2
      }
    },
    {
      "id": "sha1:a572aa0addcfab891e676a28ffab43acb125de03",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 17, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 3
      }
    },
    {
      "id": "sha1:725e44f8e57a7733c594d4632c4daf25cb97b3d1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 18, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 4
      }
    },
    {
      "id": "sha1:00c86ca9db5469fcc4ac7427ca178f0cee70062a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 19, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 5
      }
    },
    {
      "id": "sha1:159cdeca04a1bddc6f12195680eaa29be8f7badb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 20, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 6
      }
    },
    {
      "id": "sha1:07574887f3965230d6ef429d3da18ea1a5847b83",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 21, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 7
      }
    },
    {
      "id": "sha1:19101165d73dfde009e2ba890d44ef17220f2791",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 22, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 8
      }
    },
    {
      "id": "sha1:2c9eb4927122454072ccf8a03fdb33147c81a2ea",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 23, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 9
      }
    },
    {
      "id": "sha1:03586517d879b96c3858c730816c5f1473bb17d9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 24, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 10
      }
    },
    {
      "id": "sha1:df858b8beef7ad8d8c20ae8169e27fa2f927ed5b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 25, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 11
      }
    },
    {
      "id": "sha1:95a621a83a19f11a6d4623556ddb9f875e5b55dc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 26, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 12
      }
    },
    {
      "id": "sha1:14781785d7da8cfa3259d90936531c90219bbf04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 27, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 13
      }
    },
    {
      "id": "sha1:a98c1bcad44d5d0f6020168f11fa123e82120add",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 28, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 14
      }
    },
    {
      "id": "sha1:8178a7963c1fd33b76893bc97429db58fad72c69",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 29, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 15
      }
    },
    {
      "id": "sha1:2203bf90e45f4b41c9186fc115c9e440d3c5a642",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 30, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 16
      }
    },
    {
      "id": "sha1:d8f2deb3b45e0d8cfd646e5ed63c0c9cd2cda860",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 31, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 17
      }
    },
    {
      "id": "sha1:793b06d40ef1b2e5aaa1512db6a365936f6caf7d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 18
      }
    },
    {
      "id": "sha1:5e6213091a851e39da55af5377ba6c28f05bf280",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:5d745aa4f54de067504e6bfa67ec9899127ea55c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:77e7b2e3fae0018492edca3c5ef63770c63e2a27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 21
      }
    },
    {
      "id": "sha1:b0732b873decfb5e0bec8ba43262bacecced6208",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 22
      }
    },
    {
      "id": "sha1:f7c3ab1a7055266e12bd2183d747ae1d8157394c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:310de81a471e7b9aaa2bead669de8b24cd192aba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:8b5b7189eca0c4a3c75ec2a46030b289f11a6bc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 25
      }
    },
    {
      "id": "sha1:e41a28edf7a5962397b9a3910a6cecb1cfbe7e74",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 26
      }
    },
    {
      "id": "sha1:32f2050d1e39c37b382b387d1027ec8fcfaae6b7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 27
      }
    },
    {
      "id": "sha1:a201586853531df59fba36d433d3d122093e17c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:3b8700f21449c1a1183debc18097916859c99434",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 29
      }
    },
    {
      "id": "sha1:faa16dc20c67c9fab69f77f1fa8c09df335d03ca",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 30
      }
    },
    {
      "id": "sha1:959a0ef57646fde7116577252aac2ef5bd828525",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 31
      }
    },
    {
      "id": "sha1:c6398c65e6928ae44f7703222372453f141f3563",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:78f64eac6db3ecd78cc025330c71f2bca615827d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 33
      }
    },
    {
      "id": "sha1:e52cae6faacf185be2dbd95357f4eeac56b47528",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 34
      }
    },
    {
      "id": "sha1:44b5dd429cb2c29d5bccd47b1e184d11ce141659",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 35
      }
    },
    {
      "id": "sha1:d682b43fcdc0bf0a78c57dd348acb1781883b7fa",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 19, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:32af7b46588922c0203cf36c8ab58a110e01aedb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 20, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:ec8cc471dfc1cf7ccadf2d98f4cef0f6bdf76e53",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 21, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:f13a1f0585d03ac39ce2f4bab2ad807808f013ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 22, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 39
      }
    },
    {
      "id": "sha1:096c1bc0a8ecbc6ef719f831fb64c6a9733740c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 23, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5fbb17324ecf38b2e2d9a22d8d4fc847f4d86cc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 24, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:810afccf0d495ba4436e4a40cc0393b55772deba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 25, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:b8e5f571ada316af84fe4a88cb88a22fdb5d705b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 26, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:928d865b002ac76f966a690a88fbe48675ae49b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 27, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:0400ac811b8ce1a49c022ed9f2cb85cbe0ff77fd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 28, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:cb2266991020c869229880c2c9320d168d40befe",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 29, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:701148abbb03d36c8d556afb6923033ff6908dee",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 30, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:1eb5220f093edab10b46d94d2a5531acf3228884",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 31, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ba7ab61ef756b54dbc9fb7ca6d1625cdc8ce6648",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 49
      }
    },
    {
      "id": "sha1:d525e963f803d975bfd6444ec98b82a498cbecb3",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:53c522fb4d0b54fa7bf7bca6074c52856fe60723",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:0566dbf86e539c068a86d536d530b2bb4b95aca4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 52
      }
    },
    {
      "id": "sha1:6e6a2e14d4bbd7691f662be08590adb2efd07ec6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 53
      }
    },
    {
      "id": "sha1:7e9cc6df4f203568050407a932b645ffc55a43e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:d97568b498a259b9b146649a9dca7bf7436cc277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 55
      }
    },
    {
      "id": "sha1:ae910617cc1588ebb60599debd4c57c0dc94af92",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 56
      }
    },
    {
      "id": "sha1:7a706bedbb11b95ee96f5910bff153afffbd6277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 57
      }
    },
    {
      "id": "sha1:814e28db2fccce3c142f7051ef79edffc2d48975",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 58
      }
    },
    {
      "id": "sha1:42282d1cba10c6ab97bb2b7077648a82c8c3ba34",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 59
      }
    },
    {
      "id": "sha1:6f2103201631a1bd1d00cab184836d993e8eee6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 60
      }
    },
    {
      "id": "sha1:c5dfd66815bc4a900ba0e6788ed80d64f084665c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 61
      }
    },
    {
      "id": "sha1:0913e8a8ae9ae03ca9e4d24dce949a97ffbb76e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 62
      }
    },
    {
      "id": "sha1:aacd5610ebf43c175e1b19db9d1147265bdf2dc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 63
      }
    },
    {
      "id": "sha1:ef80c2ca75e41e00165857856d0191a399e03abf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 64
      }
    },
    {
      "id": "sha1:8b5819621644a68d99db0a89d816ba9f2b900fe5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 65
      }
    },
    {
      "id": "sha1:209237aab729726a51a3b23b417c525d80330a63",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 66
      }
    },
    {
      "id": "sha1:31e8a08e7c8288fbe8efd4adeec4da1a94881812",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 1
      }
    },
    {
      "id": "sha1:6f5a03516d3f21ee0986d2e80af8fa41ca4fa1c3",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:2d596aeef932b4696acedc60e1e88e9becd25e2f",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:c49c7e3778d3215f9c8bf052aeeafe1d3c6c2790",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:4e6505711749803f7e69e9931662d96a7f585448",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:229889bb8daa0c4ad1ded8d9d36dd36d571ca97f",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:76480b1fa2dc3b71516c47510a6f4f6a32f5315c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:57f2bbc0b647aa341e0f372788ef0e90217878e4",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:e35b89ebab004df08c46b1a9ec456d0e238a61a2",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:3080c6b6a0257090b542345c76e791ad09c819cc",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:a8244ce4cfee6097744b5461b22e7b670bd5e5cb",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:86605960cb0aa62dda5a0b350251fdcaaf3c6084",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:b872dde99d64df47638e9a7be9e441024353af4d",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:9de0a1a6fd494508b6f0b67e58a6d41c20df0ca1",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:f2e062d54ff5e7128c8bae35a5ed4f4bb4f0e017",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:6d9bb493eb76285333aa70bf8c06743c9954d513",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:43992abcbf4f52f5b9d5c641e2f060a9f4b7bc6a",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:91227ab0aefea6d34d09f8ff146bd087c405859b",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:0e6ea3cf45dc35ed460ddd740b20a38985a601a2",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:82ae526e5acef96595c90686283077d9462594cf",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:67a3b12798a5a41e0012007da901dd18f4619cfc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:beff16519df715218fc887448850b254ea313d25",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:b834168f0e64a3319545cd7cf11a21489d0a631a",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:c65865c85e5b7771704739aa166e9ac8767f1ffc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:0a6ced95835e693a0c6f544e19b89b7f33c77edc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:007d5010ac7c0de81abcc11ed953ac91ff2e699b",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:09b22dae31849a4425e85013b3c0625147d4762b",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:deb8687947bb3f3abe8f5a420077fb364da24dbc",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:09b015bbeacbb08e28b7c0ffffe74142802545c2",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:cacbb1a0e5ca2b84f8c79b7afd6f7e5e03d09d28",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  timezone: string;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  // eslint-disable-next-line no-console
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
// src/normalize.ts
import crypto from "node:crypto";
import { ParsedResult } from "./types";
import { ExamKind, ScheduleItem, ScheduleJsonV1, ParseIssue } from "./domain";

const TZ = "Europe/Bucharest";

const COL = {
  date: ["дата", "date", "day"],
  time: ["время", "time", "начало", "start"],
  group: ["группа", "группы", "group"],
  subject: ["предмет", "дисциплина", "subject"],
  kind: ["контроль", "вид_контроля", "форма_контроля", "type"],
  teacher: ["преподаватель", "фио", "teacher"],
  room: ["аудитория", "кабинет", "room"],
  notes: ["примечание", "комментарий", "notes"]
} as const;

function pick(row: Record<string, string | null>, keys: readonly string[]): string | null {
  for (const k of keys) {
    const v = row[k];
    if (typeof v === "string" && v.trim()) return v.trim();
  }
  return null;
}

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function parseKind(value: string | null): ExamKind {
  const v = (value ?? "").toLowerCase();

  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";

  return "OTHER";
}

function normalizeTime(value: string | null): { start: string | null; end: string | null } {
  if (!value) return { start: null, end: null };

  const v = value.replace(/\./g, ":").trim();
  const parts = v.split(/\s*[-–]\s*/);

  const start = parts[0] ? toHHmm(parts[0]) : null;
  const end = parts[1] ? toHHmm(parts[1]) : null;

  return { start, end };
}

function toHHmm(t: string): string | null {
  const m = t.trim().match(/^(\d{1,2})(?::(\d{1,2}))?$/);
  if (!m) return null;

  const hh = Number(m[1]);
  const mm = Number(m[2] ?? "0");

  if (!Number.isFinite(hh) || !Number.isFinite(mm)) return null;
  if (hh < 0 || hh > 23) return null;
  if (mm < 0 || mm > 59) return null;

  return `${String(hh).padStart(2, "0")}:${String(mm).padStart(2, "0")}`;
}

function normalizeDate(value: string | null): string | null {
  if (!value) return null;
  const v = value.trim();

  if (/^\d{4}-\d{2}-\d{2}$/.test(v)) return v;

  // dd.mm.yyyy or dd.mm.yy
  let m = v.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2}|\d{4})$/);
  if (m) {
    const dd = Number(m[1]);
    const mm = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  // mm/dd/yyyy or mm/dd/yy
  m = v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2}|\d{4})$/);
  if (m) {
    const mm = Number(m[1]);
    const dd = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  return null;
}

function isValidDate(y: number, m: number, d: number): boolean {
  if (y < 1900 || y > 2100) return false;
  if (m < 1 || m > 12) return false;
  if (d < 1 || d > 31) return false;

  const dt = new Date(Date.UTC(y, m - 1, d));
  return dt.getUTCFullYear() === y && dt.getUTCMonth() === m - 1 && dt.getUTCDate() === d;
}

function pad2(n: number): string {
  return String(n).padStart(2, "0");
}

export function normalizeToScheduleV1(parsed: ParsedResult, keepRaw: boolean = false): ScheduleJsonV1 {
  const issues: ParseIssue[] = [];
  const items: ScheduleItem[] = [];

  for (const sheet of parsed.sheets) {
    for (let i = 0; i < sheet.rows.length; i += 1) {
      const row = sheet.rows[i];

      const dateRaw = pick(row, COL.date);
      const timeRaw = pick(row, COL.time);
      const group = pick(row, COL.group);
      const subject = pick(row, COL.subject);
      const kindRaw = pick(row, COL.kind);
      const teacher = pick(row, COL.teacher);
      const room = pick(row, COL.room);
      const notes = pick(row, COL.notes);

      const hasSomething = Boolean(dateRaw || timeRaw || group || subject || kindRaw || teacher || room || notes);
      if (!hasSomething) continue;

      const date = normalizeDate(dateRaw);
      if (dateRaw && !date) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать дату: "${dateRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "date" }
        });
      }

      const time = normalizeTime(timeRaw);
      if (timeRaw && !time.start) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать время: "${timeRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "time" }
        });
      }

      const kind = parseKind(kindRaw);

      const stableKey = [
        sheet.sheetName,
        date ?? dateRaw ?? "",
        time.start ?? timeRaw ?? "",
        group ?? "",
        subject ?? "",
        kind,
        teacher ?? "",
        room ?? ""
      ].join("|");

      const item: ScheduleItem = {
        id: sha1(stableKey),
        date,
        time,
        timezone: TZ,
        group,
        subject,
        kind,
        teacher,
        location: { room, building: null },
        notes,
        source: { sheet: sheet.sheetName, row: i + 1 }
      };

      if (keepRaw) item.raw = row;

      items.push(item);
    }
  }

  // summary
  const groups = Array.from(new Set(items.map((x) => x.group).filter(Boolean) as string[])).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) itemsByGroup[it.group] += 1;
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: { sourceFileName: parsed.sourceFileName, parsedAt: parsed.parsedAt, version: "1.0" },
    summary: { items: items.length, groups, itemsByGroup, dateRange: { from, to } },
    items,
    issues
  };
}
</file>

<file path="src/parser.ts">
import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";

export async function parseExcelSchedule(filePath: string, sourceFileName: string): Promise<ParsedResult> {
  const workbook = xlsx.readFile(filePath, { cellDates: true, raw: false });
  const sheets: SheetData[] = [];

  for (const sheetName of workbook.SheetNames) {
    const worksheet = workbook.Sheets[sheetName];
    const matrix = xlsx.utils.sheet_to_json<(string | number | boolean | null)[]>(worksheet, {
      header: 1,
      defval: null,
      raw: false
    });

    const sheet = parseSheet(sheetName, matrix);
    sheets.push(sheet);
  }

  const memorySheets = sheets.map((sheet) => ({
    sheetName: sheet.sheetName,
    rowCount: sheet.rows.length,
    columns: sheet.headers
  }));

  const totalRows = memorySheets.reduce((sum, current) => sum + current.rowCount, 0);

  return {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets,
    memory: {
      sheetCount: sheets.length,
      totalRows,
      sheets: memorySheets
    }
  };
}

function parseSheet(
  sheetName: string,
  matrix: Array<Array<string | number | boolean | null>>
): SheetData {
  if (matrix.length === 0) {
    return {
      sheetName,
      headers: [],
      rows: []
    };
  }

  const headerIndex = findHeaderRowIndex(matrix);
  const headerRow = matrix[headerIndex] ?? [];
  const headers = normalizeHeaders(headerRow);

  const rows: Record<string, string | null>[] = [];

  for (let i = headerIndex + 1; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    if (!rowHasData(row)) {
      continue;
    }

    const mapped: Record<string, string | null> = {};
    for (let col = 0; col < headers.length; col += 1) {
      mapped[headers[col]] = formatCell(row[col]);
    }

    rows.push(mapped);
  }

  return {
    sheetName,
    headers,
    rows
  };
}

function findHeaderRowIndex(matrix: Array<Array<string | number | boolean | null>>): number {
  for (let i = 0; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    const filled = row.filter((cell) => cellHasData(cell));
    if (filled.length >= 2) {
      return i;
    }
  }

  return 0;
}

function normalizeHeaders(row: Array<string | number | boolean | null>): string[] {
  const used = new Set<string>();

  return row.map((cell, index) => {
    const base = sanitizeHeader(formatCell(cell) ?? `column_${index + 1}`) || `column_${index + 1}`;

    let candidate = base;
    let suffix = 2;
    while (used.has(candidate)) {
      candidate = `${base}_${suffix}`;
      suffix += 1;
    }

    used.add(candidate);
    return candidate;
  });
}

function sanitizeHeader(value: string): string {
  return value
    .trim()
    .replace(/\s+/g, "_")
    .replace(/[^\p{L}\p{N}_]/gu, "")
    .toLowerCase();
}

function formatCell(value: string | number | boolean | null | undefined): string | null {
  if (!cellHasData(value)) {
    return null;
  }

  return String(value).trim();
}

function cellHasData(value: string | number | boolean | null | undefined): boolean {
  if (value === null || value === undefined) {
    return false;
  }

  if (typeof value === "string" && value.trim() === "") {
    return false;
  }

  return true;
}

function rowHasData(row: Array<string | number | boolean | null>): boolean {
  return row.some((cell) => cellHasData(cell));
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024
    }
  });

  const taskService = options.taskService ?? new TaskService(config);

  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null
    });
  });

  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      return res.json({
        taskId: task.id,
        memory: result.memory
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task memory",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.use((error: unknown, _req: express.Request, res: express.Response, next: express.NextFunction) => {
    if (error instanceof multer.MulterError) {
      const details =
        error.code === "LIMIT_FILE_SIZE"
          ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
          : error.message;

      return res.status(400).json({
        error: "Upload error",
        details
      });
    }

    return next(error);
  });

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { ParsedResult, TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    
    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString()
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ParsedResult> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ParsedResult;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) {
        continue;
      }

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

// task-service.ts (внутри класса)
private async processTask(taskId: string): Promise<void> {
  const task = this.tasks.get(taskId);
  if (!task) return;

  task.status = "processing";
  task.startedAt = new Date().toISOString();

  try {
    const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);

    // NEW: нормализуем
    const normalized = normalizeToScheduleV1(parsed, false);

    await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

    task.status = "completed";
    task.finishedAt = new Date().toISOString();
  } catch (error) {
    task.status = "failed";
    task.finishedAt = new Date().toISOString();
    task.error = error instanceof Error ? error.message : "Unknown processing error";
  }
}
}
</file>

<file path="src/types.ts">
export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T11:27:45.087Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:a79f1da953375c892bbec38505332ab4ddc8aa91",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:882bb25e3b97e95b092ce0389f10dd5cc315bd30",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:836342c5bf177b19c9ed6e777006269a1bee4023",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:75a091035a6ef4ecfec7cfca104654f4732a84fc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:e7df833ab0c6b9f69f2602e2bf9d7274b6dbee8b",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:e52ab2b7879087c20325364b7328c1ae2d6a8f62",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:9ff503afbc84c63b5b2f9d4b40b8af8557b2234c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:b5f0ceef2149cf88e3f34be46080221d905e3ebf",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:9feb96976e9a2dc3a50a15285a6db0650db71f59",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:0c5e92cff9298849d4e0daac84dab1f02f50afba",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:fca41f1c8aedf12782e31b766da03a5cf569e49d",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:19e8eb3d40adbb74d7cad023b0d32c0afe289ebf",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:adac790f019474d3f7716c322cd824d1197e6aac",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:70ef068ab43fb27d3a463f00570a654f20b195dc",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:5fe17a74b6ccbde805d7a6f394387ecab79e4a9d",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:5751182188967801fed8cb070286457259bdb586",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:96e2e90d227621b4c4cdcfbf40d557e623635c79",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:31a97cb569a33f507186ba35aa93966f3f51c027",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:9b63749c2413ae7f6379d8b9bf1852354da9b89a",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:63d25370db1f35e83f99cb139b5e588f83c3f7e2",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:81a7eb86eeee70808071b8585d5f9589571dffca",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:d1b9d610e6ebeb6f88563d28ce423821c130d735",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:13f3cb5571629c035bda34c9b0afa074ee42da96",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:54792b7f03dbe8dfc6f30d23c92f2939b7c20c97",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:a92042ded2f06b552f2ebac3c06ea78c41139058",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:c05709a1c1c40b968b9e2c2f76517f427c0e41be",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:1ccff255f2b775cb5babc0e44ca6e445634200fa",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:1494d4ee9f53ddfdc15e88c55dadd213f6ebdd0d",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:21ec9e19d8beae2c4ab68d20d45f92f8ae7bd428",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:57f77bb1126b06b0b4503e2dc75c98a7aa75f77e",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="result1.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T10:55:38.534Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "1/10/21",
      "to": "12/29/20"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:f2688ce77cb95d03c03b0ba21746b97c41d0cb54",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:077d23d8749c23ed0fdedacc624ce47b1ee495d8",
      "date": "1/12/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:b1a2897d707e6e89aa7ff8f01f705ecbd5a520d0",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:086c3fd57b898c1b3ce2a0f1aad9d95439149fcb",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:21fa369690ea4ecc4584284b0fbebbc462e2d9a3",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:a68602e9bfdd8618612ab9f0847e603780b02c73",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:b06871c3b09a41a60c93e09c562be44d918162ad",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:d576e45d172261173b033bb1a982d825bd1e33c5",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:ecb166cd7c9a9e49e8d04c6b1c240c85074203e3",
      "date": "1/9/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:296dfc75b6a3a15f446bc311cf89177ff2e1f804",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:45cfe83d13007440844863edb31c989fdf124434",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:a2eead52f206bab6330425392b608c8f53a35630",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:aea62c3a5cb7396659030adf3075723b8c266611",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:90e6a470c3f8962a3fa615d9e2acb69615cdcbd8",
      "date": "1/25/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:b81ea0e113ddb88d42bdf01311472f02d876b71a",
      "date": "12/28/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:2fc81c1850ade2d3ebed834cca2075eec094ae0d",
      "date": "12/29/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:f1d733dad039d08269b4a41915435c598ee42b6f",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:5d35ffababa1cd9db724cac257cc32e6f683c230",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:8de0c4f5440c691d46337a8cee911b4f34a98725",
      "date": "1/21/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:73bfe39944e406674d1fcb19168b702ff849b7b8",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:3e6462337b180f228d3dcbae766651dce159220e",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:4ae1187507929a0fa346aff676fa3c1ec59685aa",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:fad2aece649efaaa0f92920b9ba7d1e538aaae98",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:2e295aafce1c3c8092641c11b813ee3f91b30e0e",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:079fa2220a3b2cbad9f9ddd93d9432eb26ba3e5f",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:05c5a1de645466bacfa9f2e8bfb227f0154935c2",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:533127a8afb20c861b5b2b6996b7d87b052ab1ea",
      "date": "1/15/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:5656d05976f75301dbe16b1f75e2682ba84bd801",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:bb907df7f2cc6441cbd3d16f4093d41b660aa3de",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:cbaa0ccb2ed62a6aa556f2d885278f2ea5996016",
      "date": "1/18/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
import { ParsedResult } from "./types";
import { ScheduleItem, ScheduleJsonV1 } from "./domain";

export function normalizeToScheduleV1(
  parsed: ParsedResult & { _parsedItems?: ScheduleItem[] },
  _keepRaw: boolean = false
): ScheduleJsonV1 {
  const items: ScheduleItem[] = parsed._parsedItems ?? [];

  // Summary
  const groupSet = new Set<string>();
  for (const it of items) {
    if (it.group) groupSet.add(it.group);
  }
  const groups = Array.from(groupSet).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) {
      itemsByGroup[it.group] += 1;
    }
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: {
      sourceFileName: parsed.sourceFileName,
      parsedAt: parsed.parsedAt,
      version: "1.0",
    },
    summary: {
      items: items.length,
      groups,
      itemsByGroup,
      dateRange: { from, to },
    },
    items,
    issues: [],
  };
}
</file>

<file path="src/parser.ts">
/**
 * parser.ts
 *
 * Парсер Excel-файла расписания сессии физического факультета.
 *
 * Поддерживает два формата листов:
 *
 * ЛИСТ1 — матрица «дата × группа»
 *   Строка 10: заголовки колонок — первые 2 служебные («Группы», «День недели»),
 *              дальше названия групп.
 *   Строка 11: «Даты» (пропускаем)
 *   Строки 12+: col1 = дата, col2 = дата (дубль), col3..N = текст ячейки для группы.
 *   Ячейка может содержать: "404  Предмет  Преподаватель И.О." (всё в одной строке/ячейке).
 *
 * ЛИСТ2 — плоская таблица
 *   Строка 1: заголовки: ФИО | Дата | Группа | Предмет | Контроль
 *   Строки 2+: данные.  ФИО преподавателя может быть только в строке-«консультации»,
 *              а следующая строка — экзамен того же преподавателя.
 */

import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";
import { ScheduleItem, ExamKind } from "./domain";
import crypto from "node:crypto";

// ────────────────────────────────────────────────────────────────────────────
// Helpers
// ────────────────────────────────────────────────────────────────────────────


// Ячейка Лист1: "404\nПредмет\nПреподаватель И.О." или "404  Предмет  Преп И.О."
// Извлекает аудиторию (2-3 цифры + буква/слэш), предмет, преподавателя.
const ROOM_RE = /^([\d]{2,3}[а-яА-ЯёЁa-zA-Z]?(?:\/[\d]+)?)\s*[\n\s]+/;

// Фамилия И.О. — полные инициалы: "Коржаков В.Е."
const TEACHER_FULL_RE =
  /([А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.(?:,\s*[А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.)*)\s*(?:дист\.?)?\s*$/;

// Фамилия И. — только одна буква (краткая запись): "Теплоухов С."
const TEACHER_SHORT_RE = /([А-ЯЁ][а-яё]+\s+[А-ЯЁ]\.)\s*(?:дист\.?)?\s*$/;

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function formatDate(d: Date): string {
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}-${m}-${day}`;
}

/**
 * Конвертирует Excel serial number в "YYYY-MM-DD".
 * xlsx без cellDates возвращает даты как числа (например, 45642 = 2024-12-23).
 * Также обрабатывает строки формата "M/D/YY" которые xlsx иногда отдаёт.
 */
function parseExcelDate(value: string | number | null | undefined): string | null {
  if (value === null || value === undefined || value === "") return null;

  // Числовой Excel serial (например 45642)
  if (typeof value === "number") {
    // xlsx.SSF.parse_date_code не учитывает баг Excel с 1900 как високосным годом.
    // Надёжнее считать вручную: Excel serial = дни с 1899-12-31 (epoch = день 1).
    // Прибавляем serial - 1 дней к 1899-12-31, что эквивалентно serial дням к 1899-12-30.
    // Используем Date UTC чтобы избежать проблем с локальным часовым поясом.
    const MS_PER_DAY = 86400000;
    const EXCEL_EPOCH = Date.UTC(1899, 11, 30); // 1899-12-30 в UTC
    const ts = EXCEL_EPOCH + value * MS_PER_DAY;
    const d = new Date(ts);
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth() + 1).padStart(2, "0");
    const day = String(d.getUTCDate()).padStart(2, "0");
    return `${y}-${m}-${day}`;
  }

  // Строка "M/D/YY" или "M/D/YYYY" (американский формат от xlsx)
  if (typeof value === "string") {
    const trimmed = value.trim();
    // YYYY-MM-DD уже нормальный
    if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) return trimmed;
    // M/D/YY или M/D/YYYY
    const m = trimmed.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
    if (m) {
      const month = m[1].padStart(2, "0");
      const day = m[2].padStart(2, "0");
      const year = m[3].length === 2 ? `20${m[3]}` : m[3];
      return `${year}-${month}-${day}`;
    }
  }

  return null;
}

/** Пропускаемые служебные значения ячеек Лист1 */
const SKIP_VALUES = new Set([
  "занятия",
  "зачетная неделя",
  "каникулы",
  "консультация",
  "консультация  дист.",
  "консультация дист.",
  "консультация  ",
  "консультация ",
]);

function isSkipValue(val: string): boolean {
  const low = val.toLowerCase().trim();
  if (SKIP_VALUES.has(low)) return true;
  if (low.startsWith("практика")) return true;
  if (low.startsWith("эксплуатационная практика")) return true;
  if (low.startsWith("технологическая")) return true;
  if (low.startsWith("научно-исследовательская")) return true;
  if (low.startsWith("педагогическая практика")) return true;
  return false;
}

/** Разбивает текст ячейки Лист1 на {room, subject, teacher, notes} */
function parseCellText(raw: string): {
  room: string | null;
  subject: string | null;
  teacher: string | null;
  notes: string | null;
} {
  const text = raw.trim();
  if (!text) return { room: null, subject: null, teacher: null, notes: null };

  // Normalize internal whitespace (keep newlines, collapse spaces)
  const normalized = text.replace(/[ \t]{2,}/g, "  ");

  const roomMatch = ROOM_RE.exec(normalized);
  const room = roomMatch ? roomMatch[1] : null;
  let rest = roomMatch ? normalized.slice(roomMatch[0].length).trim() : normalized;

  // Remove trailing "дист." note and remember it
  const hasDist = /дист\.?/i.test(rest);
  rest = rest.replace(/\s*дист\.?\s*$/i, "").trim();

  // Extract teacher from the end
  let teacherMatch = TEACHER_FULL_RE.exec(rest);
  if (!teacherMatch) teacherMatch = TEACHER_SHORT_RE.exec(rest);

  const teacher = teacherMatch ? teacherMatch[1].trim() : null;
  let subject = teacherMatch ? rest.slice(0, teacherMatch.index).trim() : rest;

  // Clean up subject: collapse whitespace, strip trailing punctuation
  const subjectCleaned = subject.replace(/\s{2,}/g, " ").replace(/[\s,.-]+$/, "").trim();
  const subjectResult: string | null = subjectCleaned || null;

  return {
    room,
    subject: subjectResult,
    teacher,
    notes: hasDist ? "дист." : null,
  };
}

function parseKind(value: string | null): ExamKind {
  if (!value) return "OTHER";
  const v = value.toLowerCase();
  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";
  return "OTHER";
}

function makeItem(
  fields: {
    date: string | null;
    group: string | null;
    subject: string | null;
    kind: ExamKind;
    teacher: string | null;
    room: string | null;
    notes: string | null;
  },
  source: { sheet: string; row: number }
): ScheduleItem {
  const stableKey = [
    source.sheet,
    fields.date ?? "",
    fields.group ?? "",
    fields.subject ?? "",
    fields.kind,
    fields.teacher ?? "",
    fields.room ?? "",
  ].join("|");

  return {
    id: sha1(stableKey),
    date: fields.date,
    time: { start: null, end: null }, // время в файле не указано (все экзамены в 9:00 — примечание в шапке)
    group: fields.group,
    subject: fields.subject,
    kind: fields.kind,
    teacher: fields.teacher,
    location: { room: fields.room, building: null },
    notes: fields.notes,
    source,
  };
}

// ────────────────────────────────────────────────────────────────────────────
// Парсер Лист1 — матрица «дата × группа»
// ────────────────────────────────────────────────────────────────────────────

function parseSheet1(
  ws: xlsx.WorkSheet,
  sheetName: string
): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  // Строка 10 — заголовки (1-based в xlsx)
  const HEADER_ROW = 10;
  const DATA_START_ROW = 12;
  const DATE_COL = 1;       // col A = дата
  const GROUP_COL_START = 3; // col C = первая группа

  // Читаем заголовки групп
  const headerRow = xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
    header: 1,
    range: `A${HEADER_ROW}:T${HEADER_ROW}`,
    defval: null,
    raw: false,
  })[0] ?? [];

  // headerRow[0] = "Группы", headerRow[1] = "День недели", headerRow[2..] = группы
  const groupNames: (string | null)[] = headerRow.slice(GROUP_COL_START - 1).map((v) =>
    v ? String(v).trim() : null
  );

  // Читаем матрицу с raw:false чтобы текстовые ячейки были строками.
  // Даты при этом придут как форматированные строки ("12/23/24") — обработаем их в parseExcelDate.
  const matrix = xlsx.utils.sheet_to_json<(string | number | null)[]>(ws, {
    header: 1,
    range: DATA_START_ROW - 1,
    defval: null,
    raw: false,
  }) as Array<Array<string | number | null>>;

  for (let ri = 0; ri < matrix.length; ri++) {
    const row = matrix[ri];

    // Первая колонка — дата (xlsx без cellDates отдаёт serial number или строку)
    const dateRaw = row[DATE_COL - 1];
    if (!dateRaw) continue;

    const dateStr = parseExcelDate(dateRaw as string | number);

    // Колонки групп (GROUP_COL_START - 1 = 2, 0-based)
    for (let ci = 0; ci < groupNames.length; ci++) {
      const groupName = groupNames[ci];
      const cellVal = row[GROUP_COL_START - 1 + ci];
      if (cellVal === null || cellVal === undefined) continue;
      const cellStr = String(cellVal).trim();
      if (!cellStr) continue;
      if (isSkipValue(cellStr)) continue;

      // Определяем kind по содержимому
      const low = cellStr.toLowerCase();
      let kind: ExamKind;
      let room: string | null = null;
      let subject: string | null = null;
      let teacher: string | null = null;
      let notes: string | null = null;

      if (/консульт/i.test(low)) {
        kind = "CONSULTATION";
        notes = /дист/i.test(low) ? "дист." : null;
      } else {
        // Это экзамен/зачёт — парсим ячейку
        kind = "EXAM"; // по умолчанию; уточним если есть слово "зачёт"
        if (/зач[её]т/i.test(cellStr)) kind = "CREDIT";
        if (/диф/i.test(cellStr)) kind = "DIFF_CREDIT";

        const parsed = parseCellText(cellStr);
        room = parsed.room;
        subject = parsed.subject;
        teacher = parsed.teacher;
        notes = parsed.notes;
      }

      items.push(
        makeItem(
          { date: dateStr, group: groupName, subject, kind, teacher, room, notes },
          { sheet: sheetName, row: DATA_START_ROW + ri }
        )
      );
    }
  }

  return items;
}

// ────────────────────────────────────────────────────────────────────────────
// Парсер Лист2 — плоская таблица ФИО / Дата / Группа / Предмет / Контроль
// ────────────────────────────────────────────────────────────────────────────

function parseSheet2(
  ws: xlsx.WorkSheet,
  sheetName: string
): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const rows = xlsx.utils.sheet_to_json<{
    ФИО?: string;
    Дата?: string | number;
    Группа?: string;
    Предмет?: string;
    Контроль?: string;
  }>(ws, { defval: null, raw: false });

  let lastTeacher: string | null = null;

  for (let ri = 0; ri < rows.length; ri++) {
    const row = rows[ri];

    const rawDate = row["Дата"];
    const dateStr = parseExcelDate(rawDate as string | number | null);

    const fio = row["ФИО"] ? String(row["ФИО"]).trim() : null;
    const group = row["Группа"] ? String(row["Группа"]).trim() : null;
    const subject = row["Предмет"] ? String(row["Предмет"]).trim() : null;
    const kontrolRaw = row["Контроль"] ? String(row["Контроль"]).trim() : null;
    const kind = parseKind(kontrolRaw);

    // Если есть ФИО — запоминаем как текущего преподавателя
    if (fio) lastTeacher = fio;

    // Консультация: нет группы и предмета, только ФИО и дата
    // Экзамен: есть группа и предмет, преподаватель берётся из предыдущей строки-консультации

    const teacher = kind === "CONSULTATION" ? lastTeacher : lastTeacher;

    items.push(
      makeItem(
        { date: dateStr, group, subject, kind, teacher, room: null, notes: null },
        { sheet: sheetName, row: ri + 2 } // +2 потому что строка 1 = заголовок
      )
    );
  }

  return items;
}

// ────────────────────────────────────────────────────────────────────────────
// Главная функция
// ────────────────────────────────────────────────────────────────────────────

export async function parseExcelSchedule(
  filePath: string,
  sourceFileName: string
): Promise<ParsedResult> {
  // НЕ используем cellDates:true — нам нужны числовые serial numbers для parseExcelDate.
  // raw:false нужен чтобы текстовые ячейки (предмет, преподаватель) форматировались как строки.
  const workbook = xlsx.readFile(filePath, { raw: false });

  const allItems: ScheduleItem[] = [];
  const sheetMeta: ParsedResult["memory"]["sheets"] = [];

  for (const sheetName of workbook.SheetNames) {
    const ws = workbook.Sheets[sheetName];

    let items: ScheduleItem[];

    // Определяем формат листа по первой строке
    const firstRow = xlsx.utils.sheet_to_json<string[]>(ws, {
      header: 1,
      range: 0,
      defval: null,
      raw: false,
    })[0] ?? [];

    const firstCellStr = firstRow[0] ? String(firstRow[0]).trim() : "";

    if (/расписание/i.test(firstCellStr) || sheetName === "Лист1") {
      // Матричный формат
      items = parseSheet1(ws, sheetName);
    } else {
      // Плоский формат (Лист2 и подобные)
      items = parseSheet2(ws, sheetName);
    }

    allItems.push(...items);

    sheetMeta.push({
      sheetName,
      rowCount: items.length,
      columns: [], // не используется в нашем специализированном парсере
    });
  }

  // Для совместимости с остальным кодом собираем ParsedResult
  // (sheets: SheetData[] нужен для normalize.ts, но мы его обходим напрямую)
  const result: ParsedResult & { _parsedItems?: ScheduleItem[] } = {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets: [], // оставляем пустым — нормализация происходит прямо здесь
    memory: {
      sheetCount: workbook.SheetNames.length,
      totalRows: allItems.length,
      sheets: sheetMeta,
    },
    _parsedItems: allItems,
  };

  return result;
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024,
    },
  });

  const taskService = options.taskService ?? new TaskService(config);

  // POST /api/tasks — загрузить Excel и создать задачу
  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt,
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // GET /api/tasks/:taskId/status — статус задачи
  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null,
    });
  });

  // GET /api/tasks/:taskId/result — скачать JSON с результатом
  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  // GET /api/tasks/:taskId/memory — краткая сводка по результату
  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      // Теперь result — это ScheduleJsonV1, берём summary как "memory"
      return res.json({
        taskId: task.id,
        memory: {
          items: result.summary.items,
          groups: result.summary.groups,
          dateRange: result.summary.dateRange,
        },
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task result",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // Multer error handler
  router.use(
    (
      error: unknown,
      _req: express.Request,
      res: express.Response,
      next: express.NextFunction
    ) => {
      if (error instanceof multer.MulterError) {
        const details =
          error.code === "LIMIT_FILE_SIZE"
            ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
            : error.message;

        return res.status(400).json({ error: "Upload error", details });
      }

      return next(error);
    }
  );

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";
import { ScheduleJsonV1 } from "./domain";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString(),
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  /**
   * Возвращает итоговый ScheduleJsonV1 из файла на диске.
   * (Раньше здесь был баг: метод обещал вернуть ParsedResult,
   * но на диске лежит ScheduleJsonV1.)
   */
  async getResult(taskId: string): Promise<ScheduleJsonV1> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ScheduleJsonV1;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) continue;

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

  private async processTask(taskId: string): Promise<void> {
    const task = this.tasks.get(taskId);
    if (!task) return;

    task.status = "processing";
    task.startedAt = new Date().toISOString();

    try {
      const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);
      const normalized = normalizeToScheduleV1(parsed, false);

      await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

      task.status = "completed";
      task.finishedAt = new Date().toISOString();
    } catch (error) {
      task.status = "failed";
      task.finishedAt = new Date().toISOString();
      task.error = error instanceof Error ? error.message : "Unknown processing error";
    }
  }
}
</file>

<file path="src/types.ts">
import { ScheduleItem } from "./domain";

export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
  
  _parsedItems?: ScheduleItem[];
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="repomix-output3.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
repomix-output1.xml
repomix-output2.xml
result.json
result1.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="repomix-output1.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
result.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-18T15:43:23.752Z",
    "version": "1.0"
  },
  "summary": {
    "items": 96,
    "groups": [
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2Ф",
      "3ПО",
      "4ПО",
      "4Ф",
      "Friday, December 20, 2024",
      "Friday, December 27, 2024",
      "Friday, February 07, 2025",
      "Friday, February 14, 2025",
      "Friday, January 03, 2025",
      "Friday, January 10, 2025",
      "Friday, January 17, 2025",
      "Friday, January 24, 2025",
      "Friday, January 31, 2025",
      "Monday, December 16, 2024",
      "Monday, December 23, 2024",
      "Monday, December 30, 2024",
      "Monday, February 03, 2025",
      "Monday, February 10, 2025",
      "Monday, February 17, 2025",
      "Monday, January 06, 2025",
      "Monday, January 13, 2025",
      "Monday, January 20, 2025",
      "Monday, January 27, 2025",
      "Saturday, December 21, 2024",
      "Saturday, December 28, 2024",
      "Saturday, February 01, 2025",
      "Saturday, February 08, 2025",
      "Saturday, February 15, 2025",
      "Saturday, January 04, 2025",
      "Saturday, January 11, 2025",
      "Saturday, January 18, 2025",
      "Saturday, January 25, 2025",
      "Sunday, December 22, 2024",
      "Sunday, December 29, 2024",
      "Sunday, February 02, 2025",
      "Sunday, February 09, 2025",
      "Sunday, February 16, 2025",
      "Sunday, January 05, 2025",
      "Sunday, January 12, 2025",
      "Sunday, January 19, 2025",
      "Sunday, January 26, 2025",
      "Thursday, December 19, 2024",
      "Thursday, December 26, 2024",
      "Thursday, February 06, 2025",
      "Thursday, February 13, 2025",
      "Thursday, January 02, 2025",
      "Thursday, January 09, 2025",
      "Thursday, January 16, 2025",
      "Thursday, January 23, 2025",
      "Thursday, January 30, 2025",
      "Tuesday, December 17, 2024",
      "Tuesday, December 24, 2024",
      "Tuesday, December 31, 2024",
      "Tuesday, February 04, 2025",
      "Tuesday, February 11, 2025",
      "Tuesday, February 18, 2025",
      "Tuesday, January 07, 2025",
      "Tuesday, January 14, 2025",
      "Tuesday, January 21, 2025",
      "Tuesday, January 28, 2025",
      "Wednesday, December 18, 2024",
      "Wednesday, December 25, 2024",
      "Wednesday, February 05, 2025",
      "Wednesday, February 12, 2025",
      "Wednesday, January 01, 2025",
      "Wednesday, January 08, 2025",
      "Wednesday, January 15, 2025",
      "Wednesday, January 22, 2025",
      "Wednesday, January 29, 2025",
      "Даты"
    ],
    "itemsByGroup": {
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2Ф": 1,
      "3ПО": 1,
      "4ПО": 2,
      "4Ф": 1,
      "Friday, December 20, 2024": 1,
      "Friday, December 27, 2024": 1,
      "Friday, February 07, 2025": 1,
      "Friday, February 14, 2025": 1,
      "Friday, January 03, 2025": 1,
      "Friday, January 10, 2025": 1,
      "Friday, January 17, 2025": 1,
      "Friday, January 24, 2025": 1,
      "Friday, January 31, 2025": 1,
      "Monday, December 16, 2024": 1,
      "Monday, December 23, 2024": 1,
      "Monday, December 30, 2024": 1,
      "Monday, February 03, 2025": 1,
      "Monday, February 10, 2025": 1,
      "Monday, February 17, 2025": 1,
      "Monday, January 06, 2025": 1,
      "Monday, January 13, 2025": 1,
      "Monday, January 20, 2025": 1,
      "Monday, January 27, 2025": 1,
      "Saturday, December 21, 2024": 1,
      "Saturday, December 28, 2024": 1,
      "Saturday, February 01, 2025": 1,
      "Saturday, February 08, 2025": 1,
      "Saturday, February 15, 2025": 1,
      "Saturday, January 04, 2025": 1,
      "Saturday, January 11, 2025": 1,
      "Saturday, January 18, 2025": 1,
      "Saturday, January 25, 2025": 1,
      "Sunday, December 22, 2024": 1,
      "Sunday, December 29, 2024": 1,
      "Sunday, February 02, 2025": 1,
      "Sunday, February 09, 2025": 1,
      "Sunday, February 16, 2025": 1,
      "Sunday, January 05, 2025": 1,
      "Sunday, January 12, 2025": 1,
      "Sunday, January 19, 2025": 1,
      "Sunday, January 26, 2025": 1,
      "Thursday, December 19, 2024": 1,
      "Thursday, December 26, 2024": 1,
      "Thursday, February 06, 2025": 1,
      "Thursday, February 13, 2025": 1,
      "Thursday, January 02, 2025": 1,
      "Thursday, January 09, 2025": 1,
      "Thursday, January 16, 2025": 1,
      "Thursday, January 23, 2025": 1,
      "Thursday, January 30, 2025": 1,
      "Tuesday, December 17, 2024": 1,
      "Tuesday, December 24, 2024": 1,
      "Tuesday, December 31, 2024": 1,
      "Tuesday, February 04, 2025": 1,
      "Tuesday, February 11, 2025": 1,
      "Tuesday, February 18, 2025": 1,
      "Tuesday, January 07, 2025": 1,
      "Tuesday, January 14, 2025": 1,
      "Tuesday, January 21, 2025": 1,
      "Tuesday, January 28, 2025": 1,
      "Wednesday, December 18, 2024": 1,
      "Wednesday, December 25, 2024": 1,
      "Wednesday, February 05, 2025": 1,
      "Wednesday, February 12, 2025": 1,
      "Wednesday, January 01, 2025": 1,
      "Wednesday, January 08, 2025": 1,
      "Wednesday, January 15, 2025": 1,
      "Wednesday, January 22, 2025": 1,
      "Wednesday, January 29, 2025": 1,
      "Даты": 1
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:53c2d85d754ebbac4242877a5642396b54c36c88",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Даты",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 1
      }
    },
    {
      "id": "sha1:58591cc23b2e83cbf70f8a06819023661889fd9d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 16, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 2
      }
    },
    {
      "id": "sha1:a572aa0addcfab891e676a28ffab43acb125de03",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 17, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 3
      }
    },
    {
      "id": "sha1:725e44f8e57a7733c594d4632c4daf25cb97b3d1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 18, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 4
      }
    },
    {
      "id": "sha1:00c86ca9db5469fcc4ac7427ca178f0cee70062a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 19, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 5
      }
    },
    {
      "id": "sha1:159cdeca04a1bddc6f12195680eaa29be8f7badb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 20, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 6
      }
    },
    {
      "id": "sha1:07574887f3965230d6ef429d3da18ea1a5847b83",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 21, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 7
      }
    },
    {
      "id": "sha1:19101165d73dfde009e2ba890d44ef17220f2791",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 22, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 8
      }
    },
    {
      "id": "sha1:2c9eb4927122454072ccf8a03fdb33147c81a2ea",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 23, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 9
      }
    },
    {
      "id": "sha1:03586517d879b96c3858c730816c5f1473bb17d9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 24, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 10
      }
    },
    {
      "id": "sha1:df858b8beef7ad8d8c20ae8169e27fa2f927ed5b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 25, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 11
      }
    },
    {
      "id": "sha1:95a621a83a19f11a6d4623556ddb9f875e5b55dc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 26, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 12
      }
    },
    {
      "id": "sha1:14781785d7da8cfa3259d90936531c90219bbf04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 27, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 13
      }
    },
    {
      "id": "sha1:a98c1bcad44d5d0f6020168f11fa123e82120add",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 28, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 14
      }
    },
    {
      "id": "sha1:8178a7963c1fd33b76893bc97429db58fad72c69",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 29, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 15
      }
    },
    {
      "id": "sha1:2203bf90e45f4b41c9186fc115c9e440d3c5a642",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 30, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 16
      }
    },
    {
      "id": "sha1:d8f2deb3b45e0d8cfd646e5ed63c0c9cd2cda860",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 31, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 17
      }
    },
    {
      "id": "sha1:793b06d40ef1b2e5aaa1512db6a365936f6caf7d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 18
      }
    },
    {
      "id": "sha1:5e6213091a851e39da55af5377ba6c28f05bf280",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:5d745aa4f54de067504e6bfa67ec9899127ea55c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:77e7b2e3fae0018492edca3c5ef63770c63e2a27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 21
      }
    },
    {
      "id": "sha1:b0732b873decfb5e0bec8ba43262bacecced6208",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 22
      }
    },
    {
      "id": "sha1:f7c3ab1a7055266e12bd2183d747ae1d8157394c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:310de81a471e7b9aaa2bead669de8b24cd192aba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:8b5b7189eca0c4a3c75ec2a46030b289f11a6bc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 25
      }
    },
    {
      "id": "sha1:e41a28edf7a5962397b9a3910a6cecb1cfbe7e74",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 26
      }
    },
    {
      "id": "sha1:32f2050d1e39c37b382b387d1027ec8fcfaae6b7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 27
      }
    },
    {
      "id": "sha1:a201586853531df59fba36d433d3d122093e17c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:3b8700f21449c1a1183debc18097916859c99434",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 29
      }
    },
    {
      "id": "sha1:faa16dc20c67c9fab69f77f1fa8c09df335d03ca",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 30
      }
    },
    {
      "id": "sha1:959a0ef57646fde7116577252aac2ef5bd828525",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 31
      }
    },
    {
      "id": "sha1:c6398c65e6928ae44f7703222372453f141f3563",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:78f64eac6db3ecd78cc025330c71f2bca615827d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 33
      }
    },
    {
      "id": "sha1:e52cae6faacf185be2dbd95357f4eeac56b47528",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 34
      }
    },
    {
      "id": "sha1:44b5dd429cb2c29d5bccd47b1e184d11ce141659",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 35
      }
    },
    {
      "id": "sha1:d682b43fcdc0bf0a78c57dd348acb1781883b7fa",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 19, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:32af7b46588922c0203cf36c8ab58a110e01aedb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 20, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:ec8cc471dfc1cf7ccadf2d98f4cef0f6bdf76e53",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 21, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:f13a1f0585d03ac39ce2f4bab2ad807808f013ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 22, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 39
      }
    },
    {
      "id": "sha1:096c1bc0a8ecbc6ef719f831fb64c6a9733740c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 23, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5fbb17324ecf38b2e2d9a22d8d4fc847f4d86cc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 24, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:810afccf0d495ba4436e4a40cc0393b55772deba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 25, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:b8e5f571ada316af84fe4a88cb88a22fdb5d705b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 26, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:928d865b002ac76f966a690a88fbe48675ae49b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 27, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:0400ac811b8ce1a49c022ed9f2cb85cbe0ff77fd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 28, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:cb2266991020c869229880c2c9320d168d40befe",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 29, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:701148abbb03d36c8d556afb6923033ff6908dee",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 30, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:1eb5220f093edab10b46d94d2a5531acf3228884",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 31, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ba7ab61ef756b54dbc9fb7ca6d1625cdc8ce6648",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 49
      }
    },
    {
      "id": "sha1:d525e963f803d975bfd6444ec98b82a498cbecb3",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:53c522fb4d0b54fa7bf7bca6074c52856fe60723",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:0566dbf86e539c068a86d536d530b2bb4b95aca4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 52
      }
    },
    {
      "id": "sha1:6e6a2e14d4bbd7691f662be08590adb2efd07ec6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 53
      }
    },
    {
      "id": "sha1:7e9cc6df4f203568050407a932b645ffc55a43e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:d97568b498a259b9b146649a9dca7bf7436cc277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 55
      }
    },
    {
      "id": "sha1:ae910617cc1588ebb60599debd4c57c0dc94af92",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 56
      }
    },
    {
      "id": "sha1:7a706bedbb11b95ee96f5910bff153afffbd6277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 57
      }
    },
    {
      "id": "sha1:814e28db2fccce3c142f7051ef79edffc2d48975",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 58
      }
    },
    {
      "id": "sha1:42282d1cba10c6ab97bb2b7077648a82c8c3ba34",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 59
      }
    },
    {
      "id": "sha1:6f2103201631a1bd1d00cab184836d993e8eee6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 60
      }
    },
    {
      "id": "sha1:c5dfd66815bc4a900ba0e6788ed80d64f084665c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 61
      }
    },
    {
      "id": "sha1:0913e8a8ae9ae03ca9e4d24dce949a97ffbb76e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 62
      }
    },
    {
      "id": "sha1:aacd5610ebf43c175e1b19db9d1147265bdf2dc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 63
      }
    },
    {
      "id": "sha1:ef80c2ca75e41e00165857856d0191a399e03abf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 64
      }
    },
    {
      "id": "sha1:8b5819621644a68d99db0a89d816ba9f2b900fe5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 65
      }
    },
    {
      "id": "sha1:209237aab729726a51a3b23b417c525d80330a63",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 66
      }
    },
    {
      "id": "sha1:31e8a08e7c8288fbe8efd4adeec4da1a94881812",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 1
      }
    },
    {
      "id": "sha1:6f5a03516d3f21ee0986d2e80af8fa41ca4fa1c3",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:2d596aeef932b4696acedc60e1e88e9becd25e2f",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:c49c7e3778d3215f9c8bf052aeeafe1d3c6c2790",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:4e6505711749803f7e69e9931662d96a7f585448",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:229889bb8daa0c4ad1ded8d9d36dd36d571ca97f",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:76480b1fa2dc3b71516c47510a6f4f6a32f5315c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:57f2bbc0b647aa341e0f372788ef0e90217878e4",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:e35b89ebab004df08c46b1a9ec456d0e238a61a2",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:3080c6b6a0257090b542345c76e791ad09c819cc",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:a8244ce4cfee6097744b5461b22e7b670bd5e5cb",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:86605960cb0aa62dda5a0b350251fdcaaf3c6084",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:b872dde99d64df47638e9a7be9e441024353af4d",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:9de0a1a6fd494508b6f0b67e58a6d41c20df0ca1",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:f2e062d54ff5e7128c8bae35a5ed4f4bb4f0e017",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:6d9bb493eb76285333aa70bf8c06743c9954d513",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:43992abcbf4f52f5b9d5c641e2f060a9f4b7bc6a",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:91227ab0aefea6d34d09f8ff146bd087c405859b",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:0e6ea3cf45dc35ed460ddd740b20a38985a601a2",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:82ae526e5acef96595c90686283077d9462594cf",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:67a3b12798a5a41e0012007da901dd18f4619cfc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:beff16519df715218fc887448850b254ea313d25",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:b834168f0e64a3319545cd7cf11a21489d0a631a",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:c65865c85e5b7771704739aa166e9ac8767f1ffc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:0a6ced95835e693a0c6f544e19b89b7f33c77edc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:007d5010ac7c0de81abcc11ed953ac91ff2e699b",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:09b22dae31849a4425e85013b3c0625147d4762b",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:deb8687947bb3f3abe8f5a420077fb364da24dbc",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:09b015bbeacbb08e28b7c0ffffe74142802545c2",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:cacbb1a0e5ca2b84f8c79b7afd6f7e5e03d09d28",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  timezone: string;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  // eslint-disable-next-line no-console
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
// src/normalize.ts
import crypto from "node:crypto";
import { ParsedResult } from "./types";
import { ExamKind, ScheduleItem, ScheduleJsonV1, ParseIssue } from "./domain";

const TZ = "Europe/Bucharest";

const COL = {
  date: ["дата", "date", "day"],
  time: ["время", "time", "начало", "start"],
  group: ["группа", "группы", "group"],
  subject: ["предмет", "дисциплина", "subject"],
  kind: ["контроль", "вид_контроля", "форма_контроля", "type"],
  teacher: ["преподаватель", "фио", "teacher"],
  room: ["аудитория", "кабинет", "room"],
  notes: ["примечание", "комментарий", "notes"]
} as const;

function pick(row: Record<string, string | null>, keys: readonly string[]): string | null {
  for (const k of keys) {
    const v = row[k];
    if (typeof v === "string" && v.trim()) return v.trim();
  }
  return null;
}

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function parseKind(value: string | null): ExamKind {
  const v = (value ?? "").toLowerCase();

  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";

  return "OTHER";
}

function normalizeTime(value: string | null): { start: string | null; end: string | null } {
  if (!value) return { start: null, end: null };

  const v = value.replace(/\./g, ":").trim();
  const parts = v.split(/\s*[-–]\s*/);

  const start = parts[0] ? toHHmm(parts[0]) : null;
  const end = parts[1] ? toHHmm(parts[1]) : null;

  return { start, end };
}

function toHHmm(t: string): string | null {
  const m = t.trim().match(/^(\d{1,2})(?::(\d{1,2}))?$/);
  if (!m) return null;

  const hh = Number(m[1]);
  const mm = Number(m[2] ?? "0");

  if (!Number.isFinite(hh) || !Number.isFinite(mm)) return null;
  if (hh < 0 || hh > 23) return null;
  if (mm < 0 || mm > 59) return null;

  return `${String(hh).padStart(2, "0")}:${String(mm).padStart(2, "0")}`;
}

function normalizeDate(value: string | null): string | null {
  if (!value) return null;
  const v = value.trim();

  if (/^\d{4}-\d{2}-\d{2}$/.test(v)) return v;

  // dd.mm.yyyy or dd.mm.yy
  let m = v.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2}|\d{4})$/);
  if (m) {
    const dd = Number(m[1]);
    const mm = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  // mm/dd/yyyy or mm/dd/yy
  m = v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2}|\d{4})$/);
  if (m) {
    const mm = Number(m[1]);
    const dd = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  return null;
}

function isValidDate(y: number, m: number, d: number): boolean {
  if (y < 1900 || y > 2100) return false;
  if (m < 1 || m > 12) return false;
  if (d < 1 || d > 31) return false;

  const dt = new Date(Date.UTC(y, m - 1, d));
  return dt.getUTCFullYear() === y && dt.getUTCMonth() === m - 1 && dt.getUTCDate() === d;
}

function pad2(n: number): string {
  return String(n).padStart(2, "0");
}

export function normalizeToScheduleV1(parsed: ParsedResult, keepRaw: boolean = false): ScheduleJsonV1 {
  const issues: ParseIssue[] = [];
  const items: ScheduleItem[] = [];

  for (const sheet of parsed.sheets) {
    for (let i = 0; i < sheet.rows.length; i += 1) {
      const row = sheet.rows[i];

      const dateRaw = pick(row, COL.date);
      const timeRaw = pick(row, COL.time);
      const group = pick(row, COL.group);
      const subject = pick(row, COL.subject);
      const kindRaw = pick(row, COL.kind);
      const teacher = pick(row, COL.teacher);
      const room = pick(row, COL.room);
      const notes = pick(row, COL.notes);

      const hasSomething = Boolean(dateRaw || timeRaw || group || subject || kindRaw || teacher || room || notes);
      if (!hasSomething) continue;

      const date = normalizeDate(dateRaw);
      if (dateRaw && !date) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать дату: "${dateRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "date" }
        });
      }

      const time = normalizeTime(timeRaw);
      if (timeRaw && !time.start) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать время: "${timeRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "time" }
        });
      }

      const kind = parseKind(kindRaw);

      const stableKey = [
        sheet.sheetName,
        date ?? dateRaw ?? "",
        time.start ?? timeRaw ?? "",
        group ?? "",
        subject ?? "",
        kind,
        teacher ?? "",
        room ?? ""
      ].join("|");

      const item: ScheduleItem = {
        id: sha1(stableKey),
        date,
        time,
        timezone: TZ,
        group,
        subject,
        kind,
        teacher,
        location: { room, building: null },
        notes,
        source: { sheet: sheet.sheetName, row: i + 1 }
      };

      if (keepRaw) item.raw = row;

      items.push(item);
    }
  }

  // summary
  const groups = Array.from(new Set(items.map((x) => x.group).filter(Boolean) as string[])).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) itemsByGroup[it.group] += 1;
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: { sourceFileName: parsed.sourceFileName, parsedAt: parsed.parsedAt, version: "1.0" },
    summary: { items: items.length, groups, itemsByGroup, dateRange: { from, to } },
    items,
    issues
  };
}
</file>

<file path="src/parser.ts">
import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";

export async function parseExcelSchedule(filePath: string, sourceFileName: string): Promise<ParsedResult> {
  const workbook = xlsx.readFile(filePath, { cellDates: true, raw: false });
  const sheets: SheetData[] = [];

  for (const sheetName of workbook.SheetNames) {
    const worksheet = workbook.Sheets[sheetName];
    const matrix = xlsx.utils.sheet_to_json<(string | number | boolean | null)[]>(worksheet, {
      header: 1,
      defval: null,
      raw: false
    });

    const sheet = parseSheet(sheetName, matrix);
    sheets.push(sheet);
  }

  const memorySheets = sheets.map((sheet) => ({
    sheetName: sheet.sheetName,
    rowCount: sheet.rows.length,
    columns: sheet.headers
  }));

  const totalRows = memorySheets.reduce((sum, current) => sum + current.rowCount, 0);

  return {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets,
    memory: {
      sheetCount: sheets.length,
      totalRows,
      sheets: memorySheets
    }
  };
}

function parseSheet(
  sheetName: string,
  matrix: Array<Array<string | number | boolean | null>>
): SheetData {
  if (matrix.length === 0) {
    return {
      sheetName,
      headers: [],
      rows: []
    };
  }

  const headerIndex = findHeaderRowIndex(matrix);
  const headerRow = matrix[headerIndex] ?? [];
  const headers = normalizeHeaders(headerRow);

  const rows: Record<string, string | null>[] = [];

  for (let i = headerIndex + 1; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    if (!rowHasData(row)) {
      continue;
    }

    const mapped: Record<string, string | null> = {};
    for (let col = 0; col < headers.length; col += 1) {
      mapped[headers[col]] = formatCell(row[col]);
    }

    rows.push(mapped);
  }

  return {
    sheetName,
    headers,
    rows
  };
}

function findHeaderRowIndex(matrix: Array<Array<string | number | boolean | null>>): number {
  for (let i = 0; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    const filled = row.filter((cell) => cellHasData(cell));
    if (filled.length >= 2) {
      return i;
    }
  }

  return 0;
}

function normalizeHeaders(row: Array<string | number | boolean | null>): string[] {
  const used = new Set<string>();

  return row.map((cell, index) => {
    const base = sanitizeHeader(formatCell(cell) ?? `column_${index + 1}`) || `column_${index + 1}`;

    let candidate = base;
    let suffix = 2;
    while (used.has(candidate)) {
      candidate = `${base}_${suffix}`;
      suffix += 1;
    }

    used.add(candidate);
    return candidate;
  });
}

function sanitizeHeader(value: string): string {
  return value
    .trim()
    .replace(/\s+/g, "_")
    .replace(/[^\p{L}\p{N}_]/gu, "")
    .toLowerCase();
}

function formatCell(value: string | number | boolean | null | undefined): string | null {
  if (!cellHasData(value)) {
    return null;
  }

  return String(value).trim();
}

function cellHasData(value: string | number | boolean | null | undefined): boolean {
  if (value === null || value === undefined) {
    return false;
  }

  if (typeof value === "string" && value.trim() === "") {
    return false;
  }

  return true;
}

function rowHasData(row: Array<string | number | boolean | null>): boolean {
  return row.some((cell) => cellHasData(cell));
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024
    }
  });

  const taskService = options.taskService ?? new TaskService(config);

  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null
    });
  });

  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      return res.json({
        taskId: task.id,
        memory: result.memory
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task memory",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.use((error: unknown, _req: express.Request, res: express.Response, next: express.NextFunction) => {
    if (error instanceof multer.MulterError) {
      const details =
        error.code === "LIMIT_FILE_SIZE"
          ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
          : error.message;

      return res.status(400).json({
        error: "Upload error",
        details
      });
    }

    return next(error);
  });

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { ParsedResult, TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    
    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString()
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ParsedResult> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ParsedResult;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) {
        continue;
      }

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

// task-service.ts (внутри класса)
private async processTask(taskId: string): Promise<void> {
  const task = this.tasks.get(taskId);
  if (!task) return;

  task.status = "processing";
  task.startedAt = new Date().toISOString();

  try {
    const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);

    // NEW: нормализуем
    const normalized = normalizeToScheduleV1(parsed, false);

    await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

    task.status = "completed";
    task.finishedAt = new Date().toISOString();
  } catch (error) {
    task.status = "failed";
    task.finishedAt = new Date().toISOString();
    task.error = error instanceof Error ? error.message : "Unknown processing error";
  }
}
}
</file>

<file path="src/types.ts">
export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="repomix-output2.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
repomix-output1.xml
result.json
result1.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="repomix-output1.xml">
This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.env.example
.gitignore
package.json
README.md
result.json
session.xlsx
src/config.ts
src/domain.ts
src/index.ts
src/normalize.ts
src/parser.ts
src/router.ts
src/storage.ts
src/task-service.ts
src/types.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".env.example">
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=1
MAX_UPLOAD_MB=30
</file>

<file path=".gitignore">
node_modules/
dist/
storage/
*.log
</file>

<file path="package.json">
{
  "name": "session-parser",
  "version": "1.0.0",
  "private": true,
  "description": "Background Excel session schedule parser for Express (TypeScript)",
  "main": "dist/index.js",
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "express": "^4.21.2",
    "multer": "^1.4.5-lts.2",
    "uuid": "^11.1.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/multer": "^1.4.12",
    "@types/node": "^22.13.4",
    "tsx": "^4.19.3",
    "typescript": "^5.7.3"
  }
}
</file>

<file path="README.md">
# Session Schedule Parser Service

Сервис асинхронного парсинга Excel-расписаний сессии в нормализованный JSON-формат, предназначенный для последующего использования в личном кабинете студента.

Приложение принимает Excel-файл, создаёт задачу обработки, выполняет парсинг в фоне и предоставляет API для получения статуса и результата.

---

## Основные возможности

- Загрузка Excel файлов (`.xlsx` / `.xls`)
- Асинхронная обработка (очередь задач)
- Ограничение параллельных обработчиков
- Нормализация данных в стабильный JSON-контракт
- Обработка «грязных» Excel (разные названия колонок)
- Журнал ошибок парсинга (`issues`)
- Готово для интеграции с внешним сервером

---

## Архитектура

```
Client (личный кабинет)
        │
        ▼
   HTTP API (Express)
        │
        ▼
   Task Queue (в памяти)
        │
        ▼
   Excel Parser (xlsx)
        │
        ▼
 Data Normalizer (ScheduleJsonV1)
        │
        ▼
 JSON Result Storage
```

---

## Технологии

- Node.js
- TypeScript
- Express
- Multer
- XLSX
- UUID

---

## Установка

```bash
git clone <repo>
cd SessionParser
npm install
```

---

## Конфигурация

Настраивается через переменные окружения:

| Переменная | Описание | По умолчанию |
|---|---|---|
| `PORT` | Порт сервера | `3000` |
| `STORAGE_DIR` | Папка хранения | `./storage` |
| `MAX_PARALLEL_TASKS` | Число параллельных задач | `1` |
| `MAX_UPLOAD_MB` | Макс. размер файла (МБ) | `30` |

Пример `.env`:

```env
PORT=3000
STORAGE_DIR=./storage
MAX_PARALLEL_TASKS=2
MAX_UPLOAD_MB=50
```

---

## Запуск

**Development:**

```bash
npx ts-node src/index.ts
```

**Production:**

```bash
npx tsc
node dist/index.js
```

**Проверка:**

```
GET http://localhost:3000/health
→ { "status": "ok" }
```

---

## API

Базовый путь: `/api`

### 1. Создание задачи

**POST** `/api/tasks`

Загружает Excel и создаёт задачу обработки.

**Request:**

```
Content-Type: multipart/form-data
file: <excel>
```

**Пример:**

```bash
curl -X POST http://localhost:3000/api/tasks \
  -F "file=@schedule.xlsx"
```

**Response:**

```json
{
  "taskId": "uuid",
  "status": "queued",
  "createdAt": "2026-02-18T19:40:21.123Z"
}
```

---

### 2. Проверка статуса

**GET** `/api/tasks/{taskId}/status`

**Response:**

```json
{
  "taskId": "uuid",
  "status": "processing",
  "createdAt": "...",
  "startedAt": "...",
  "finishedAt": null,
  "error": null
}
```

**Статусы:**

| Статус | Описание |
|---|---|
| `queued` | Задача в очереди |
| `processing` | Выполняется |
| `completed` | Завершена успешно |
| `failed` | Завершена с ошибкой |

---

### 3. Получение результата

**GET** `/api/tasks/{taskId}/result`

- Если готово → скачивается JSON
- Если не готово → `409`
- Если ошибка → `422`

---

### 4. Краткая сводка

**GET** `/api/tasks/{taskId}/memory`

Возвращает краткую информацию о распарсенных данных.

---

## Формат результата (ScheduleJsonV1)

```json
{
  "meta": {
    "sourceFileName": "schedule.xlsx",
    "parsedAt": "2026-02-18T19:40:21.123Z",
    "version": "1.0"
  },
  "summary": {
    "items": 124,
    "groups": ["ИСТ-21", "ИСТ-22"],
    "itemsByGroup": { "ИСТ-21": 60, "ИСТ-22": 64 },
    "dateRange": { "from": "2026-01-10", "to": "2026-02-05" }
  },
  "items": [
    {
      "id": "sha1:...",
      "date": "2026-01-11",
      "time": { "start": "10:00", "end": null },
      "timezone": "Europe/Bucharest",
      "group": "ИСТ-21",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Иванов И.И.",
      "location": { "room": "304", "building": null },
      "notes": null,
      "source": { "sheet": "Лист2", "row": 12 }
    }
  ],
  "issues": []
}
```

---

## Как используется в личном кабинете

1. Администратор загружает Excel
2. Backend кабинета получает JSON
3. Сохраняет у себя
4. Студент видит только своё расписание:

```js
items.filter(i => i.group === student.group)
```

---

## Коды ошибок

| Код | Причина |
|---|---|
| `400` | Файл не передан / слишком большой |
| `404` | Задача не найдена |
| `409` | Задача ещё обрабатывается |
| `422` | Ошибка обработки Excel |
| `500` | Внутренняя ошибка |

---

## Хранение данных

```
storage/
 ├─ uploads/
 │   ├─ incoming/    (временные файлы)
 │   └─ <taskId>.xlsx
 └─ results/
     └─ <taskId>.json
```

---

## Особенности реализации

- Обработка выполняется асинхронно
- Ограничение числа одновременных задач
- Устойчивость к различным названиям колонок
- Нормализация даты/времени
- Стабильный ID событий (sha1)

---

## Возможные улучшения

- Хранение задач в БД
- Webhook вместо polling
- Авторизация API
- Автоудаление старых файлов

---

## Лицензия

[MIT](LICENSE)
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-18T15:43:23.752Z",
    "version": "1.0"
  },
  "summary": {
    "items": 96,
    "groups": [
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2Ф",
      "3ПО",
      "4ПО",
      "4Ф",
      "Friday, December 20, 2024",
      "Friday, December 27, 2024",
      "Friday, February 07, 2025",
      "Friday, February 14, 2025",
      "Friday, January 03, 2025",
      "Friday, January 10, 2025",
      "Friday, January 17, 2025",
      "Friday, January 24, 2025",
      "Friday, January 31, 2025",
      "Monday, December 16, 2024",
      "Monday, December 23, 2024",
      "Monday, December 30, 2024",
      "Monday, February 03, 2025",
      "Monday, February 10, 2025",
      "Monday, February 17, 2025",
      "Monday, January 06, 2025",
      "Monday, January 13, 2025",
      "Monday, January 20, 2025",
      "Monday, January 27, 2025",
      "Saturday, December 21, 2024",
      "Saturday, December 28, 2024",
      "Saturday, February 01, 2025",
      "Saturday, February 08, 2025",
      "Saturday, February 15, 2025",
      "Saturday, January 04, 2025",
      "Saturday, January 11, 2025",
      "Saturday, January 18, 2025",
      "Saturday, January 25, 2025",
      "Sunday, December 22, 2024",
      "Sunday, December 29, 2024",
      "Sunday, February 02, 2025",
      "Sunday, February 09, 2025",
      "Sunday, February 16, 2025",
      "Sunday, January 05, 2025",
      "Sunday, January 12, 2025",
      "Sunday, January 19, 2025",
      "Sunday, January 26, 2025",
      "Thursday, December 19, 2024",
      "Thursday, December 26, 2024",
      "Thursday, February 06, 2025",
      "Thursday, February 13, 2025",
      "Thursday, January 02, 2025",
      "Thursday, January 09, 2025",
      "Thursday, January 16, 2025",
      "Thursday, January 23, 2025",
      "Thursday, January 30, 2025",
      "Tuesday, December 17, 2024",
      "Tuesday, December 24, 2024",
      "Tuesday, December 31, 2024",
      "Tuesday, February 04, 2025",
      "Tuesday, February 11, 2025",
      "Tuesday, February 18, 2025",
      "Tuesday, January 07, 2025",
      "Tuesday, January 14, 2025",
      "Tuesday, January 21, 2025",
      "Tuesday, January 28, 2025",
      "Wednesday, December 18, 2024",
      "Wednesday, December 25, 2024",
      "Wednesday, February 05, 2025",
      "Wednesday, February 12, 2025",
      "Wednesday, January 01, 2025",
      "Wednesday, January 08, 2025",
      "Wednesday, January 15, 2025",
      "Wednesday, January 22, 2025",
      "Wednesday, January 29, 2025",
      "Даты"
    ],
    "itemsByGroup": {
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2Ф": 1,
      "3ПО": 1,
      "4ПО": 2,
      "4Ф": 1,
      "Friday, December 20, 2024": 1,
      "Friday, December 27, 2024": 1,
      "Friday, February 07, 2025": 1,
      "Friday, February 14, 2025": 1,
      "Friday, January 03, 2025": 1,
      "Friday, January 10, 2025": 1,
      "Friday, January 17, 2025": 1,
      "Friday, January 24, 2025": 1,
      "Friday, January 31, 2025": 1,
      "Monday, December 16, 2024": 1,
      "Monday, December 23, 2024": 1,
      "Monday, December 30, 2024": 1,
      "Monday, February 03, 2025": 1,
      "Monday, February 10, 2025": 1,
      "Monday, February 17, 2025": 1,
      "Monday, January 06, 2025": 1,
      "Monday, January 13, 2025": 1,
      "Monday, January 20, 2025": 1,
      "Monday, January 27, 2025": 1,
      "Saturday, December 21, 2024": 1,
      "Saturday, December 28, 2024": 1,
      "Saturday, February 01, 2025": 1,
      "Saturday, February 08, 2025": 1,
      "Saturday, February 15, 2025": 1,
      "Saturday, January 04, 2025": 1,
      "Saturday, January 11, 2025": 1,
      "Saturday, January 18, 2025": 1,
      "Saturday, January 25, 2025": 1,
      "Sunday, December 22, 2024": 1,
      "Sunday, December 29, 2024": 1,
      "Sunday, February 02, 2025": 1,
      "Sunday, February 09, 2025": 1,
      "Sunday, February 16, 2025": 1,
      "Sunday, January 05, 2025": 1,
      "Sunday, January 12, 2025": 1,
      "Sunday, January 19, 2025": 1,
      "Sunday, January 26, 2025": 1,
      "Thursday, December 19, 2024": 1,
      "Thursday, December 26, 2024": 1,
      "Thursday, February 06, 2025": 1,
      "Thursday, February 13, 2025": 1,
      "Thursday, January 02, 2025": 1,
      "Thursday, January 09, 2025": 1,
      "Thursday, January 16, 2025": 1,
      "Thursday, January 23, 2025": 1,
      "Thursday, January 30, 2025": 1,
      "Tuesday, December 17, 2024": 1,
      "Tuesday, December 24, 2024": 1,
      "Tuesday, December 31, 2024": 1,
      "Tuesday, February 04, 2025": 1,
      "Tuesday, February 11, 2025": 1,
      "Tuesday, February 18, 2025": 1,
      "Tuesday, January 07, 2025": 1,
      "Tuesday, January 14, 2025": 1,
      "Tuesday, January 21, 2025": 1,
      "Tuesday, January 28, 2025": 1,
      "Wednesday, December 18, 2024": 1,
      "Wednesday, December 25, 2024": 1,
      "Wednesday, February 05, 2025": 1,
      "Wednesday, February 12, 2025": 1,
      "Wednesday, January 01, 2025": 1,
      "Wednesday, January 08, 2025": 1,
      "Wednesday, January 15, 2025": 1,
      "Wednesday, January 22, 2025": 1,
      "Wednesday, January 29, 2025": 1,
      "Даты": 1
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:53c2d85d754ebbac4242877a5642396b54c36c88",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Даты",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 1
      }
    },
    {
      "id": "sha1:58591cc23b2e83cbf70f8a06819023661889fd9d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 16, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 2
      }
    },
    {
      "id": "sha1:a572aa0addcfab891e676a28ffab43acb125de03",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 17, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 3
      }
    },
    {
      "id": "sha1:725e44f8e57a7733c594d4632c4daf25cb97b3d1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 18, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 4
      }
    },
    {
      "id": "sha1:00c86ca9db5469fcc4ac7427ca178f0cee70062a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 19, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 5
      }
    },
    {
      "id": "sha1:159cdeca04a1bddc6f12195680eaa29be8f7badb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 20, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 6
      }
    },
    {
      "id": "sha1:07574887f3965230d6ef429d3da18ea1a5847b83",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 21, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 7
      }
    },
    {
      "id": "sha1:19101165d73dfde009e2ba890d44ef17220f2791",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 22, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 8
      }
    },
    {
      "id": "sha1:2c9eb4927122454072ccf8a03fdb33147c81a2ea",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 23, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 9
      }
    },
    {
      "id": "sha1:03586517d879b96c3858c730816c5f1473bb17d9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 24, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 10
      }
    },
    {
      "id": "sha1:df858b8beef7ad8d8c20ae8169e27fa2f927ed5b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, December 25, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 11
      }
    },
    {
      "id": "sha1:95a621a83a19f11a6d4623556ddb9f875e5b55dc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, December 26, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 12
      }
    },
    {
      "id": "sha1:14781785d7da8cfa3259d90936531c90219bbf04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, December 27, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 13
      }
    },
    {
      "id": "sha1:a98c1bcad44d5d0f6020168f11fa123e82120add",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, December 28, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 14
      }
    },
    {
      "id": "sha1:8178a7963c1fd33b76893bc97429db58fad72c69",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, December 29, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 15
      }
    },
    {
      "id": "sha1:2203bf90e45f4b41c9186fc115c9e440d3c5a642",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, December 30, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 16
      }
    },
    {
      "id": "sha1:d8f2deb3b45e0d8cfd646e5ed63c0c9cd2cda860",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, December 31, 2024",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 17
      }
    },
    {
      "id": "sha1:793b06d40ef1b2e5aaa1512db6a365936f6caf7d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 18
      }
    },
    {
      "id": "sha1:5e6213091a851e39da55af5377ba6c28f05bf280",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:5d745aa4f54de067504e6bfa67ec9899127ea55c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:77e7b2e3fae0018492edca3c5ef63770c63e2a27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 21
      }
    },
    {
      "id": "sha1:b0732b873decfb5e0bec8ba43262bacecced6208",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 22
      }
    },
    {
      "id": "sha1:f7c3ab1a7055266e12bd2183d747ae1d8157394c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:310de81a471e7b9aaa2bead669de8b24cd192aba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:8b5b7189eca0c4a3c75ec2a46030b289f11a6bc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 25
      }
    },
    {
      "id": "sha1:e41a28edf7a5962397b9a3910a6cecb1cfbe7e74",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 26
      }
    },
    {
      "id": "sha1:32f2050d1e39c37b382b387d1027ec8fcfaae6b7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 27
      }
    },
    {
      "id": "sha1:a201586853531df59fba36d433d3d122093e17c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:3b8700f21449c1a1183debc18097916859c99434",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 29
      }
    },
    {
      "id": "sha1:faa16dc20c67c9fab69f77f1fa8c09df335d03ca",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 30
      }
    },
    {
      "id": "sha1:959a0ef57646fde7116577252aac2ef5bd828525",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 31
      }
    },
    {
      "id": "sha1:c6398c65e6928ae44f7703222372453f141f3563",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:78f64eac6db3ecd78cc025330c71f2bca615827d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 33
      }
    },
    {
      "id": "sha1:e52cae6faacf185be2dbd95357f4eeac56b47528",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 34
      }
    },
    {
      "id": "sha1:44b5dd429cb2c29d5bccd47b1e184d11ce141659",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 35
      }
    },
    {
      "id": "sha1:d682b43fcdc0bf0a78c57dd348acb1781883b7fa",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 19, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:32af7b46588922c0203cf36c8ab58a110e01aedb",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 20, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:ec8cc471dfc1cf7ccadf2d98f4cef0f6bdf76e53",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 21, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:f13a1f0585d03ac39ce2f4bab2ad807808f013ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 22, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 39
      }
    },
    {
      "id": "sha1:096c1bc0a8ecbc6ef719f831fb64c6a9733740c5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 23, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5fbb17324ecf38b2e2d9a22d8d4fc847f4d86cc",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 24, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:810afccf0d495ba4436e4a40cc0393b55772deba",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, January 25, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:b8e5f571ada316af84fe4a88cb88a22fdb5d705b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, January 26, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:928d865b002ac76f966a690a88fbe48675ae49b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, January 27, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:0400ac811b8ce1a49c022ed9f2cb85cbe0ff77fd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, January 28, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:cb2266991020c869229880c2c9320d168d40befe",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, January 29, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:701148abbb03d36c8d556afb6923033ff6908dee",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, January 30, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:1eb5220f093edab10b46d94d2a5531acf3228884",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, January 31, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ba7ab61ef756b54dbc9fb7ca6d1625cdc8ce6648",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 01, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 49
      }
    },
    {
      "id": "sha1:d525e963f803d975bfd6444ec98b82a498cbecb3",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 02, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:53c522fb4d0b54fa7bf7bca6074c52856fe60723",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 03, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:0566dbf86e539c068a86d536d530b2bb4b95aca4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 04, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 52
      }
    },
    {
      "id": "sha1:6e6a2e14d4bbd7691f662be08590adb2efd07ec6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 05, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 53
      }
    },
    {
      "id": "sha1:7e9cc6df4f203568050407a932b645ffc55a43e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 06, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:d97568b498a259b9b146649a9dca7bf7436cc277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 07, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 55
      }
    },
    {
      "id": "sha1:ae910617cc1588ebb60599debd4c57c0dc94af92",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 08, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 56
      }
    },
    {
      "id": "sha1:7a706bedbb11b95ee96f5910bff153afffbd6277",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 09, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 57
      }
    },
    {
      "id": "sha1:814e28db2fccce3c142f7051ef79edffc2d48975",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 10, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 58
      }
    },
    {
      "id": "sha1:42282d1cba10c6ab97bb2b7077648a82c8c3ba34",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 11, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 59
      }
    },
    {
      "id": "sha1:6f2103201631a1bd1d00cab184836d993e8eee6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Wednesday, February 12, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 60
      }
    },
    {
      "id": "sha1:c5dfd66815bc4a900ba0e6788ed80d64f084665c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Thursday, February 13, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 61
      }
    },
    {
      "id": "sha1:0913e8a8ae9ae03ca9e4d24dce949a97ffbb76e2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Friday, February 14, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 62
      }
    },
    {
      "id": "sha1:aacd5610ebf43c175e1b19db9d1147265bdf2dc5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Saturday, February 15, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 63
      }
    },
    {
      "id": "sha1:ef80c2ca75e41e00165857856d0191a399e03abf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Sunday, February 16, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 64
      }
    },
    {
      "id": "sha1:8b5819621644a68d99db0a89d816ba9f2b900fe5",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Monday, February 17, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 65
      }
    },
    {
      "id": "sha1:209237aab729726a51a3b23b417c525d80330a63",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "Tuesday, February 18, 2025",
      "subject": null,
      "kind": "OTHER",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 66
      }
    },
    {
      "id": "sha1:31e8a08e7c8288fbe8efd4adeec4da1a94881812",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 1
      }
    },
    {
      "id": "sha1:6f5a03516d3f21ee0986d2e80af8fa41ca4fa1c3",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:2d596aeef932b4696acedc60e1e88e9becd25e2f",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:c49c7e3778d3215f9c8bf052aeeafe1d3c6c2790",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:4e6505711749803f7e69e9931662d96a7f585448",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:229889bb8daa0c4ad1ded8d9d36dd36d571ca97f",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:76480b1fa2dc3b71516c47510a6f4f6a32f5315c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:57f2bbc0b647aa341e0f372788ef0e90217878e4",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:e35b89ebab004df08c46b1a9ec456d0e238a61a2",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:3080c6b6a0257090b542345c76e791ad09c819cc",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:a8244ce4cfee6097744b5461b22e7b670bd5e5cb",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:86605960cb0aa62dda5a0b350251fdcaaf3c6084",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:b872dde99d64df47638e9a7be9e441024353af4d",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:9de0a1a6fd494508b6f0b67e58a6d41c20df0ca1",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:f2e062d54ff5e7128c8bae35a5ed4f4bb4f0e017",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:6d9bb493eb76285333aa70bf8c06743c9954d513",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:43992abcbf4f52f5b9d5c641e2f060a9f4b7bc6a",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:91227ab0aefea6d34d09f8ff146bd087c405859b",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:0e6ea3cf45dc35ed460ddd740b20a38985a601a2",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:82ae526e5acef96595c90686283077d9462594cf",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:67a3b12798a5a41e0012007da901dd18f4619cfc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:beff16519df715218fc887448850b254ea313d25",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:b834168f0e64a3319545cd7cf11a21489d0a631a",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:c65865c85e5b7771704739aa166e9ac8767f1ffc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:0a6ced95835e693a0c6f544e19b89b7f33c77edc",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:007d5010ac7c0de81abcc11ed953ac91ff2e699b",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:09b22dae31849a4425e85013b3c0625147d4762b",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:deb8687947bb3f3abe8f5a420077fb364da24dbc",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:09b015bbeacbb08e28b7c0ffffe74142802545c2",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:cacbb1a0e5ca2b84f8c79b7afd6f7e5e03d09d28",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": null,
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  timezone: string;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  // eslint-disable-next-line no-console
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
// src/normalize.ts
import crypto from "node:crypto";
import { ParsedResult } from "./types";
import { ExamKind, ScheduleItem, ScheduleJsonV1, ParseIssue } from "./domain";

const TZ = "Europe/Bucharest";

const COL = {
  date: ["дата", "date", "day"],
  time: ["время", "time", "начало", "start"],
  group: ["группа", "группы", "group"],
  subject: ["предмет", "дисциплина", "subject"],
  kind: ["контроль", "вид_контроля", "форма_контроля", "type"],
  teacher: ["преподаватель", "фио", "teacher"],
  room: ["аудитория", "кабинет", "room"],
  notes: ["примечание", "комментарий", "notes"]
} as const;

function pick(row: Record<string, string | null>, keys: readonly string[]): string | null {
  for (const k of keys) {
    const v = row[k];
    if (typeof v === "string" && v.trim()) return v.trim();
  }
  return null;
}

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function parseKind(value: string | null): ExamKind {
  const v = (value ?? "").toLowerCase();

  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";

  return "OTHER";
}

function normalizeTime(value: string | null): { start: string | null; end: string | null } {
  if (!value) return { start: null, end: null };

  const v = value.replace(/\./g, ":").trim();
  const parts = v.split(/\s*[-–]\s*/);

  const start = parts[0] ? toHHmm(parts[0]) : null;
  const end = parts[1] ? toHHmm(parts[1]) : null;

  return { start, end };
}

function toHHmm(t: string): string | null {
  const m = t.trim().match(/^(\d{1,2})(?::(\d{1,2}))?$/);
  if (!m) return null;

  const hh = Number(m[1]);
  const mm = Number(m[2] ?? "0");

  if (!Number.isFinite(hh) || !Number.isFinite(mm)) return null;
  if (hh < 0 || hh > 23) return null;
  if (mm < 0 || mm > 59) return null;

  return `${String(hh).padStart(2, "0")}:${String(mm).padStart(2, "0")}`;
}

function normalizeDate(value: string | null): string | null {
  if (!value) return null;
  const v = value.trim();

  if (/^\d{4}-\d{2}-\d{2}$/.test(v)) return v;

  // dd.mm.yyyy or dd.mm.yy
  let m = v.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2}|\d{4})$/);
  if (m) {
    const dd = Number(m[1]);
    const mm = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  // mm/dd/yyyy or mm/dd/yy
  m = v.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2}|\d{4})$/);
  if (m) {
    const mm = Number(m[1]);
    const dd = Number(m[2]);
    const yy = Number(m[3].length === 2 ? `20${m[3]}` : m[3]);
    if (isValidDate(yy, mm, dd)) return `${yy}-${pad2(mm)}-${pad2(dd)}`;
  }

  return null;
}

function isValidDate(y: number, m: number, d: number): boolean {
  if (y < 1900 || y > 2100) return false;
  if (m < 1 || m > 12) return false;
  if (d < 1 || d > 31) return false;

  const dt = new Date(Date.UTC(y, m - 1, d));
  return dt.getUTCFullYear() === y && dt.getUTCMonth() === m - 1 && dt.getUTCDate() === d;
}

function pad2(n: number): string {
  return String(n).padStart(2, "0");
}

export function normalizeToScheduleV1(parsed: ParsedResult, keepRaw: boolean = false): ScheduleJsonV1 {
  const issues: ParseIssue[] = [];
  const items: ScheduleItem[] = [];

  for (const sheet of parsed.sheets) {
    for (let i = 0; i < sheet.rows.length; i += 1) {
      const row = sheet.rows[i];

      const dateRaw = pick(row, COL.date);
      const timeRaw = pick(row, COL.time);
      const group = pick(row, COL.group);
      const subject = pick(row, COL.subject);
      const kindRaw = pick(row, COL.kind);
      const teacher = pick(row, COL.teacher);
      const room = pick(row, COL.room);
      const notes = pick(row, COL.notes);

      const hasSomething = Boolean(dateRaw || timeRaw || group || subject || kindRaw || teacher || room || notes);
      if (!hasSomething) continue;

      const date = normalizeDate(dateRaw);
      if (dateRaw && !date) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать дату: "${dateRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "date" }
        });
      }

      const time = normalizeTime(timeRaw);
      if (timeRaw && !time.start) {
        issues.push({
          level: "warning",
          message: `Не удалось распознать время: "${timeRaw}"`,
          source: { sheet: sheet.sheetName, row: i + 1, column: "time" }
        });
      }

      const kind = parseKind(kindRaw);

      const stableKey = [
        sheet.sheetName,
        date ?? dateRaw ?? "",
        time.start ?? timeRaw ?? "",
        group ?? "",
        subject ?? "",
        kind,
        teacher ?? "",
        room ?? ""
      ].join("|");

      const item: ScheduleItem = {
        id: sha1(stableKey),
        date,
        time,
        timezone: TZ,
        group,
        subject,
        kind,
        teacher,
        location: { room, building: null },
        notes,
        source: { sheet: sheet.sheetName, row: i + 1 }
      };

      if (keepRaw) item.raw = row;

      items.push(item);
    }
  }

  // summary
  const groups = Array.from(new Set(items.map((x) => x.group).filter(Boolean) as string[])).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) itemsByGroup[it.group] += 1;
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: { sourceFileName: parsed.sourceFileName, parsedAt: parsed.parsedAt, version: "1.0" },
    summary: { items: items.length, groups, itemsByGroup, dateRange: { from, to } },
    items,
    issues
  };
}
</file>

<file path="src/parser.ts">
import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";

export async function parseExcelSchedule(filePath: string, sourceFileName: string): Promise<ParsedResult> {
  const workbook = xlsx.readFile(filePath, { cellDates: true, raw: false });
  const sheets: SheetData[] = [];

  for (const sheetName of workbook.SheetNames) {
    const worksheet = workbook.Sheets[sheetName];
    const matrix = xlsx.utils.sheet_to_json<(string | number | boolean | null)[]>(worksheet, {
      header: 1,
      defval: null,
      raw: false
    });

    const sheet = parseSheet(sheetName, matrix);
    sheets.push(sheet);
  }

  const memorySheets = sheets.map((sheet) => ({
    sheetName: sheet.sheetName,
    rowCount: sheet.rows.length,
    columns: sheet.headers
  }));

  const totalRows = memorySheets.reduce((sum, current) => sum + current.rowCount, 0);

  return {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets,
    memory: {
      sheetCount: sheets.length,
      totalRows,
      sheets: memorySheets
    }
  };
}

function parseSheet(
  sheetName: string,
  matrix: Array<Array<string | number | boolean | null>>
): SheetData {
  if (matrix.length === 0) {
    return {
      sheetName,
      headers: [],
      rows: []
    };
  }

  const headerIndex = findHeaderRowIndex(matrix);
  const headerRow = matrix[headerIndex] ?? [];
  const headers = normalizeHeaders(headerRow);

  const rows: Record<string, string | null>[] = [];

  for (let i = headerIndex + 1; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    if (!rowHasData(row)) {
      continue;
    }

    const mapped: Record<string, string | null> = {};
    for (let col = 0; col < headers.length; col += 1) {
      mapped[headers[col]] = formatCell(row[col]);
    }

    rows.push(mapped);
  }

  return {
    sheetName,
    headers,
    rows
  };
}

function findHeaderRowIndex(matrix: Array<Array<string | number | boolean | null>>): number {
  for (let i = 0; i < matrix.length; i += 1) {
    const row = matrix[i] ?? [];
    const filled = row.filter((cell) => cellHasData(cell));
    if (filled.length >= 2) {
      return i;
    }
  }

  return 0;
}

function normalizeHeaders(row: Array<string | number | boolean | null>): string[] {
  const used = new Set<string>();

  return row.map((cell, index) => {
    const base = sanitizeHeader(formatCell(cell) ?? `column_${index + 1}`) || `column_${index + 1}`;

    let candidate = base;
    let suffix = 2;
    while (used.has(candidate)) {
      candidate = `${base}_${suffix}`;
      suffix += 1;
    }

    used.add(candidate);
    return candidate;
  });
}

function sanitizeHeader(value: string): string {
  return value
    .trim()
    .replace(/\s+/g, "_")
    .replace(/[^\p{L}\p{N}_]/gu, "")
    .toLowerCase();
}

function formatCell(value: string | number | boolean | null | undefined): string | null {
  if (!cellHasData(value)) {
    return null;
  }

  return String(value).trim();
}

function cellHasData(value: string | number | boolean | null | undefined): boolean {
  if (value === null || value === undefined) {
    return false;
  }

  if (typeof value === "string" && value.trim() === "") {
    return false;
  }

  return true;
}

function rowHasData(row: Array<string | number | boolean | null>): boolean {
  return row.some((cell) => cellHasData(cell));
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024
    }
  });

  const taskService = options.taskService ?? new TaskService(config);

  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null
    });
  });

  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error"
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      return res.json({
        taskId: task.id,
        memory: result.memory
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task memory",
        details: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });

  router.use((error: unknown, _req: express.Request, res: express.Response, next: express.NextFunction) => {
    if (error instanceof multer.MulterError) {
      const details =
        error.code === "LIMIT_FILE_SIZE"
          ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
          : error.message;

      return res.status(400).json({
        error: "Upload error",
        details
      });
    }

    return next(error);
  });

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { ParsedResult, TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    
    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString()
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ParsedResult> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ParsedResult;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) {
        continue;
      }

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

// task-service.ts (внутри класса)
private async processTask(taskId: string): Promise<void> {
  const task = this.tasks.get(taskId);
  if (!task) return;

  task.status = "processing";
  task.startedAt = new Date().toISOString();

  try {
    const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);

    // NEW: нормализуем
    const normalized = normalizeToScheduleV1(parsed, false);

    await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

    task.status = "completed";
    task.finishedAt = new Date().toISOString();
  } catch (error) {
    task.status = "failed";
    task.finishedAt = new Date().toISOString();
    task.error = error instanceof Error ? error.message : "Unknown processing error";
  }
}
}
</file>

<file path="src/types.ts">
export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T11:27:45.087Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:a79f1da953375c892bbec38505332ab4ddc8aa91",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:882bb25e3b97e95b092ce0389f10dd5cc315bd30",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:836342c5bf177b19c9ed6e777006269a1bee4023",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:75a091035a6ef4ecfec7cfca104654f4732a84fc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:e7df833ab0c6b9f69f2602e2bf9d7274b6dbee8b",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:e52ab2b7879087c20325364b7328c1ae2d6a8f62",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:9ff503afbc84c63b5b2f9d4b40b8af8557b2234c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:b5f0ceef2149cf88e3f34be46080221d905e3ebf",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:9feb96976e9a2dc3a50a15285a6db0650db71f59",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:0c5e92cff9298849d4e0daac84dab1f02f50afba",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:fca41f1c8aedf12782e31b766da03a5cf569e49d",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:19e8eb3d40adbb74d7cad023b0d32c0afe289ebf",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:adac790f019474d3f7716c322cd824d1197e6aac",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:70ef068ab43fb27d3a463f00570a654f20b195dc",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:5fe17a74b6ccbde805d7a6f394387ecab79e4a9d",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:5751182188967801fed8cb070286457259bdb586",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:96e2e90d227621b4c4cdcfbf40d557e623635c79",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:31a97cb569a33f507186ba35aa93966f3f51c027",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:9b63749c2413ae7f6379d8b9bf1852354da9b89a",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:63d25370db1f35e83f99cb139b5e588f83c3f7e2",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:81a7eb86eeee70808071b8585d5f9589571dffca",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:d1b9d610e6ebeb6f88563d28ce423821c130d735",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:13f3cb5571629c035bda34c9b0afa074ee42da96",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:54792b7f03dbe8dfc6f30d23c92f2939b7c20c97",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:a92042ded2f06b552f2ebac3c06ea78c41139058",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:c05709a1c1c40b968b9e2c2f76517f427c0e41be",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:1ccff255f2b775cb5babc0e44ca6e445634200fa",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:1494d4ee9f53ddfdc15e88c55dadd213f6ebdd0d",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:21ec9e19d8beae2c4ab68d20d45f92f8ae7bd428",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:57f77bb1126b06b0b4503e2dc75c98a7aa75f77e",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="result1.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T10:55:38.534Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "1/10/21",
      "to": "12/29/20"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:f2688ce77cb95d03c03b0ba21746b97c41d0cb54",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:077d23d8749c23ed0fdedacc624ce47b1ee495d8",
      "date": "1/12/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:b1a2897d707e6e89aa7ff8f01f705ecbd5a520d0",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:086c3fd57b898c1b3ce2a0f1aad9d95439149fcb",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:21fa369690ea4ecc4584284b0fbebbc462e2d9a3",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:a68602e9bfdd8618612ab9f0847e603780b02c73",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:b06871c3b09a41a60c93e09c562be44d918162ad",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:d576e45d172261173b033bb1a982d825bd1e33c5",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:ecb166cd7c9a9e49e8d04c6b1c240c85074203e3",
      "date": "1/9/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:296dfc75b6a3a15f446bc311cf89177ff2e1f804",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:45cfe83d13007440844863edb31c989fdf124434",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:a2eead52f206bab6330425392b608c8f53a35630",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:aea62c3a5cb7396659030adf3075723b8c266611",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:90e6a470c3f8962a3fa615d9e2acb69615cdcbd8",
      "date": "1/25/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:b81ea0e113ddb88d42bdf01311472f02d876b71a",
      "date": "12/28/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:2fc81c1850ade2d3ebed834cca2075eec094ae0d",
      "date": "12/29/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:f1d733dad039d08269b4a41915435c598ee42b6f",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:5d35ffababa1cd9db724cac257cc32e6f683c230",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:8de0c4f5440c691d46337a8cee911b4f34a98725",
      "date": "1/21/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:73bfe39944e406674d1fcb19168b702ff849b7b8",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:3e6462337b180f228d3dcbae766651dce159220e",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:4ae1187507929a0fa346aff676fa3c1ec59685aa",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:fad2aece649efaaa0f92920b9ba7d1e538aaae98",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:2e295aafce1c3c8092641c11b813ee3f91b30e0e",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:079fa2220a3b2cbad9f9ddd93d9432eb26ba3e5f",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:05c5a1de645466bacfa9f2e8bfb227f0154935c2",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:533127a8afb20c861b5b2b6996b7d87b052ab1ea",
      "date": "1/15/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:5656d05976f75301dbe16b1f75e2682ba84bd801",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:bb907df7f2cc6441cbd3d16f4093d41b660aa3de",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:cbaa0ccb2ed62a6aa556f2d885278f2ea5996016",
      "date": "1/18/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string; // stable hash
  date: string | null; // "YYYY-MM-DD"
  time: TimeRange;
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
import { ParsedResult } from "./types";
import { ScheduleItem, ScheduleJsonV1 } from "./domain";

export function normalizeToScheduleV1(
  parsed: ParsedResult & { _parsedItems?: ScheduleItem[] },
  _keepRaw: boolean = false
): ScheduleJsonV1 {
  const items: ScheduleItem[] = parsed._parsedItems ?? [];

  // Summary
  const groupSet = new Set<string>();
  for (const it of items) {
    if (it.group) groupSet.add(it.group);
  }
  const groups = Array.from(groupSet).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) {
      itemsByGroup[it.group] += 1;
    }
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: {
      sourceFileName: parsed.sourceFileName,
      parsedAt: parsed.parsedAt,
      version: "1.0",
    },
    summary: {
      items: items.length,
      groups,
      itemsByGroup,
      dateRange: { from, to },
    },
    items,
    issues: [],
  };
}
</file>

<file path="src/parser.ts">
/**
 * parser.ts
 *
 * Парсер Excel-файла расписания сессии физического факультета.
 *
 * Поддерживает два формата листов:
 *
 * ЛИСТ1 — матрица «дата × группа»
 *   Строка 10: заголовки колонок — первые 2 служебные («Группы», «День недели»),
 *              дальше названия групп.
 *   Строка 11: «Даты» (пропускаем)
 *   Строки 12+: col1 = дата, col2 = дата (дубль), col3..N = текст ячейки для группы.
 *   Ячейка может содержать: "404  Предмет  Преподаватель И.О." (всё в одной строке/ячейке).
 *
 * ЛИСТ2 — плоская таблица
 *   Строка 1: заголовки: ФИО | Дата | Группа | Предмет | Контроль
 *   Строки 2+: данные.  ФИО преподавателя может быть только в строке-«консультации»,
 *              а следующая строка — экзамен того же преподавателя.
 */

import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";
import { ScheduleItem, ExamKind } from "./domain";
import crypto from "node:crypto";

// ────────────────────────────────────────────────────────────────────────────
// Helpers
// ────────────────────────────────────────────────────────────────────────────


// Ячейка Лист1: "404\nПредмет\nПреподаватель И.О." или "404  Предмет  Преп И.О."
// Извлекает аудиторию (2-3 цифры + буква/слэш), предмет, преподавателя.
const ROOM_RE = /^([\d]{2,3}[а-яА-ЯёЁa-zA-Z]?(?:\/[\d]+)?)\s*[\n\s]+/;

// Фамилия И.О. — полные инициалы: "Коржаков В.Е."
const TEACHER_FULL_RE =
  /([А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.(?:,\s*[А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.)*)\s*(?:дист\.?)?\s*$/;

// Фамилия И. — только одна буква (краткая запись): "Теплоухов С."
const TEACHER_SHORT_RE = /([А-ЯЁ][а-яё]+\s+[А-ЯЁ]\.)\s*(?:дист\.?)?\s*$/;

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

function formatDate(d: Date): string {
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}-${m}-${day}`;
}

/**
 * Конвертирует Excel serial number в "YYYY-MM-DD".
 * xlsx без cellDates возвращает даты как числа (например, 45642 = 2024-12-23).
 * Также обрабатывает строки формата "M/D/YY" которые xlsx иногда отдаёт.
 */
function parseExcelDate(value: string | number | null | undefined): string | null {
  if (value === null || value === undefined || value === "") return null;

  // Числовой Excel serial (например 45642)
  if (typeof value === "number") {
    // xlsx.SSF.parse_date_code не учитывает баг Excel с 1900 как високосным годом.
    // Надёжнее считать вручную: Excel serial = дни с 1899-12-31 (epoch = день 1).
    // Прибавляем serial - 1 дней к 1899-12-31, что эквивалентно serial дням к 1899-12-30.
    // Используем Date UTC чтобы избежать проблем с локальным часовым поясом.
    const MS_PER_DAY = 86400000;
    const EXCEL_EPOCH = Date.UTC(1899, 11, 30); // 1899-12-30 в UTC
    const ts = EXCEL_EPOCH + value * MS_PER_DAY;
    const d = new Date(ts);
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth() + 1).padStart(2, "0");
    const day = String(d.getUTCDate()).padStart(2, "0");
    return `${y}-${m}-${day}`;
  }

  // Строка "M/D/YY" или "M/D/YYYY" (американский формат от xlsx)
  if (typeof value === "string") {
    const trimmed = value.trim();
    // YYYY-MM-DD уже нормальный
    if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) return trimmed;
    // M/D/YY или M/D/YYYY
    const m = trimmed.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
    if (m) {
      const month = m[1].padStart(2, "0");
      const day = m[2].padStart(2, "0");
      const year = m[3].length === 2 ? `20${m[3]}` : m[3];
      return `${year}-${month}-${day}`;
    }
  }

  return null;
}

/** Пропускаемые служебные значения ячеек Лист1 */
const SKIP_VALUES = new Set([
  "занятия",
  "зачетная неделя",
  "каникулы",
  "консультация",
  "консультация  дист.",
  "консультация дист.",
  "консультация  ",
  "консультация ",
]);

function isSkipValue(val: string): boolean {
  const low = val.toLowerCase().trim();
  if (SKIP_VALUES.has(low)) return true;
  if (low.startsWith("практика")) return true;
  if (low.startsWith("эксплуатационная практика")) return true;
  if (low.startsWith("технологическая")) return true;
  if (low.startsWith("научно-исследовательская")) return true;
  if (low.startsWith("педагогическая практика")) return true;
  return false;
}

/** Разбивает текст ячейки Лист1 на {room, subject, teacher, notes} */
function parseCellText(raw: string): {
  room: string | null;
  subject: string | null;
  teacher: string | null;
  notes: string | null;
} {
  const text = raw.trim();
  if (!text) return { room: null, subject: null, teacher: null, notes: null };

  // Normalize internal whitespace (keep newlines, collapse spaces)
  const normalized = text.replace(/[ \t]{2,}/g, "  ");

  const roomMatch = ROOM_RE.exec(normalized);
  const room = roomMatch ? roomMatch[1] : null;
  let rest = roomMatch ? normalized.slice(roomMatch[0].length).trim() : normalized;

  // Remove trailing "дист." note and remember it
  const hasDist = /дист\.?/i.test(rest);
  rest = rest.replace(/\s*дист\.?\s*$/i, "").trim();

  // Extract teacher from the end
  let teacherMatch = TEACHER_FULL_RE.exec(rest);
  if (!teacherMatch) teacherMatch = TEACHER_SHORT_RE.exec(rest);

  const teacher = teacherMatch ? teacherMatch[1].trim() : null;
  let subject = teacherMatch ? rest.slice(0, teacherMatch.index).trim() : rest;

  // Clean up subject: collapse whitespace, strip trailing punctuation
  const subjectCleaned = subject.replace(/\s{2,}/g, " ").replace(/[\s,.-]+$/, "").trim();
  const subjectResult: string | null = subjectCleaned || null;

  return {
    room,
    subject: subjectResult,
    teacher,
    notes: hasDist ? "дист." : null,
  };
}

function parseKind(value: string | null): ExamKind {
  if (!value) return "OTHER";
  const v = value.toLowerCase();
  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";
  return "OTHER";
}

function makeItem(
  fields: {
    date: string | null;
    group: string | null;
    subject: string | null;
    kind: ExamKind;
    teacher: string | null;
    room: string | null;
    notes: string | null;
  },
  source: { sheet: string; row: number }
): ScheduleItem {
  const stableKey = [
    source.sheet,
    fields.date ?? "",
    fields.group ?? "",
    fields.subject ?? "",
    fields.kind,
    fields.teacher ?? "",
    fields.room ?? "",
  ].join("|");

  return {
    id: sha1(stableKey),
    date: fields.date,
    time: { start: null, end: null }, // время в файле не указано (все экзамены в 9:00 — примечание в шапке)
    group: fields.group,
    subject: fields.subject,
    kind: fields.kind,
    teacher: fields.teacher,
    location: { room: fields.room, building: null },
    notes: fields.notes,
    source,
  };
}

// ────────────────────────────────────────────────────────────────────────────
// Парсер Лист1 — матрица «дата × группа»
// ────────────────────────────────────────────────────────────────────────────

function parseSheet1(
  ws: xlsx.WorkSheet,
  sheetName: string
): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  // Строка 10 — заголовки (1-based в xlsx)
  const HEADER_ROW = 10;
  const DATA_START_ROW = 12;
  const DATE_COL = 1;       // col A = дата
  const GROUP_COL_START = 3; // col C = первая группа

  // Читаем заголовки групп
  const headerRow = xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
    header: 1,
    range: `A${HEADER_ROW}:T${HEADER_ROW}`,
    defval: null,
    raw: false,
  })[0] ?? [];

  // headerRow[0] = "Группы", headerRow[1] = "День недели", headerRow[2..] = группы
  const groupNames: (string | null)[] = headerRow.slice(GROUP_COL_START - 1).map((v) =>
    v ? String(v).trim() : null
  );

  // Читаем матрицу с raw:false чтобы текстовые ячейки были строками.
  // Даты при этом придут как форматированные строки ("12/23/24") — обработаем их в parseExcelDate.
  const matrix = xlsx.utils.sheet_to_json<(string | number | null)[]>(ws, {
    header: 1,
    range: DATA_START_ROW - 1,
    defval: null,
    raw: false,
  }) as Array<Array<string | number | null>>;

  for (let ri = 0; ri < matrix.length; ri++) {
    const row = matrix[ri];

    // Первая колонка — дата (xlsx без cellDates отдаёт serial number или строку)
    const dateRaw = row[DATE_COL - 1];
    if (!dateRaw) continue;

    const dateStr = parseExcelDate(dateRaw as string | number);

    // Колонки групп (GROUP_COL_START - 1 = 2, 0-based)
    for (let ci = 0; ci < groupNames.length; ci++) {
      const groupName = groupNames[ci];
      const cellVal = row[GROUP_COL_START - 1 + ci];
      if (cellVal === null || cellVal === undefined) continue;
      const cellStr = String(cellVal).trim();
      if (!cellStr) continue;
      if (isSkipValue(cellStr)) continue;

      // Определяем kind по содержимому
      const low = cellStr.toLowerCase();
      let kind: ExamKind;
      let room: string | null = null;
      let subject: string | null = null;
      let teacher: string | null = null;
      let notes: string | null = null;

      if (/консульт/i.test(low)) {
        kind = "CONSULTATION";
        notes = /дист/i.test(low) ? "дист." : null;
      } else {
        // Это экзамен/зачёт — парсим ячейку
        kind = "EXAM"; // по умолчанию; уточним если есть слово "зачёт"
        if (/зач[её]т/i.test(cellStr)) kind = "CREDIT";
        if (/диф/i.test(cellStr)) kind = "DIFF_CREDIT";

        const parsed = parseCellText(cellStr);
        room = parsed.room;
        subject = parsed.subject;
        teacher = parsed.teacher;
        notes = parsed.notes;
      }

      items.push(
        makeItem(
          { date: dateStr, group: groupName, subject, kind, teacher, room, notes },
          { sheet: sheetName, row: DATA_START_ROW + ri }
        )
      );
    }
  }

  return items;
}

// ────────────────────────────────────────────────────────────────────────────
// Парсер Лист2 — плоская таблица ФИО / Дата / Группа / Предмет / Контроль
// ────────────────────────────────────────────────────────────────────────────

function parseSheet2(
  ws: xlsx.WorkSheet,
  sheetName: string
): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const rows = xlsx.utils.sheet_to_json<{
    ФИО?: string;
    Дата?: string | number;
    Группа?: string;
    Предмет?: string;
    Контроль?: string;
  }>(ws, { defval: null, raw: false });

  let lastTeacher: string | null = null;

  for (let ri = 0; ri < rows.length; ri++) {
    const row = rows[ri];

    const rawDate = row["Дата"];
    const dateStr = parseExcelDate(rawDate as string | number | null);

    const fio = row["ФИО"] ? String(row["ФИО"]).trim() : null;
    const group = row["Группа"] ? String(row["Группа"]).trim() : null;
    const subject = row["Предмет"] ? String(row["Предмет"]).trim() : null;
    const kontrolRaw = row["Контроль"] ? String(row["Контроль"]).trim() : null;
    const kind = parseKind(kontrolRaw);

    // Если есть ФИО — запоминаем как текущего преподавателя
    if (fio) lastTeacher = fio;

    // Консультация: нет группы и предмета, только ФИО и дата
    // Экзамен: есть группа и предмет, преподаватель берётся из предыдущей строки-консультации

    const teacher = kind === "CONSULTATION" ? lastTeacher : lastTeacher;

    items.push(
      makeItem(
        { date: dateStr, group, subject, kind, teacher, room: null, notes: null },
        { sheet: sheetName, row: ri + 2 } // +2 потому что строка 1 = заголовок
      )
    );
  }

  return items;
}

// ────────────────────────────────────────────────────────────────────────────
// Главная функция
// ────────────────────────────────────────────────────────────────────────────

export async function parseExcelSchedule(
  filePath: string,
  sourceFileName: string
): Promise<ParsedResult> {
  // НЕ используем cellDates:true — нам нужны числовые serial numbers для parseExcelDate.
  // raw:false нужен чтобы текстовые ячейки (предмет, преподаватель) форматировались как строки.
  const workbook = xlsx.readFile(filePath, { raw: false });

  const allItems: ScheduleItem[] = [];
  const sheetMeta: ParsedResult["memory"]["sheets"] = [];

  for (const sheetName of workbook.SheetNames) {
    const ws = workbook.Sheets[sheetName];

    let items: ScheduleItem[];

    // Определяем формат листа по первой строке
    const firstRow = xlsx.utils.sheet_to_json<string[]>(ws, {
      header: 1,
      range: 0,
      defval: null,
      raw: false,
    })[0] ?? [];

    const firstCellStr = firstRow[0] ? String(firstRow[0]).trim() : "";

    if (/расписание/i.test(firstCellStr) || sheetName === "Лист1") {
      // Матричный формат
      items = parseSheet1(ws, sheetName);
    } else {
      // Плоский формат (Лист2 и подобные)
      items = parseSheet2(ws, sheetName);
    }

    allItems.push(...items);

    sheetMeta.push({
      sheetName,
      rowCount: items.length,
      columns: [], // не используется в нашем специализированном парсере
    });
  }

  // Для совместимости с остальным кодом собираем ParsedResult
  // (sheets: SheetData[] нужен для normalize.ts, но мы его обходим напрямую)
  const result: ParsedResult & { _parsedItems?: ScheduleItem[] } = {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets: [], // оставляем пустым — нормализация происходит прямо здесь
    memory: {
      sheetCount: workbook.SheetNames.length,
      totalRows: allItems.length,
      sheets: sheetMeta,
    },
    _parsedItems: allItems,
  };

  return result;
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024,
    },
  });

  const taskService = options.taskService ?? new TaskService(config);

  // POST /api/tasks — загрузить Excel и создать задачу
  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt,
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // GET /api/tasks/:taskId/status — статус задачи
  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null,
    });
  });

  // GET /api/tasks/:taskId/result — скачать JSON с результатом
  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  // GET /api/tasks/:taskId/memory — краткая сводка по результату
  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      // Теперь result — это ScheduleJsonV1, берём summary как "memory"
      return res.json({
        taskId: task.id,
        memory: {
          items: result.summary.items,
          groups: result.summary.groups,
          dateRange: result.summary.dateRange,
        },
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task result",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // Multer error handler
  router.use(
    (
      error: unknown,
      _req: express.Request,
      res: express.Response,
      next: express.NextFunction
    ) => {
      if (error instanceof multer.MulterError) {
        const details =
          error.code === "LIMIT_FILE_SIZE"
            ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
            : error.message;

        return res.status(400).json({ error: "Upload error", details });
      }

      return next(error);
    }
  );

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";
import { ScheduleJsonV1 } from "./domain";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString(),
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  /**
   * Возвращает итоговый ScheduleJsonV1 из файла на диске.
   * (Раньше здесь был баг: метод обещал вернуть ParsedResult,
   * но на диске лежит ScheduleJsonV1.)
   */
  async getResult(taskId: string): Promise<ScheduleJsonV1> {
    const task = this.tasks.get(taskId);
    if (!task) {
      throw new Error("TASK_NOT_FOUND");
    }

    if (task.status !== "completed") {
      throw new Error("TASK_NOT_COMPLETED");
    }

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ScheduleJsonV1;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) continue;

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

  private async processTask(taskId: string): Promise<void> {
    const task = this.tasks.get(taskId);
    if (!task) return;

    task.status = "processing";
    task.startedAt = new Date().toISOString();

    try {
      const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);
      const normalized = normalizeToScheduleV1(parsed, false);

      await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

      task.status = "completed";
      task.finishedAt = new Date().toISOString();
    } catch (error) {
      task.status = "failed";
      task.finishedAt = new Date().toISOString();
      task.error = error instanceof Error ? error.message : "Unknown processing error";
    }
  }
}
</file>

<file path="src/types.ts">
import { ScheduleItem } from "./domain";

export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
  
  _parsedItems?: ScheduleItem[];
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T11:37:28.772Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2021-01-25"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:a79f1da953375c892bbec38505332ab4ddc8aa91",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:882bb25e3b97e95b092ce0389f10dd5cc315bd30",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:836342c5bf177b19c9ed6e777006269a1bee4023",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:75a091035a6ef4ecfec7cfca104654f4732a84fc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:e7df833ab0c6b9f69f2602e2bf9d7274b6dbee8b",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:e52ab2b7879087c20325364b7328c1ae2d6a8f62",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:9ff503afbc84c63b5b2f9d4b40b8af8557b2234c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:b5f0ceef2149cf88e3f34be46080221d905e3ebf",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:9feb96976e9a2dc3a50a15285a6db0650db71f59",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:0c5e92cff9298849d4e0daac84dab1f02f50afba",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:fca41f1c8aedf12782e31b766da03a5cf569e49d",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:19e8eb3d40adbb74d7cad023b0d32c0afe289ebf",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:adac790f019474d3f7716c322cd824d1197e6aac",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:70ef068ab43fb27d3a463f00570a654f20b195dc",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:5fe17a74b6ccbde805d7a6f394387ecab79e4a9d",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:5751182188967801fed8cb070286457259bdb586",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:96e2e90d227621b4c4cdcfbf40d557e623635c79",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:31a97cb569a33f507186ba35aa93966f3f51c027",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:9b63749c2413ae7f6379d8b9bf1852354da9b89a",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:63d25370db1f35e83f99cb139b5e588f83c3f7e2",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:81a7eb86eeee70808071b8585d5f9589571dffca",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:d1b9d610e6ebeb6f88563d28ce423821c130d735",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:13f3cb5571629c035bda34c9b0afa074ee42da96",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:54792b7f03dbe8dfc6f30d23c92f2939b7c20c97",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:a92042ded2f06b552f2ebac3c06ea78c41139058",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:c05709a1c1c40b968b9e2c2f76517f427c0e41be",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:1ccff255f2b775cb5babc0e44ca6e445634200fa",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:1494d4ee9f53ddfdc15e88c55dadd213f6ebdd0d",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:21ec9e19d8beae2c4ab68d20d45f92f8ae7bd428",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:57f77bb1126b06b0b4503e2dc75c98a7aa75f77e",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="result1.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T10:55:38.534Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "1/10/21",
      "to": "12/29/20"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:f2688ce77cb95d03c03b0ba21746b97c41d0cb54",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:077d23d8749c23ed0fdedacc624ce47b1ee495d8",
      "date": "1/12/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:b1a2897d707e6e89aa7ff8f01f705ecbd5a520d0",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:086c3fd57b898c1b3ce2a0f1aad9d95439149fcb",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:21fa369690ea4ecc4584284b0fbebbc462e2d9a3",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:a68602e9bfdd8618612ab9f0847e603780b02c73",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:b06871c3b09a41a60c93e09c562be44d918162ad",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:d576e45d172261173b033bb1a982d825bd1e33c5",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:ecb166cd7c9a9e49e8d04c6b1c240c85074203e3",
      "date": "1/9/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:296dfc75b6a3a15f446bc311cf89177ff2e1f804",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:45cfe83d13007440844863edb31c989fdf124434",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:a2eead52f206bab6330425392b608c8f53a35630",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:aea62c3a5cb7396659030adf3075723b8c266611",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:90e6a470c3f8962a3fa615d9e2acb69615cdcbd8",
      "date": "1/25/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:b81ea0e113ddb88d42bdf01311472f02d876b71a",
      "date": "12/28/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:2fc81c1850ade2d3ebed834cca2075eec094ae0d",
      "date": "12/29/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:f1d733dad039d08269b4a41915435c598ee42b6f",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:5d35ffababa1cd9db724cac257cc32e6f683c230",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:8de0c4f5440c691d46337a8cee911b4f34a98725",
      "date": "1/21/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:73bfe39944e406674d1fcb19168b702ff849b7b8",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:3e6462337b180f228d3dcbae766651dce159220e",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:4ae1187507929a0fa346aff676fa3c1ec59685aa",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:fad2aece649efaaa0f92920b9ba7d1e538aaae98",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:2e295aafce1c3c8092641c11b813ee3f91b30e0e",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:079fa2220a3b2cbad9f9ddd93d9432eb26ba3e5f",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:05c5a1de645466bacfa9f2e8bfb227f0154935c2",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:533127a8afb20c861b5b2b6996b7d87b052ab1ea",
      "date": "1/15/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:5656d05976f75301dbe16b1f75e2682ba84bd801",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:bb907df7f2cc6441cbd3d16f4093d41b660aa3de",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:cbaa0ccb2ed62a6aa556f2d885278f2ea5996016",
      "date": "1/18/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string;
  date: string | null;        // "YYYY-MM-DD"
  time: TimeRange;
  // timezone убран — в Excel указана только дата без времени,
  // часовой пояс определяется на стороне потребителя
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
import { ParsedResult } from "./types";
import { ScheduleItem, ScheduleJsonV1 } from "./domain";

export function normalizeToScheduleV1(
  parsed: ParsedResult & { _parsedItems?: ScheduleItem[] },
  _keepRaw: boolean = false
): ScheduleJsonV1 {
  const items: ScheduleItem[] = parsed._parsedItems ?? [];

  // Summary
  const groupSet = new Set<string>();
  for (const it of items) {
    if (it.group) groupSet.add(it.group);
  }
  const groups = Array.from(groupSet).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) {
      itemsByGroup[it.group] += 1;
    }
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: {
      sourceFileName: parsed.sourceFileName,
      parsedAt: parsed.parsedAt,
      version: "1.0",
    },
    summary: {
      items: items.length,
      groups,
      itemsByGroup,
      dateRange: { from, to },
    },
    items,
    issues: [],
  };
}
</file>

<file path="src/parser.ts">
/**
 * parser.ts
 *
 * Парсер Excel-файла расписания сессии физического факультета.
 *
 * ЛИСТ1 — матрица «дата × группа»
 *   Строка 10: заголовки — первые 2 служебные, дальше названия групп.
 *   Строки 12+: col1 = дата, col3..N = текст ячейки для группы.
 *   Ячейка: "404  Предмет  Преподаватель И.О."
 *
 * ЛИСТ2 — плоская таблица
 *   Строка 1: ФИО | Дата | Группа | Предмет | Контроль
 */

import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";
import { ScheduleItem, ExamKind } from "./domain";
import crypto from "node:crypto";

// ─────────────────────────────────────────────────────────────────────────────
// Helpers
// ─────────────────────────────────────────────────────────────────────────────

const ROOM_RE = /^([\d]{2,3}[а-яА-ЯёЁa-zA-Z]?(?:\/[\d]+)?)\s*[\n\s]+/;

const TEACHER_FULL_RE =
  /([А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.(?:,\s*[А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.)*)\s*(?:дист\.?)?\s*$/;

const TEACHER_SHORT_RE = /([А-ЯЁ][а-яё]+\s+[А-ЯЁ]\.)\s*(?:дист\.?)?\s*$/;

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

/**
 * Конвертирует значение ячейки даты в "YYYY-MM-DD".
 * readFile({ raw: false }) форматирует даты как строку "M/D/YY" или "M/D/YYYY".
 * Также обрабатывает числовой Excel serial на случай других настроек.
 */
function parseExcelDate(value: string | number | null | undefined): string | null {
  if (value === null || value === undefined || value === "") return null;

  if (typeof value === "number") {
    const MS_PER_DAY = 86400000;
    const EXCEL_EPOCH = Date.UTC(1899, 11, 30); // 1899-12-30 UTC
    const ts = EXCEL_EPOCH + value * MS_PER_DAY;
    const d = new Date(ts);
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth() + 1).padStart(2, "0");
    const day = String(d.getUTCDate()).padStart(2, "0");
    return `${y}-${m}-${day}`;
  }

  if (typeof value === "string") {
    const trimmed = value.trim();
    // Уже YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) return trimmed;
    // M/D/YY или M/D/YYYY (американский формат от xlsx SSF)
    const m = trimmed.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
    if (m) {
      const month = m[1].padStart(2, "0");
      const day = m[2].padStart(2, "0");
      const year = m[3].length === 2 ? `20${m[3]}` : m[3];
      return `${year}-${month}-${day}`;
    }
  }

  return null;
}

const SKIP_VALUES = new Set(["занятия", "зачетная неделя", "каникулы"]);

function isSkipValue(val: string): boolean {
  const low = val.toLowerCase().trim();
  if (SKIP_VALUES.has(low)) return true;
  if (/^консультация/.test(low)) return true;
  if (low.startsWith("практика")) return true;
  if (low.startsWith("эксплуатационная")) return true;
  if (low.startsWith("технологическая")) return true;
  if (low.startsWith("научно-исследовательская")) return true;
  if (low.startsWith("педагогическая")) return true;
  return false;
}

function parseCellText(raw: string): {
  room: string | null;
  subject: string | null;
  teacher: string | null;
  notes: string | null;
} {
  const text = raw.trim();
  if (!text) return { room: null, subject: null, teacher: null, notes: null };

  const normalized = text.replace(/[ \t]{2,}/g, "  ");

  const roomMatch = ROOM_RE.exec(normalized);
  const room = roomMatch ? roomMatch[1] : null;
  let rest = roomMatch ? normalized.slice(roomMatch[0].length).trim() : normalized;

  const hasDist = /дист\.?/i.test(rest);
  rest = rest.replace(/\s*дист\.?\s*$/i, "").trim();

  let teacherMatch = TEACHER_FULL_RE.exec(rest);
  if (!teacherMatch) teacherMatch = TEACHER_SHORT_RE.exec(rest);

  const teacher = teacherMatch ? teacherMatch[1].trim() : null;
  const subjectRaw = teacherMatch ? rest.slice(0, teacherMatch.index).trim() : rest;
  const subject = subjectRaw.replace(/\s{2,}/g, " ").replace(/[\s,.-]+$/, "").trim() || null;

  return { room, subject, teacher, notes: hasDist ? "дист." : null };
}

function parseKind(value: string | null): ExamKind {
  if (!value) return "OTHER";
  const v = value.toLowerCase();
  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";
  return "OTHER";
}

function makeItem(
  fields: {
    date: string | null;
    group: string | null;
    subject: string | null;
    kind: ExamKind;
    teacher: string | null;
    room: string | null;
    notes: string | null;
  },
  source: { sheet: string; row: number }
): ScheduleItem {
  const stableKey = [
    source.sheet,
    fields.date ?? "",
    fields.group ?? "",
    fields.subject ?? "",
    fields.kind,
    fields.teacher ?? "",
    fields.room ?? "",
  ].join("|");

  return {
    id: sha1(stableKey),
    date: fields.date,
    time: { start: null, end: null },
    group: fields.group,
    subject: fields.subject,
    kind: fields.kind,
    teacher: fields.teacher,
    location: { room: fields.room, building: null },
    notes: fields.notes,
    source,
  };
}

// ─────────────────────────────────────────────────────────────────────────────
// Парсер Лист1 — матрица «дата × группа»
// ─────────────────────────────────────────────────────────────────────────────

function parseSheet1(ws: xlsx.WorkSheet, sheetName: string): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const HEADER_ROW = 10;
  const DATA_START_ROW = 12;
  const DATE_COL = 1;
  const GROUP_COL_START = 3;

  const headerRow =
    (xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
      header: 1,
      range: `A${HEADER_ROW}:T${HEADER_ROW}`,
      defval: null,
      raw: false,
    })[0] as (string | null)[]) ?? [];

  const groupNames: (string | null)[] = headerRow
    .slice(GROUP_COL_START - 1)
    .map((v) => (v ? String(v).trim() : null));

  const matrix = xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
    header: 1,
    range: DATA_START_ROW - 1,
    defval: null,
    raw: false,
  }) as Array<Array<string | null>>;

  for (let ri = 0; ri < matrix.length; ri++) {
    const row = matrix[ri];

    const dateRaw = row[DATE_COL - 1];
    if (!dateRaw) continue;

    const dateStr = parseExcelDate(dateRaw);

    for (let ci = 0; ci < groupNames.length; ci++) {
      const groupName = groupNames[ci];
      const cellVal = row[GROUP_COL_START - 1 + ci];
      if (!cellVal) continue;

      const cellStr = String(cellVal).trim();
      if (!cellStr || isSkipValue(cellStr)) continue;

      const low = cellStr.toLowerCase();
      let kind: ExamKind;
      let room: string | null = null;
      let subject: string | null = null;
      let teacher: string | null = null;
      let notes: string | null = null;

      if (/консульт/i.test(low)) {
        kind = "CONSULTATION";
        notes = /дист/i.test(low) ? "дист." : null;
      } else {
        kind = "EXAM";
        if (/зач[её]т/i.test(cellStr)) kind = "CREDIT";
        if (/диф/i.test(cellStr)) kind = "DIFF_CREDIT";

        const parsed = parseCellText(cellStr);
        room = parsed.room;
        subject = parsed.subject;
        teacher = parsed.teacher;
        notes = parsed.notes;
      }

      items.push(
        makeItem(
          { date: dateStr, group: groupName, subject, kind, teacher, room, notes },
          { sheet: sheetName, row: DATA_START_ROW + ri }
        )
      );
    }
  }

  return items;
}

// ─────────────────────────────────────────────────────────────────────────────
// Парсер Лист2 — плоская таблица ФИО / Дата / Группа / Предмет / Контроль
// ─────────────────────────────────────────────────────────────────────────────

function parseSheet2(ws: xlsx.WorkSheet, sheetName: string): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const rows = xlsx.utils.sheet_to_json<{
    ФИО?: string | null;
    Дата?: string | null;
    Группа?: string | null;
    Предмет?: string | null;
    Контроль?: string | null;
  }>(ws, { defval: null, raw: false });

  let lastTeacher: string | null = null;

  for (let ri = 0; ri < rows.length; ri++) {
    const row = rows[ri];

    const dateStr = parseExcelDate(row["Дата"]);
    const fio = row["ФИО"] ? String(row["ФИО"]).trim() : null;
    const group = row["Группа"] ? String(row["Группа"]).trim() : null;
    const subject = row["Предмет"] ? String(row["Предмет"]).trim() : null;
    const kind = parseKind(row["Контроль"] ? String(row["Контроль"]).trim() : null);

    if (fio) lastTeacher = fio;

    items.push(
      makeItem(
        { date: dateStr, group, subject, kind, teacher: lastTeacher, room: null, notes: null },
        { sheet: sheetName, row: ri + 2 }
      )
    );
  }

  return items;
}

// ─────────────────────────────────────────────────────────────────────────────
// Главная функция
// ─────────────────────────────────────────────────────────────────────────────

export async function parseExcelSchedule(
  filePath: string,
  sourceFileName: string
): Promise<ParsedResult> {
  // raw:false — текст как строки, даты как "M/D/YY".
  // НЕ используем cellDates:true — он конвертирует даты в Date-объекты
  // и ломает parseExcelDate, которая ожидает строку или число.
  const workbook = xlsx.readFile(filePath, { raw: false });

  const allItems: ScheduleItem[] = [];
  const sheetMeta: ParsedResult["memory"]["sheets"] = [];

  for (const sheetName of workbook.SheetNames) {
    const ws = workbook.Sheets[sheetName];

    const firstRow = (xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
      header: 1,
      range: 0,
      defval: null,
      raw: false,
    })[0] as (string | null)[]) ?? [];

    const firstCell = firstRow[0] ? String(firstRow[0]).trim() : "";
    const isMatrix = /расписание/i.test(firstCell) || sheetName === "Лист1";

    const items = isMatrix ? parseSheet1(ws, sheetName) : parseSheet2(ws, sheetName);

    allItems.push(...items);
    sheetMeta.push({ sheetName, rowCount: items.length, columns: [] });
  }

  const result: ParsedResult & { _parsedItems?: ScheduleItem[] } = {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets: [],
    memory: {
      sheetCount: workbook.SheetNames.length,
      totalRows: allItems.length,
      sheets: sheetMeta,
    },
    _parsedItems: allItems,
  };

  return result;
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024,
    },
  });

  const taskService = options.taskService ?? new TaskService(config);

  // POST /api/tasks — загрузить Excel и создать задачу
  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt,
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // GET /api/tasks/:taskId/status — статус задачи
  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null,
    });
  });

  // GET /api/tasks/:taskId/result — скачать JSON с результатом
  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  // GET /api/tasks/:taskId/memory — краткая сводка по результату
  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      // Теперь result — это ScheduleJsonV1, берём summary как "memory"
      return res.json({
        taskId: task.id,
        memory: {
          items: result.summary.items,
          groups: result.summary.groups,
          dateRange: result.summary.dateRange,
        },
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task result",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // Multer error handler
  router.use(
    (
      error: unknown,
      _req: express.Request,
      res: express.Response,
      next: express.NextFunction
    ) => {
      if (error instanceof multer.MulterError) {
        const details =
          error.code === "LIMIT_FILE_SIZE"
            ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
            : error.message;

        return res.status(400).json({ error: "Upload error", details });
      }

      return next(error);
    }
  );

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";
import { ScheduleJsonV1 } from "./domain";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString(),
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ScheduleJsonV1> {
    const task = this.tasks.get(taskId);
    if (!task) throw new Error("TASK_NOT_FOUND");
    if (task.status !== "completed") throw new Error("TASK_NOT_COMPLETED");

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ScheduleJsonV1;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) continue;

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

  private async processTask(taskId: string): Promise<void> {
    const task = this.tasks.get(taskId);
    if (!task) return;

    task.status = "processing";
    task.startedAt = new Date().toISOString();

    try {
      const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);
      const normalized = normalizeToScheduleV1(parsed, false);

      await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

      task.status = "completed";
      task.finishedAt = new Date().toISOString();
    } catch (error) {
      task.status = "failed";
      task.finishedAt = new Date().toISOString();
      task.error = error instanceof Error ? error.message : "Unknown processing error";
    }
  }
}
</file>

<file path="src/types.ts">
import { ScheduleItem } from "./domain";

export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
  
  _parsedItems?: ScheduleItem[];
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
</file>

<file path="result.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T11:46:06.773Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "2020-12-28",
      "to": "2025-01-27"
    }
  },
  "items": [
    {
      "id": "sha1:921a5516687b9ab64e2fff30168cfb13a8627d51",
      "date": "2024-12-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:1c628ced6b50e6cfde30d1bb06845aff21d7e5d0",
      "date": "2024-12-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:ed1be3df00f23e36994b74df6db6328c77a2b5f6",
      "date": "2024-12-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:d02b1fc55575b0eabdc0ec0adda4f0ee7fdce0b8",
      "date": "2024-12-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:c1759ad04cf2b3160d9d591ea163f9d11cb90fd5",
      "date": "2024-12-27",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:75ddc840660553d4485075cdb15cd1ccd4ffbc5c",
      "date": "2024-12-27",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c0113390199a2fd09c2ce79e0ec903feaf0838ff",
      "date": "2024-12-27",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:bd5aabd6fd94e89673563e0527ab1390d6609f92",
      "date": "2024-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:a266eebb840c68dc68c6dda5567743ed841e7989",
      "date": "2025-01-01",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:3809db067f544c48d76422e568b9d23a6b38ef39",
      "date": "2025-01-05",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:89d72539f8fd4822678a3513bc7b5da80ad8c34c",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:1bfe2c2337b8e9762f199adea830a60fa1a262b3",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a967fae93d8e244c10f7e2ee55d52ce0f44bf691",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:2cdb8ff4336eeecf87eccb7b86643693ee1808b1",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:d3cf15924e79ec1ce991f686c07b8f5eb36a8728",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:8e80ef101ae973659549ff45c696bf7d40032754",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4d16c3a596d9e783faa5b1e86582b7e1bc985603",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fa1e5d892ed041a550b0bc01076d6dc0d817718a",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:ff7276f9714bce8d7f0afc27ecbde466fd770647",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a2849919ecb672e2ccd561d34e8c7e443ce4e8ba",
      "date": "2025-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:abc1076ba2b46993942fa1a3952d42cde393945b",
      "date": "2025-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:3e665093bdc5cb6a9120a424098422e73b1457c5",
      "date": "2025-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:53c1a2265ecf9e8bfed5c84701d60cc37087a5f6",
      "date": "2025-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:1d490e9c3a940b340709922ef81322b6bf0f289f",
      "date": "2025-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:e4fe12b3b9c88aeade33c94f10752fc2247a9a90",
      "date": "2025-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:b03b561732870ae0a08b5c3c1c7d1d9170846b85",
      "date": "2025-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:9833684a60c926f013353575706d98341b8f57f0",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:ebf7e3e40978f96c74d230eb4f9df00f728ac643",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:8f94f28fa67ebd7ad879592d9f507a556143526e",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9b369c68d1d72beed897d9bf768e587146d3abba",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:43e98c4f09daeffc28c88c0a023fbca6d5c1d0d9",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5f709f90cd4a646400a89f0f7414a7602aa4152",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:22704216c45c56705a4010da74ac833d894905a6",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:daf279828230cfa1f6eb4d9dfe47ab196749659f",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:922029fd4deaefa77fca3d0bf2e2d3c5dc43c7d1",
      "date": "2025-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:7a9aa22f094907df2d9e50c81d41226791b64b65",
      "date": "2025-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:c00aef3887e50aa8c40ae8c66126aafd83cc3691",
      "date": "2025-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:041a938e588f420b35d6994f24b148d6436a335c",
      "date": "2025-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:fa1710e7a7fce15d87e7a636d9055112cf498187",
      "date": "2025-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f47622fc0b454e57d94c2604775767f4eef1ca2b",
      "date": "2025-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:0c583f991f001f294449cf9e1dbdd89a37c8824f",
      "date": "2025-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:94bc20d85b59b4b017d95f54c91f42054b004761",
      "date": "2025-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:8c8c981fc9234a8717ecdfd535ee6f78469b3d1f",
      "date": "2025-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:e086ba613ef0c8a5001b92352d5d3db0097e9a63",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:3b6935e4ecfffa63e4dafcfc7b373ec2a16e0773",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ca5a4b16bef1a63efe05bba023c50667e78d9591",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:0cf278e280d66df6d955fa8979e4246975fe070b",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:6f340e50b012300441b8e79643cd5bb115d253ce",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:56f671bd67d8915175e51bf8e3400c8710a5813c",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86df2a5d7656ca6f68ee7626a005c064675adc27",
      "date": "2025-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:3061b4a3ed6771c0b33e8ce83197ec0f11eef40c",
      "date": "2025-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:b3679117bd0d9c30eeef233eda63414af1e5053e",
      "date": "2025-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:f0b9d6c4893fe077e120bd70256733d30fc51bba",
      "date": "2025-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:017b331b378d98d34d3a40457ea2a49ab9ceadeb",
      "date": "2025-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:343cf72582d225010aed3cb12e67107207c00036",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:780d581584e7d3a879811ab908e30885bdda9010",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ac294ea69b7a193be7cd786c4fb010a647ef50d2",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:0eba2f44ebbe18744abf47a233a195a1944ebd84",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:747fc2aceebb286239493cfc2c17f60077357e0d",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:308e1d971f2e1dbb644ed29f724a2551d6ca40b6",
      "date": "2025-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6657269e0ce96de36b783242cbc104c2cb4b8e9d",
      "date": "2025-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:0a4b162cce6d89cf5ce83522631a107252d957fe",
      "date": "2025-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:2cdb8c0170e68d8f5ce02058b012f703eb00f4f4",
      "date": "2025-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:e4a75b41926ba9dae45ca5fdeb7f11813a0b89b1",
      "date": "2025-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:b2a509500b1eeb06fda173bca7dbce654317b487",
      "date": "2025-01-27",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:a79f1da953375c892bbec38505332ab4ddc8aa91",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:882bb25e3b97e95b092ce0389f10dd5cc315bd30",
      "date": "2021-01-12",
      "time": {
        "start": null,
        "end": null
      },
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:836342c5bf177b19c9ed6e777006269a1bee4023",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:75a091035a6ef4ecfec7cfca104654f4732a84fc",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:e7df833ab0c6b9f69f2602e2bf9d7274b6dbee8b",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:e52ab2b7879087c20325364b7328c1ae2d6a8f62",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:9ff503afbc84c63b5b2f9d4b40b8af8557b2234c",
      "date": "2021-01-23",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:b5f0ceef2149cf88e3f34be46080221d905e3ebf",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:9feb96976e9a2dc3a50a15285a6db0650db71f59",
      "date": "2021-01-09",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:0c5e92cff9298849d4e0daac84dab1f02f50afba",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:fca41f1c8aedf12782e31b766da03a5cf569e49d",
      "date": "2021-01-10",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:19e8eb3d40adbb74d7cad023b0d32c0afe289ebf",
      "date": "2021-01-11",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:adac790f019474d3f7716c322cd824d1197e6aac",
      "date": "2021-01-24",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:70ef068ab43fb27d3a463f00570a654f20b195dc",
      "date": "2021-01-25",
      "time": {
        "start": null,
        "end": null
      },
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:5fe17a74b6ccbde805d7a6f394387ecab79e4a9d",
      "date": "2020-12-28",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:5751182188967801fed8cb070286457259bdb586",
      "date": "2020-12-29",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:96e2e90d227621b4c4cdcfbf40d557e623635c79",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:31a97cb569a33f507186ba35aa93966f3f51c027",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:9b63749c2413ae7f6379d8b9bf1852354da9b89a",
      "date": "2021-01-21",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:63d25370db1f35e83f99cb139b5e588f83c3f7e2",
      "date": "2021-01-22",
      "time": {
        "start": null,
        "end": null
      },
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:81a7eb86eeee70808071b8585d5f9589571dffca",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:d1b9d610e6ebeb6f88563d28ce423821c130d735",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:13f3cb5571629c035bda34c9b0afa074ee42da96",
      "date": "2021-01-19",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:54792b7f03dbe8dfc6f30d23c92f2939b7c20c97",
      "date": "2021-01-20",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:a92042ded2f06b552f2ebac3c06ea78c41139058",
      "date": "2021-01-13",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:c05709a1c1c40b968b9e2c2f76517f427c0e41be",
      "date": "2021-01-14",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:1ccff255f2b775cb5babc0e44ca6e445634200fa",
      "date": "2021-01-15",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:1494d4ee9f53ddfdc15e88c55dadd213f6ebdd0d",
      "date": "2021-01-16",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:21ec9e19d8beae2c4ab68d20d45f92f8ae7bd428",
      "date": "2021-01-17",
      "time": {
        "start": null,
        "end": null
      },
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:57f77bb1126b06b0b4503e2dc75c98a7aa75f77e",
      "date": "2021-01-18",
      "time": {
        "start": null,
        "end": null
      },
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="result1.json">
{
  "meta": {
    "sourceFileName": "session.xlsx",
    "parsedAt": "2026-02-23T10:55:38.534Z",
    "version": "1.0"
  },
  "summary": {
    "items": 95,
    "groups": [
      "1 Ф",
      "1ИВТ1",
      "1ИВТ2",
      "1ИВТ2, 1УТС",
      "1ИВТ_АСОИУ",
      "1ИВТ_ТИИ",
      "1ПО_магистр",
      "1УТС, 2Ф",
      "1Ф, 1УТС",
      "2ИВТ_АСОИУ",
      "2ИВТ_ТИИ",
      "2ПО_магистр",
      "2Ф",
      "3 УТС",
      "3ИВТ1",
      "3ИВТ2",
      "3ПО",
      "3Ф",
      "4 УТС",
      "4ИВТ(УзГУМЯ)",
      "4ИВТ1",
      "4ИВТ2",
      "4ПО",
      "4Ф"
    ],
    "itemsByGroup": {
      "1 Ф": 2,
      "1ИВТ1": 4,
      "1ИВТ2": 3,
      "1ИВТ2, 1УТС": 1,
      "1ИВТ_АСОИУ": 2,
      "1ИВТ_ТИИ": 1,
      "1ПО_магистр": 2,
      "1УТС, 2Ф": 1,
      "1Ф, 1УТС": 1,
      "2ИВТ_АСОИУ": 5,
      "2ИВТ_ТИИ": 1,
      "2ПО_магистр": 4,
      "2Ф": 6,
      "3 УТС": 4,
      "3ИВТ1": 4,
      "3ИВТ2": 9,
      "3ПО": 1,
      "3Ф": 4,
      "4 УТС": 4,
      "4ИВТ(УзГУМЯ)": 4,
      "4ИВТ1": 5,
      "4ИВТ2": 5,
      "4ПО": 2,
      "4Ф": 5
    },
    "dateRange": {
      "from": "1/10/21",
      "to": "12/29/20"
    }
  },
  "items": [
    {
      "id": "sha1:279a0f687eb83678d2a9946e736ce36dfbd29bdd",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Методика обучения физики",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:b02477afeb7066d474217c0677698ae4d7ca4cc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "МиМСУ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:371765a2aee195b147e06ac4d7c986ff3076097b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 19
      }
    },
    {
      "id": "sha1:12c6d4e33b758197209b3af3720fb5dd066bda78",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 20
      }
    },
    {
      "id": "sha1:9cacd250c1f32d8cea4f95fdbedf30da552fb121",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Компьютерные методы физики",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:767cf378aa911ae97b617eca44b9963ab730a7de",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Информационные сети и ТК",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:c7cdf3f9fa46b3e4a0b148a461c8faaed9db91f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 23
      }
    },
    {
      "id": "sha1:f2c7516f4cd5e911ee2f31dbb36a1763aa6cfd04",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "ПОАСНИ",
      "kind": "EXAM",
      "teacher": "Теплоухов С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 24
      }
    },
    {
      "id": "sha1:d2240733003f70a22f524711a43b36a9ac3bcf86",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 28
      }
    },
    {
      "id": "sha1:8ccbda2f6e5fe42d3a202a2ba7607c535c82ca87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программирования",
      "kind": "EXAM",
      "teacher": "Овчаров И.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 32
      }
    },
    {
      "id": "sha1:e12d60fa00facb2988d4a3b59b62baa301bb326a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Астрономия и физика космоса",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bceaaa480e700f72972dfc9a361ac8cb8ef4b935",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика обучения информатике в современной школе",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:bfc83c64977f7ab8cf180ae7e14a1722f9cad474",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:289cd258eabdaf325160191888601de549387d23",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Программирование",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4ed29c5a5d7f409837c7a688d6c2be5091c51a08",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:4e69f5ef7012735d996ecaade0081a0ee73c584e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Матем.анализ",
      "kind": "EXAM",
      "teacher": "Беликова Т.Г.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:c8d704d2139cebbfeb084d506c4dddffc42a6d06",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Ин. яз",
      "kind": "EXAM",
      "teacher": "Симбулетова Р.К., Копылова Ю.В.",
      "location": {
        "room": "143/404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:e8d31ae008ac6ec7bc7c846572eab1629e5b68ce",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:fe494b3fbdb2731ae2f1f216fa4fa7b99d6e2cf6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Проектирование АСУ",
      "kind": "EXAM",
      "teacher": "Коржаков В.Е.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:a7bebff4c680b045e4d7af81475da643d33e5e4a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Системы ИИ",
      "kind": "EXAM",
      "teacher": "Коробков В.Н.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 36
      }
    },
    {
      "id": "sha1:0cc22f30cce6614cb5a8b0885e8e4d728195d4ae",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Теор.механика. Механика сплош.сред",
      "kind": "EXAM",
      "teacher": "Шекоян Л.А.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:90efa90e01fb032bf07686385dfdff05d62f4112",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Квантовая теория",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:a418a84bf06bc02df8840a337f0e7e226651e166",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Электротехн. и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:132454a7b0c1fd90d31d9bf83bbb3ffe3086b5be",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 37
      }
    },
    {
      "id": "sha1:03adad0b2f7714408932e2b12bfc844f7e7bb040",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "ТСАУ",
      "kind": "EXAM",
      "teacher": "Джемилев А.С.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:632bc45cfb582aae7c30bb1c62e193c89413acac",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Надежность, эргономика и кач",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 38
      }
    },
    {
      "id": "sha1:2a145ec60b66f3f1ab74ecc76e5788574da6e41b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ПО_магистр",
      "subject": "Современные проблемы науки и образования",
      "kind": "EXAM",
      "teacher": "Куваева А.А.",
      "location": {
        "room": "327",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:9bbdf2e93a4d4313a5ee51ea47d11ff19ce82bc9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Избранные вопросы современной информатики",
      "kind": "EXAM",
      "teacher": "Алиева М.Ф.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:b07c3e31030b26de808a2943d5cf1b9074c28824",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1 Ф",
      "subject": "Элементарная математика",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fd740b8ee3bd3546d4cb115a2bb5596ecc55fde7",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Молекулярная физика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:632df05325bc4bdeccc94ca85ee8c4a20eb0fd2f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:e5d0c01a46f393bb1cc2f4e07de0308240d3a1b6",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_АСОИУ",
      "subject": "Алгебра и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:1c58a8a7d6ac6cfb4fa4ffcc79c34f74d4bd3540",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Физика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:fc48bf6ac10707aff9975c0ed4c5e6cf0824860d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:2e483747a6bd7233c57737d3f2471e9b01096c11",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 40
      }
    },
    {
      "id": "sha1:738afc5c37791188600a4aa7e8ee38ed1843ac1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Радиофизика и электроника",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:2a7b5b21692ea7fcee64b2d593a497318c391333",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Атомная и ядерная физика",
      "kind": "EXAM",
      "teacher": "Тлячев В.Б.",
      "location": {
        "room": "317",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:db872e4e528e4952c2ab511e5eb518ae16ed5ac0",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ_ТИИ",
      "subject": "Математика Калашникова С.И",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": "323б",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:b8c9fe4e0cefd35f731d89b091da2cb24864f07a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Методы оптимизации",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:eae32d8f0cb5e9a01f367dc69f55c196c1e85c87",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 41
      }
    },
    {
      "id": "sha1:f030dd50a213cbdcc2f4b287a857afa39d2f5c9e",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4 УТС",
      "subject": "Системы искусственного интелекта",
      "kind": "EXAM",
      "teacher": "Шопин А.В.",
      "location": {
        "room": "511",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:389a81ae2fe22e1fac803b2cd14e30c964ba37f4",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "СПО",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 42
      }
    },
    {
      "id": "sha1:6ace48431cc53571e211114929c191052a48c80f",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 43
      }
    },
    {
      "id": "sha1:c502e2c032b2fcc966fee1ea6f8cee091e052a64",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Современные образовательные технологии",
      "kind": "EXAM",
      "teacher": "Джабатырова Б.К.",
      "location": {
        "room": "206с",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:bbd5feee0d0963c808a93fcfb3ff359b01ea1901",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Численные методы и мат.моделирование",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "319",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:86cfb9a1e07c2d9515a6b0d79fea2d4666237795",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:ba29e126ef7873febd87b8328662b35a4adca204",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Электротехника и электроника",
      "kind": "EXAM",
      "teacher": "Мамий А.Р.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:1f5c4011fb786b87129e5cfeba96dd34ba17cf6b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ЭВМ и переф.устр",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:a1bc83cf558abfb6bc4944f54fc84f08f2efd549",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Сети и телеком",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:12d84a27f6d185774ccbeb7ac8f1cbc2dc9b0169",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Надежность, эргономика, качество",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "404",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 44
      }
    },
    {
      "id": "sha1:e08862752a388c843d3e2d4f4ad2263e0ad96b8c",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ1",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 45
      }
    },
    {
      "id": "sha1:fa09a96464fb4f6ab91a9c0218ada67d506f1d1a",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ2",
      "subject": "Защита информации",
      "kind": "EXAM",
      "teacher": "Киздермишов А.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 46
      }
    },
    {
      "id": "sha1:5827c5c9922292eda74e463e55dd3e060f0edfc1",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТВМС",
      "kind": "EXAM",
      "teacher": "Скоркин А.Ю.",
      "location": {
        "room": "329",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:fbf44cfc0b45e8a6039df92b910abe807ff6afdf",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ1",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 47
      }
    },
    {
      "id": "sha1:d5d0043505879661fcda34e2e43688293c1e6a59",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ПО_магистр",
      "subject": "Методика преподавания современной физики в профильной школе",
      "kind": "EXAM",
      "teacher": "Ушхо А.Д.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:6585714de2e1b32cea5b2c83caa2b36a2ea8e757",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3Ф",
      "subject": "Векторный и тензорный анализ",
      "kind": "EXAM",
      "teacher": "Жукова И.Н.",
      "location": {
        "room": "328",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:7c095350a53193584b5d941b899f0945831a8c27",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3 УТС",
      "subject": "Теоретическая механика",
      "kind": "EXAM",
      "teacher": "Шамбин А.И.",
      "location": {
        "room": "325",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:ff6742201ff74c1621492767dc2699f911aa2414",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "ТС и СА",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": "407",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:a9d0fc908fd02826a320c71c96f96456d352ffc2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:5a87ebe7c3b5d6b97a5c50a04780ce4e1aa144a2",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ИВТ(УзГУМЯ)",
      "subject": "Технология программир",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 48
      }
    },
    {
      "id": "sha1:870da4effea2bd4dc329e5e238f2262316274e24",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_ТИИ",
      "subject": "Операционные системы",
      "kind": "EXAM",
      "teacher": "Плисенко О.А.",
      "location": {
        "room": "405",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:ad2a4c79747cf6f838d521c222f03319d163706b",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "НЭК АСОИУ",
      "kind": "EXAM",
      "teacher": "Коржаков А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 50
      }
    },
    {
      "id": "sha1:21a0518de3e95404c7779952a7d6860a84b13fab",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "Мат.пакеты в проф.деятельности",
      "kind": "EXAM",
      "teacher": "Шамбина С.В.",
      "location": {
        "room": "324",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:18f190de862050a0fd493997742e716960f5f3e9",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2ИВТ_АСОИУ",
      "subject": "Инженерная и комп. Графика",
      "kind": "EXAM",
      "teacher": "Хандожко А.А.",
      "location": {
        "room": "406",
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист1",
        "row": 51
      }
    },
    {
      "id": "sha1:535eef4d8b1d52cc744354766c25c7a52c8bfd6d",
      "date": null,
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ИВТ2",
      "subject": "Моделирование систем",
      "kind": "EXAM",
      "teacher": "Коржакова С.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": "дист.",
      "source": {
        "sheet": "Лист1",
        "row": 54
      }
    },
    {
      "id": "sha1:f2688ce77cb95d03c03b0ba21746b97c41d0cb54",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 2
      }
    },
    {
      "id": "sha1:077d23d8749c23ed0fdedacc624ce47b1ee495d8",
      "date": "1/12/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "2Ф",
      "subject": "ТФКП",
      "kind": "EXAM",
      "teacher": "Артисевич А.Е.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 3
      }
    },
    {
      "id": "sha1:b1a2897d707e6e89aa7ff8f01f705ecbd5a520d0",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 4
      }
    },
    {
      "id": "sha1:086c3fd57b898c1b3ce2a0f1aad9d95439149fcb",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1УТС, 2Ф",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 5
      }
    },
    {
      "id": "sha1:21fa369690ea4ecc4584284b0fbebbc462e2d9a3",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 6
      }
    },
    {
      "id": "sha1:a68602e9bfdd8618612ab9f0847e603780b02c73",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 7
      }
    },
    {
      "id": "sha1:b06871c3b09a41a60c93e09c562be44d918162ad",
      "date": "1/23/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 8
      }
    },
    {
      "id": "sha1:d576e45d172261173b033bb1a982d825bd1e33c5",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Матан",
      "kind": "EXAM",
      "teacher": "Сташ А.Х.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 9
      }
    },
    {
      "id": "sha1:ecb166cd7c9a9e49e8d04c6b1c240c85074203e3",
      "date": "1/9/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 10
      }
    },
    {
      "id": "sha1:296dfc75b6a3a15f446bc311cf89177ff2e1f804",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2, 1УТС",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 11
      }
    },
    {
      "id": "sha1:45cfe83d13007440844863edb31c989fdf124434",
      "date": "1/10/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 12
      }
    },
    {
      "id": "sha1:a2eead52f206bab6330425392b608c8f53a35630",
      "date": "1/11/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Алг и геом",
      "kind": "EXAM",
      "teacher": "Калашникова С.И.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 13
      }
    },
    {
      "id": "sha1:aea62c3a5cb7396659030adf3075723b8c266611",
      "date": "1/24/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 14
      }
    },
    {
      "id": "sha1:90e6a470c3f8962a3fa615d9e2acb69615cdcbd8",
      "date": "1/25/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "3ПО",
      "subject": "Оптика",
      "kind": "EXAM",
      "teacher": "Пономарев М.Г.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 15
      }
    },
    {
      "id": "sha1:b81ea0e113ddb88d42bdf01311472f02d876b71a",
      "date": "12/28/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 16
      }
    },
    {
      "id": "sha1:2fc81c1850ade2d3ebed834cca2075eec094ae0d",
      "date": "12/29/20",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4Ф",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 17
      }
    },
    {
      "id": "sha1:f1d733dad039d08269b4a41915435c598ee42b6f",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 18
      }
    },
    {
      "id": "sha1:5d35ffababa1cd9db724cac257cc32e6f683c230",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Метод.препод",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 19
      }
    },
    {
      "id": "sha1:8de0c4f5440c691d46337a8cee911b4f34a98725",
      "date": "1/21/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 20
      }
    },
    {
      "id": "sha1:73bfe39944e406674d1fcb19168b702ff849b7b8",
      "date": "1/22/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "4ПО",
      "subject": "Методы реше",
      "kind": "EXAM",
      "teacher": "Аракелов А.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 21
      }
    },
    {
      "id": "sha1:3e6462337b180f228d3dcbae766651dce159220e",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 22
      }
    },
    {
      "id": "sha1:4ae1187507929a0fa346aff676fa3c1ec59685aa",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 23
      }
    },
    {
      "id": "sha1:fad2aece649efaaa0f92920b9ba7d1e538aaae98",
      "date": "1/19/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 24
      }
    },
    {
      "id": "sha1:2e295aafce1c3c8092641c11b813ee3f91b30e0e",
      "date": "1/20/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "Культурология",
      "kind": "EXAM",
      "teacher": "Нагой А.А.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 25
      }
    },
    {
      "id": "sha1:079fa2220a3b2cbad9f9ddd93d9432eb26ba3e5f",
      "date": "1/13/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 26
      }
    },
    {
      "id": "sha1:05c5a1de645466bacfa9f2e8bfb227f0154935c2",
      "date": "1/14/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1Ф, 1УТС",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 27
      }
    },
    {
      "id": "sha1:533127a8afb20c861b5b2b6996b7d87b052ab1ea",
      "date": "1/15/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 28
      }
    },
    {
      "id": "sha1:5656d05976f75301dbe16b1f75e2682ba84bd801",
      "date": "1/16/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ1",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 29
      }
    },
    {
      "id": "sha1:bb907df7f2cc6441cbd3d16f4093d41b660aa3de",
      "date": "1/17/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": null,
      "subject": null,
      "kind": "CONSULTATION",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 30
      }
    },
    {
      "id": "sha1:cbaa0ccb2ed62a6aa556f2d885278f2ea5996016",
      "date": "1/18/21",
      "time": {
        "start": null,
        "end": null
      },
      "timezone": "Europe/Bucharest",
      "group": "1ИВТ2",
      "subject": "История",
      "kind": "EXAM",
      "teacher": "Бурыкина Л.В.",
      "location": {
        "room": null,
        "building": null
      },
      "notes": null,
      "source": {
        "sheet": "Лист2",
        "row": 31
      }
    }
  ],
  "issues": []
}
</file>

<file path="src/config.ts">
import path from "node:path";

export interface AppConfig {
  port: number;
  storageDir: string;
  uploadsDir: string;
  incomingDir: string;
  resultsDir: string;
  maxParallelTasks: number;
  maxUploadMb: number;
}

export function resolveConfig(overrides: Partial<AppConfig> = {}): AppConfig {
  const storageDir = path.resolve(
    overrides.storageDir ?? process.env.STORAGE_DIR ?? path.join(process.cwd(), "storage")
  );

  const uploadsDir = path.resolve(overrides.uploadsDir ?? path.join(storageDir, "uploads"));
  const incomingDir = path.resolve(overrides.incomingDir ?? path.join(uploadsDir, "incoming"));
  const resultsDir = path.resolve(overrides.resultsDir ?? path.join(storageDir, "results"));

  const portRaw = overrides.port ?? process.env.PORT;
  const maxParallelRaw = overrides.maxParallelTasks ?? process.env.MAX_PARALLEL_TASKS;
  const maxUploadMbRaw = overrides.maxUploadMb ?? process.env.MAX_UPLOAD_MB;

  return {
    port: normalizeNumber(portRaw, 3000),
    storageDir,
    uploadsDir,
    incomingDir,
    resultsDir,
    maxParallelTasks: Math.max(1, normalizeNumber(maxParallelRaw, 1)),
    maxUploadMb: Math.max(1, normalizeNumber(maxUploadMbRaw, 30))
  };
}

function normalizeNumber(value: string | number | undefined, fallback: number): number {
  if (typeof value === "number" && Number.isFinite(value)) {
    return value;
  }

  if (typeof value === "string") {
    const parsed = Number.parseInt(value, 10);
    if (Number.isFinite(parsed)) {
      return parsed;
    }
  }

  return fallback;
}
</file>

<file path="src/domain.ts">
export type ExamKind =
  | "EXAM"
  | "CREDIT"
  | "DIFF_CREDIT"
  | "CONSULTATION"
  | "RETAKE"
  | "OTHER";

export interface LocationInfo {
  room: string | null;
  building: string | null;
}

export interface TimeRange {
  start: string | null; // "HH:mm"
  end: string | null;   // "HH:mm"
}

export interface ParseIssue {
  level: "info" | "warning" | "error";
  message: string;
  source?: { sheet?: string; row?: number; column?: string };
}

export interface ScheduleItem {
  id: string;
  date: string | null;        // "YYYY-MM-DD"
  time: TimeRange;
  // timezone убран — в Excel указана только дата без времени,
  // часовой пояс определяется на стороне потребителя
  group: string | null;
  subject: string | null;
  kind: ExamKind;
  teacher: string | null;
  location: LocationInfo;
  notes: string | null;
  source: { sheet: string; row: number };
  raw?: Record<string, string | null>;
}

export interface ScheduleJsonV1 {
  meta: { sourceFileName: string; parsedAt: string; version: "1.0" };
  summary: {
    items: number;
    groups: string[];
    itemsByGroup: Record<string, number>;
    dateRange: { from: string | null; to: string | null };
  };
  items: ScheduleItem[];
  issues: ParseIssue[];
}
</file>

<file path="src/index.ts">
import express from "express";
import { resolveConfig } from "./config";
import { createSessionParserRouter } from "./router";

const config = resolveConfig();
const app = express();

app.use(express.json());
app.use("/api", createSessionParserRouter({ config }));

app.get("/health", (_req, res) => {
  res.json({ status: "ok" });
});

app.listen(config.port, () => {
  console.log(`Session parser started on port ${config.port}`);
});
</file>

<file path="src/normalize.ts">
import { ParsedResult } from "./types";
import { ScheduleItem, ScheduleJsonV1 } from "./domain";

export function normalizeToScheduleV1(
  parsed: ParsedResult & { _parsedItems?: ScheduleItem[] },
  _keepRaw: boolean = false
): ScheduleJsonV1 {
  const items: ScheduleItem[] = parsed._parsedItems ?? [];

  // Summary
  const groupSet = new Set<string>();
  for (const it of items) {
    if (it.group) groupSet.add(it.group);
  }
  const groups = Array.from(groupSet).sort();

  const itemsByGroup: Record<string, number> = {};
  for (const g of groups) itemsByGroup[g] = 0;
  for (const it of items) {
    if (it.group && itemsByGroup[it.group] !== undefined) {
      itemsByGroup[it.group] += 1;
    }
  }

  const dates = items.map((x) => x.date).filter(Boolean) as string[];
  const from = dates.length ? dates.reduce((a, b) => (a < b ? a : b)) : null;
  const to = dates.length ? dates.reduce((a, b) => (a > b ? a : b)) : null;

  return {
    meta: {
      sourceFileName: parsed.sourceFileName,
      parsedAt: parsed.parsedAt,
      version: "1.0",
    },
    summary: {
      items: items.length,
      groups,
      itemsByGroup,
      dateRange: { from, to },
    },
    items,
    issues: [],
  };
}
</file>

<file path="src/parser.ts">
/**
 * parser.ts
 *
 * Парсер Excel-файла расписания сессии физического факультета.
 *
 * ЛИСТ1 — матрица «дата × группа»
 *   Строка 10: заголовки — первые 2 служебные, дальше названия групп.
 *   Строки 12+: col1 = дата, col3..N = текст ячейки для группы.
 *   Ячейка: "404  Предмет  Преподаватель И.О."
 *
 * ЛИСТ2 — плоская таблица
 *   Строка 1: ФИО | Дата | Группа | Предмет | Контроль
 */

import xlsx from "xlsx";
import { ParsedResult, SheetData } from "./types";
import { ScheduleItem, ExamKind } from "./domain";
import crypto from "node:crypto";

// ─────────────────────────────────────────────────────────────────────────────
// Helpers
// ─────────────────────────────────────────────────────────────────────────────

const ROOM_RE = /^([\d]{2,3}[а-яА-ЯёЁa-zA-Z]?(?:\/[\d]+)?)\s*[\n\s]+/;

const TEACHER_FULL_RE =
  /([А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.(?:,\s*[А-ЯЁ][а-яё]+-?[а-яё]*\s+[А-ЯЁ]\.[А-ЯЁ]\.)*)\s*(?:дист\.?)?\s*$/;

const TEACHER_SHORT_RE = /([А-ЯЁ][а-яё]+\s+[А-ЯЁ]\.)\s*(?:дист\.?)?\s*$/;

function sha1(input: string): string {
  return "sha1:" + crypto.createHash("sha1").update(input).digest("hex");
}

/**
 * Конвертирует значение ячейки даты в "YYYY-MM-DD".
 * Для Лист1: matrix читается с raw:true, поэтому даты приходят как числа (Excel serial).
 * Для Лист2: sheet_to_json с raw:false, даты приходят как строка "M/D/YY" или "M/D/YYYY".
 * Функция обрабатывает оба варианта.
 */
function parseExcelDate(value: string | number | null | undefined): string | null {
  if (value === null || value === undefined || value === "") return null;

  if (typeof value === "number") {
    const MS_PER_DAY = 86400000;
    const EXCEL_EPOCH = Date.UTC(1899, 11, 30); // 1899-12-30 UTC
    const ts = EXCEL_EPOCH + value * MS_PER_DAY;
    const d = new Date(ts);
    const y = d.getUTCFullYear();
    const m = String(d.getUTCMonth() + 1).padStart(2, "0");
    const day = String(d.getUTCDate()).padStart(2, "0");
    return `${y}-${m}-${day}`;
  }

  if (typeof value === "string") {
    const trimmed = value.trim();
    // Уже YYYY-MM-DD
    if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) return trimmed;
    // M/D/YY или M/D/YYYY (американский формат от xlsx SSF)
    const m = trimmed.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
    if (m) {
      const month = m[1].padStart(2, "0");
      const day = m[2].padStart(2, "0");
      const year = m[3].length === 2 ? `20${m[3]}` : m[3];
      return `${year}-${month}-${day}`;
    }
  }

  return null;
}

const SKIP_VALUES = new Set(["занятия", "зачетная неделя", "каникулы"]);

function isSkipValue(val: string): boolean {
  const low = val.toLowerCase().trim();
  if (SKIP_VALUES.has(low)) return true;
  if (/^консультация/.test(low)) return true;
  if (low.startsWith("практика")) return true;
  if (low.startsWith("эксплуатационная")) return true;
  if (low.startsWith("технологическая")) return true;
  if (low.startsWith("научно-исследовательская")) return true;
  if (low.startsWith("педагогическая")) return true;
  return false;
}

function parseCellText(raw: string): {
  room: string | null;
  subject: string | null;
  teacher: string | null;
  notes: string | null;
} {
  const text = raw.trim();
  if (!text) return { room: null, subject: null, teacher: null, notes: null };

  const normalized = text.replace(/[ \t]{2,}/g, "  ");

  const roomMatch = ROOM_RE.exec(normalized);
  const room = roomMatch ? roomMatch[1] : null;
  let rest = roomMatch ? normalized.slice(roomMatch[0].length).trim() : normalized;

  const hasDist = /дист\.?/i.test(rest);
  rest = rest.replace(/\s*дист\.?\s*$/i, "").trim();

  let teacherMatch = TEACHER_FULL_RE.exec(rest);
  if (!teacherMatch) teacherMatch = TEACHER_SHORT_RE.exec(rest);

  const teacher = teacherMatch ? teacherMatch[1].trim() : null;
  const subjectRaw = teacherMatch ? rest.slice(0, teacherMatch.index).trim() : rest;
  const subject = subjectRaw.replace(/\s{2,}/g, " ").replace(/[\s,.-]+$/, "").trim() || null;

  return { room, subject, teacher, notes: hasDist ? "дист." : null };
}

function parseKind(value: string | null): ExamKind {
  if (!value) return "OTHER";
  const v = value.toLowerCase();
  if (/(экз|exam)/.test(v)) return "EXAM";
  if (/(диф|diff)/.test(v)) return "DIFF_CREDIT";
  if (/(зач|credit)/.test(v)) return "CREDIT";
  if (/(конс|consult)/.test(v)) return "CONSULTATION";
  if (/(пересда|retake)/.test(v)) return "RETAKE";
  return "OTHER";
}

function makeItem(
  fields: {
    date: string | null;
    group: string | null;
    subject: string | null;
    kind: ExamKind;
    teacher: string | null;
    room: string | null;
    notes: string | null;
  },
  source: { sheet: string; row: number }
): ScheduleItem {
  const stableKey = [
    source.sheet,
    fields.date ?? "",
    fields.group ?? "",
    fields.subject ?? "",
    fields.kind,
    fields.teacher ?? "",
    fields.room ?? "",
  ].join("|");

  return {
    id: sha1(stableKey),
    date: fields.date,
    time: { start: null, end: null },
    group: fields.group,
    subject: fields.subject,
    kind: fields.kind,
    teacher: fields.teacher,
    location: { room: fields.room, building: null },
    notes: fields.notes,
    source,
  };
}

// ─────────────────────────────────────────────────────────────────────────────
// Парсер Лист1 — матрица «дата × группа»
// ─────────────────────────────────────────────────────────────────────────────

function parseSheet1(ws: xlsx.WorkSheet, sheetName: string): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const HEADER_ROW = 10;
  const DATA_START_ROW = 12;
  const DATE_COL = 1;
  const GROUP_COL_START = 3;

  const headerRow =
    (xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
      header: 1,
      range: `A${HEADER_ROW}:T${HEADER_ROW}`,
      defval: null,
      raw: false,
    })[0] as (string | null)[]) ?? [];

  const groupNames: (string | null)[] = headerRow
    .slice(GROUP_COL_START - 1)
    .map((v) => (v ? String(v).trim() : null));

  // raw:true — даты придут как числа (Excel serial), текстовые ячейки — строками.
  // raw:false форматирует дату как "Monday, December 23, 2024" — parseExcelDate не распознаёт.
  // raw:true — ячейки дат придут как числа (Excel serial, напр. 45649),
  // текстовые ячейки останутся строками (data_type='s').
  // raw:false форматирует дату через стиль ячейки ("Monday, December 23, 2024") —
  // такой формат parseExcelDate не распознаёт.
  const matrix = xlsx.utils.sheet_to_json<(string | number | null)[]>(ws, {
    header: 1,
    range: DATA_START_ROW - 1,
    defval: null,
    raw: true,
  }) as Array<Array<string | number | null>>;

  for (let ri = 0; ri < matrix.length; ri++) {
    const row = matrix[ri];

    const dateRaw = row[DATE_COL - 1];
    if (!dateRaw) continue;

    const dateStr = parseExcelDate(dateRaw);

    for (let ci = 0; ci < groupNames.length; ci++) {
      const groupName = groupNames[ci];
      const cellVal = row[GROUP_COL_START - 1 + ci];
      if (!cellVal) continue;

      const cellStr = String(cellVal).trim();
      if (!cellStr || isSkipValue(cellStr)) continue;

      const low = cellStr.toLowerCase();
      let kind: ExamKind;
      let room: string | null = null;
      let subject: string | null = null;
      let teacher: string | null = null;
      let notes: string | null = null;

      if (/консульт/i.test(low)) {
        kind = "CONSULTATION";
        notes = /дист/i.test(low) ? "дист." : null;
      } else {
        kind = "EXAM";
        if (/зач[её]т/i.test(cellStr)) kind = "CREDIT";
        if (/диф/i.test(cellStr)) kind = "DIFF_CREDIT";

        const parsed = parseCellText(cellStr);
        room = parsed.room;
        subject = parsed.subject;
        teacher = parsed.teacher;
        notes = parsed.notes;
      }

      items.push(
        makeItem(
          { date: dateStr, group: groupName, subject, kind, teacher, room, notes },
          { sheet: sheetName, row: DATA_START_ROW + ri }
        )
      );
    }
  }

  return items;
}

// ─────────────────────────────────────────────────────────────────────────────
// Парсер Лист2 — плоская таблица ФИО / Дата / Группа / Предмет / Контроль
// ─────────────────────────────────────────────────────────────────────────────

function parseSheet2(ws: xlsx.WorkSheet, sheetName: string): ScheduleItem[] {
  const items: ScheduleItem[] = [];

  const rows = xlsx.utils.sheet_to_json<{
    ФИО?: string | null;
    Дата?: string | null;
    Группа?: string | null;
    Предмет?: string | null;
    Контроль?: string | null;
  }>(ws, { defval: null, raw: false });

  let lastTeacher: string | null = null;

  for (let ri = 0; ri < rows.length; ri++) {
    const row = rows[ri];

    const dateStr = parseExcelDate(row["Дата"]);
    const fio = row["ФИО"] ? String(row["ФИО"]).trim() : null;
    const group = row["Группа"] ? String(row["Группа"]).trim() : null;
    const subject = row["Предмет"] ? String(row["Предмет"]).trim() : null;
    const kind = parseKind(row["Контроль"] ? String(row["Контроль"]).trim() : null);

    if (fio) lastTeacher = fio;

    items.push(
      makeItem(
        { date: dateStr, group, subject, kind, teacher: lastTeacher, room: null, notes: null },
        { sheet: sheetName, row: ri + 2 }
      )
    );
  }

  return items;
}

// ─────────────────────────────────────────────────────────────────────────────
// Главная функция
// ─────────────────────────────────────────────────────────────────────────────

export async function parseExcelSchedule(
  filePath: string,
  sourceFileName: string
): Promise<ParsedResult> {
  // raw:false — текст как строки, даты как "M/D/YY".
  // НЕ используем cellDates:true — он конвертирует даты в Date-объекты
  // и ломает parseExcelDate, которая ожидает строку или число.
  const workbook = xlsx.readFile(filePath, { raw: false });

  const allItems: ScheduleItem[] = [];
  const sheetMeta: ParsedResult["memory"]["sheets"] = [];

  for (const sheetName of workbook.SheetNames) {
    const ws = workbook.Sheets[sheetName];

    const firstRow = (xlsx.utils.sheet_to_json<(string | null)[]>(ws, {
      header: 1,
      range: 0,
      defval: null,
      raw: false,
    })[0] as (string | null)[]) ?? [];

    const firstCell = firstRow[0] ? String(firstRow[0]).trim() : "";
    const isMatrix = /расписание/i.test(firstCell) || sheetName === "Лист1";

    const items = isMatrix ? parseSheet1(ws, sheetName) : parseSheet2(ws, sheetName);

    allItems.push(...items);
    sheetMeta.push({ sheetName, rowCount: items.length, columns: [] });
  }

  const result: ParsedResult & { _parsedItems?: ScheduleItem[] } = {
    sourceFileName,
    parsedAt: new Date().toISOString(),
    sheets: [],
    memory: {
      sheetCount: workbook.SheetNames.length,
      totalRows: allItems.length,
      sheets: sheetMeta,
    },
    _parsedItems: allItems,
  };

  return result;
}
</file>

<file path="src/router.ts">
import express from "express";
import multer from "multer";
import { AppConfig, resolveConfig } from "./config";
import { ensureStorageDirectories } from "./storage";
import { TaskService } from "./task-service";

export interface RouterOptions {
  config?: Partial<AppConfig>;
  taskService?: TaskService;
}

export function createSessionParserRouter(options: RouterOptions = {}): express.Router {
  const config = resolveConfig(options.config);
  ensureStorageDirectories(config);

  const router = express.Router();
  const upload = multer({
    dest: config.incomingDir,
    limits: {
      fileSize: config.maxUploadMb * 1024 * 1024,
    },
  });

  const taskService = options.taskService ?? new TaskService(config);

  // POST /api/tasks — загрузить Excel и создать задачу
  router.post("/tasks", upload.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).json({ error: "Excel file is required in form-data field 'file'" });
    }

    try {
      const task = await taskService.createTask(req.file);
      return res.status(202).json({
        taskId: task.id,
        status: task.status,
        createdAt: task.createdAt,
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to create task",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // GET /api/tasks/:taskId/status — статус задачи
  router.get("/tasks/:taskId/status", (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    return res.json({
      taskId: task.id,
      status: task.status,
      createdAt: task.createdAt,
      startedAt: task.startedAt ?? null,
      finishedAt: task.finishedAt ?? null,
      error: task.error ?? null,
    });
  });

  // GET /api/tasks/:taskId/result — скачать JSON с результатом
  router.get("/tasks/:taskId/result", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    return res.download(task.resultFilePath, `${task.id}.json`);
  });

  // GET /api/tasks/:taskId/memory — краткая сводка по результату
  router.get("/tasks/:taskId/memory", async (req, res) => {
    const task = taskService.getTask(req.params.taskId);
    if (!task) {
      return res.status(404).json({ error: "Task not found" });
    }

    if (task.status === "failed") {
      return res.status(422).json({
        error: "Task processing failed",
        details: task.error ?? "Unknown processing error",
      });
    }

    if (task.status !== "completed") {
      return res.status(409).json({
        error: "Task is not completed yet",
        status: task.status,
      });
    }

    try {
      const result = await taskService.getResult(task.id);
      // Теперь result — это ScheduleJsonV1, берём summary как "memory"
      return res.json({
        taskId: task.id,
        memory: {
          items: result.summary.items,
          groups: result.summary.groups,
          dateRange: result.summary.dateRange,
        },
      });
    } catch (error) {
      return res.status(500).json({
        error: "Failed to read task result",
        details: error instanceof Error ? error.message : "Unknown error",
      });
    }
  });

  // Multer error handler
  router.use(
    (
      error: unknown,
      _req: express.Request,
      res: express.Response,
      next: express.NextFunction
    ) => {
      if (error instanceof multer.MulterError) {
        const details =
          error.code === "LIMIT_FILE_SIZE"
            ? `File is too large. Max upload size is ${config.maxUploadMb} MB`
            : error.message;

        return res.status(400).json({ error: "Upload error", details });
      }

      return next(error);
    }
  );

  return router;
}
</file>

<file path="src/storage.ts">
import fs from "node:fs";
import { AppConfig } from "./config";

export function ensureStorageDirectories(config: AppConfig): void {
  const directories = [config.storageDir, config.uploadsDir, config.incomingDir, config.resultsDir];

  for (const dir of directories) {
    fs.mkdirSync(dir, { recursive: true });
  }
}
</file>

<file path="src/task-service.ts">
import fs from "node:fs/promises";
import path from "node:path";
import { v4 as uuidv4 } from "uuid";
import { AppConfig } from "./config";
import { parseExcelSchedule } from "./parser";
import { TaskRecord } from "./types";
import { normalizeToScheduleV1 } from "./normalize";
import { ScheduleJsonV1 } from "./domain";

export class TaskService {
  private readonly tasks = new Map<string, TaskRecord>();
  private readonly queue: string[] = [];
  private workers = 0;

  constructor(private readonly config: AppConfig) {}

  async createTask(file: Express.Multer.File): Promise<TaskRecord> {
    const id = uuidv4();
    const extension = path.extname(file.originalname) || ".xlsx";
    const uploadedFilePath = path.join(this.config.uploadsDir, `${id}${extension}`);
    const resultFilePath = path.join(this.config.resultsDir, `${id}.json`);

    await fs.rename(file.path, uploadedFilePath);

    const task: TaskRecord = {
      id,
      status: "queued",
      originalFileName: file.originalname,
      uploadedFilePath,
      resultFilePath,
      createdAt: new Date().toISOString(),
    };

    this.tasks.set(id, task);
    this.queue.push(id);
    this.schedule();

    return task;
  }

  getTask(taskId: string): TaskRecord | undefined {
    return this.tasks.get(taskId);
  }

  async getResult(taskId: string): Promise<ScheduleJsonV1> {
    const task = this.tasks.get(taskId);
    if (!task) throw new Error("TASK_NOT_FOUND");
    if (task.status !== "completed") throw new Error("TASK_NOT_COMPLETED");

    const raw = await fs.readFile(task.resultFilePath, "utf-8");
    return JSON.parse(raw) as ScheduleJsonV1;
  }

  private schedule(): void {
    while (this.workers < this.config.maxParallelTasks && this.queue.length > 0) {
      const nextTaskId = this.queue.shift();
      if (!nextTaskId) continue;

      this.workers += 1;
      void this.processTask(nextTaskId).finally(() => {
        this.workers -= 1;
        this.schedule();
      });
    }
  }

  private async processTask(taskId: string): Promise<void> {
    const task = this.tasks.get(taskId);
    if (!task) return;

    task.status = "processing";
    task.startedAt = new Date().toISOString();

    try {
      const parsed = await parseExcelSchedule(task.uploadedFilePath, task.originalFileName);
      const normalized = normalizeToScheduleV1(parsed, false);

      await fs.writeFile(task.resultFilePath, JSON.stringify(normalized, null, 2), "utf-8");

      task.status = "completed";
      task.finishedAt = new Date().toISOString();
    } catch (error) {
      task.status = "failed";
      task.finishedAt = new Date().toISOString();
      task.error = error instanceof Error ? error.message : "Unknown processing error";
    }
  }
}
</file>

<file path="src/types.ts">
import { ScheduleItem } from "./domain";

export type TaskStatus = "queued" | "processing" | "completed" | "failed";

export interface SheetData {
  sheetName: string;
  headers: string[];
  rows: Record<string, string | null>[];
}

export interface ParseMemory {
  sheetCount: number;
  totalRows: number;
  sheets: Array<{
    sheetName: string;
    rowCount: number;
    columns: string[];
  }>;
}

export interface ParsedResult {
  sourceFileName: string;
  parsedAt: string;
  sheets: SheetData[];
  memory: ParseMemory;
  
  _parsedItems?: ScheduleItem[];
}

export interface TaskRecord {
  id: string;
  status: TaskStatus;
  originalFileName: string;
  uploadedFilePath: string;
  resultFilePath: string;
  createdAt: string;
  startedAt?: string;
  finishedAt?: string;
  error?: string;
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "CommonJS",
    "moduleResolution": "Node",
    "strict": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "skipLibCheck": true,
    "rootDir": "src",
    "outDir": "dist",
    "resolveJsonModule": true
  },
  "include": ["src/**/*.ts"]
}
</file>

</files>
